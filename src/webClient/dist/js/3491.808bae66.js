"use strict";(self["webpackChunkElectron"]=self["webpackChunkElectron"]||[]).push([[3491],{1181:(e,t,l)=>{l.d(t,{Z:()=>v});var s=l(75305);const i={class:"q-px-lg q-pb-md"},o={style:{color:"grey","font-size":"0.8rem"}},a={key:0,class:"q-pa-md row justify-center"},d=(0,s.Uk)(" было "),m=(0,s.Uk)(" изменено на ");function c(e,t,l,c,n,r){const u=(0,s.up)("q-timeline-entry"),_=(0,s.up)("q-item-section"),p=(0,s.up)("q-card"),h=(0,s.up)("q-timeline"),b=(0,s.up)("q-card-section"),g=(0,s.up)("q-dialog"),k=(0,s.up)("q-btn");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(g,{modelValue:c.isShowDialog,"onUpdate:modelValue":t[0]||(t[0]=e=>c.isShowDialog=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(p,{style:{"max-width":"100vw","min-width":"50vw"}},{default:(0,s.w5)((()=>[(0,s.Wm)(b,null,{default:(0,s.w5)((()=>[(0,s._)("div",i,[(0,s.Wm)(h,{color:"secondary",layout:c.timelineLayout},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{heading:"",tag:"h6"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,s.zw)(l.item.title),1)])),_:1}),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.historyList,(e=>((0,s.wg)(),(0,s.j4)(u,{key:e.id,icon:e.icon,color:e.color},{title:(0,s.w5)((()=>[(0,s.Wm)(_,null,{default:(0,s.w5)((()=>[(0,s._)("div",null,(0,s.zw)(e.type),1),(0,s._)("div",o,(0,s.zw)(e.user_full_name),1)])),_:2},1024)])),subtitle:(0,s.w5)((()=>[(0,s.Uk)((0,s.zw)(new Date(e.datetime).toLocaleDateString("ru",{weekday:"short",day:"numeric",month:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),1)])),default:(0,s.w5)((()=>[e.old_value?((0,s.wg)(),(0,s.iD)("div",a,[d,(0,s.Wm)(p,{class:"col-12 q-pa-md"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,s.zw)(e.old_value),1)])),_:2},1024),m,(0,s.Wm)(p,{class:"col-12 q-pa-md",style:{"background-color":"rgba(33,186,69,0.1)"}},{default:(0,s.w5)((()=>[(0,s.Uk)((0,s.zw)(e.new_value),1)])),_:2},1024)])):(0,s.kq)("",!0)])),_:2},1032,["icon","color"])))),128))])),_:1},8,["layout"])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,s.Wm)(k,{round:l.round,rounded:l.rounded,push:"",icon:"history",color:"accent",label:l.label,onClick:t[1]||(t[1]=e=>c.open())},null,8,["round","rounded","label"])],64)}var n=l(48825);const r={props:["historyList","item","label","rounded","round"],setup(e){const t=(0,s.iH)(!1),l=(0,n.Z)(),i=(0,s.Fl)((()=>l.screen.lt.sm?"dense":l.screen.lt.md?"comfortable":"loose")),o=()=>{t.value=!0};return{isShowDialog:t,open:o,timelineLayout:i}}};var u=l(74260),_=l(46778),p=l(10151),h=l(25589),b=l(1432),g=l(23424),k=l(52035),w=l(2165),y=l(7518),q=l.n(y);const f=(0,u.Z)(r,[["render",c]]),v=f;q()(r,"components",{QDialog:_.Z,QCard:p.Z,QCardSection:h.Z,QTimeline:b.Z,QTimelineEntry:g.Z,QItemSection:k.Z,QBtn:w.Z})},73491:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Te});l(90246);var s=l(75305);const i={key:1,class:"q-mt-sm"},o={class:"row q-col-gutter-md q-mb-sm"},a={class:"col-md-4 col-sm-6 col-xs-12"},d={class:"row q-col-gutter-md q-mb-sm"},m={key:0,class:"col-md-4 col-sm-6 col-xs-12"},c={key:1,class:"col-md-3 col-sm-5 col-xs-9"},n={key:2,class:"col-md-1 col-sm-1 col-xs-3"},r={class:"row q-col-gutter-md q-mb-sm"},u={key:0,class:"col-md-4 col-sm-6 col-xs-12"},_={key:1,class:"col-md-4 col-sm-6 col-xs-12"},p={class:"row q-col-gutter-md q-mb-sm"},h={class:"col-md-4 col-sm-6 col-xs-12"},b={class:"row q-col-gutter-md q-mb-sm"},g={class:"col-md-4 col-sm-6 col-xs-12"},k={class:"row q-col-gutter-md q-mb-sm"},w={class:"col-md-4 col-sm-6 col-xs-12"},y={key:0,class:"row q-col-gutter-sm q-mb-sm"},q={key:0,class:"col-md-4 col-sm-6 col-xs-12"},f={key:1,class:"col-md-4 col-sm-6 col-xs-12"},v={key:1,class:"row q-col-gutter-md q-mb-sm"},x={key:0,class:"col-md-4 col-sm-6 col-xs-12"},Z={key:1,class:"col-md-4 col-sm-6 col-xs-12"},D={key:2,class:"row q-col-gutter-md q-mb-sm"},Q={class:"col-md-1 col-sm-2 col-xs-4"},U={class:"col-md-1 col-sm-2 col-xs-4"},S={class:"col-md-2 col-sm-3 col-xs-4"},C={key:3,class:"row q-col-gutter-md q-mb-sm"},I={class:"col-md-4 col-sm-6 col-xs-12"},$={key:4,class:"row q-col-gutter-md q-mb-sm"},W={class:"col-md-4 col-sm-6 col-xs-12"},M={key:5,class:"row q-col-gutter-md q-mb-sm"},V={class:"col-md-4 col-sm-6 col-xs-12"},P={key:6,class:"row q-col-gutter-md q-mb-sm"},j={class:"col-md-4 col-sm-6 col-xs-12"},N={key:7,class:"row q-col-gutter-md q-mb-sm"},T={class:"col-md-4 col-sm-6 col-xs-12"},B={key:8,class:"row q-col-gutter-md q-mb-sm"},A={class:"col-md-4 col-sm-6 col-xs-12"},L={key:9,class:"row q-col-gutter-md q-mb-sm"},E={key:0,class:"col-md-4 col-sm-6 col-xs-12"},z={key:1,class:"col-md-4 col-sm-6 col-xs-12"},H={key:10,class:"row q-col-gutter-md q-mb-sm"},O={key:0,class:"col-md-4 col-sm-6 col-xs-12"},F={key:1,class:"col-md-4 col-sm-6 col-xs-12"},R={class:"row q-col-gutter-md q-mb-md"},Y={class:"col-md-4 col-sm-6 col-xs-12"},K=(0,s.Uk)("Сохранить");function G(e,t,l,G,J,X){const ee=(0,s.up)("comp-breadcrumb"),te=(0,s.up)("q-input"),le=(0,s.up)("comp-fld-ref-search"),se=(0,s.up)("set-next-stage-button"),ie=(0,s.up)("comp-fld-files"),oe=(0,s.up)("comp-fld-img-list"),ae=(0,s.up)("comp-fld-date"),de=(0,s.up)("timeline-dialog-button"),me=(0,s.up)("comp-item-btn-save"),ce=(0,s.up)("q-btn"),ne=(0,s.up)("q-tooltip"),re=(0,s.up)("q-page-sticky"),ue=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(ue,{padding:""},{default:(0,s.w5)((()=>[l.isOpenInDialog?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(ee,{key:0,list:[{label:"Задачи",to:"/task",docType:"task"},{label:J.item?J.item.title?J.item.title:"Редактирование":"",docType:"edit"}]},null,8,["list"])),J.item?((0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("div",o,[(0,s._)("div",a,[(0,s.Wm)(te,{outlined:"",type:"text",modelValue:J.item.title,"onUpdate:modelValue":t[0]||(t[0]=e=>J.item.title=e),label:e.$t("task.title"),autogrow:"",readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["modelValue","label"])])]),(0,s._)("div",d,[J.item.state_id?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",m,[(0,s.Wm)(le,{outlined:"",pgMethod:"ctlg_task_stage_list",label:e.$t("task.stage_id"),item:J.item.stage_title,itemId:J.item.stage_id,ext:{},onUpdate:t[1]||(t[1]=e=>J.item.stage_id=e.id),onClear:t[2]||(t[2]=e=>J.item.stage_id=null),readonly:!1,class:"q-mb-sm col-md-1 col-sm-2 col-xs-6"},null,8,["label","item","itemId"])])),J.item.state_id&&"new"!==this.id?((0,s.wg)(),(0,s.iD)("div",c,[(0,s.Wm)(le,{rounded:"",dense:"",pgMethod:"ctlg_task_stage_list",label:e.$t("task.stage_id"),item:J.item.stage_title,itemId:J.item.stage_id,ext:{},"bg-color":2===J.item.state_id?"warning":3===J.item.state_id?"negative":"",onUpdate:t[3]||(t[3]=e=>J.item.stage_id=e.id),onClear:t[4]||(t[4]=e=>J.item.stage_id=null),readonly:!0,class:"q-mb-sm col-md-1 col-sm-2 col-xs-6"},null,8,["label","item","itemId","bg-color"])])):(0,s.kq)("",!0),J.item.state_id&&"new"!==this.id?((0,s.wg)(),(0,s.iD)("div",n,[(0,s.Wm)(se,{item:J.item,onReload:t[5]||(t[5]=e=>X.reload()),currentUser:e.currentUser},null,8,["item","currentUser"])])):(0,s.kq)("",!0)]),(0,s._)("div",r,[J.item.system_id?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",u,[(0,s.Wm)(le,{outlined:"",pgMethod:"system_list",label:e.$t("task.system_id"),item:J.item.system_title,itemId:J.item.system_id,ext:{avatar:"image/system.svg",isClearable:"true",pathUrl:"/system"},onUpdate:t[6]||(t[6]=e=>J.item.system_id=e.id),onClear:t[7]||(t[7]=e=>J.item.system_id=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId","ext"])])),J.item.system_id?((0,s.wg)(),(0,s.iD)("div",_,[(0,s.Wm)(le,{rounded:"",dense:"",pgMethod:"system_list",label:e.$t("task.system_id"),item:J.item.system_title,itemId:J.item.system_id,ext:{avatar:"image/system.svg",isClearable:"true",pathUrl:"/system"},onUpdate:t[8]||(t[8]=e=>J.item.system_id=e.id),onClear:t[9]||(t[9]=e=>J.item.system_id=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId","ext"])])):(0,s.kq)("",!0)]),(0,s._)("div",p,[(0,s._)("div",h,[(0,s.Wm)(te,{outlined:"",type:"text",modelValue:J.item.description,"onUpdate:modelValue":t[10]||(t[10]=e=>J.item.description=e),label:e.$t("task.description"),autogrow:"",readonly:!1,class:"q-mb-sm col-md-8 col-sm-12 col-xs-12"},null,8,["modelValue","label"])])]),(0,s._)("div",b,[(0,s._)("div",g,["new"!=this.id?((0,s.wg)(),(0,s.j4)(ie,{key:0,fldName:"description_files",label:e.$t("task.description_files"),fld:J.item.description_files,ext:{tableName:"task",tableId:this.id},onUpdate:t[11]||(t[11]=e=>J.item.description_files=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])]),(0,s._)("div",k,[(0,s._)("div",w,["new"!=this.id?((0,s.wg)(),(0,s.j4)(oe,{key:0,label:e.$t("task.description_images"),fld:J.item.description_images,ext:{tableName:"task",tableId:this.id,fldName:"description_images"},onUpdate:t[12]||(t[12]=e=>J.item.description_images=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])]),"new"!=this.id&&X.planEndDateShow?((0,s.wg)(),(0,s.iD)("div",y,[J.item.plan_end_date?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",q,[(0,s.Wm)(ae,{outlined:"",label:e.$t("task.plan_end_date"),"date-string":e.$utils.formatPgDate(J.item.plan_end_date),onUpdate:t[13]||(t[13]=e=>J.item.plan_end_date=e),readonly:!1,class:"q-mb-sm col-md-2 col-sm-3 col-xs-6"},null,8,["label","date-string"])])),J.item.plan_end_date?((0,s.wg)(),(0,s.iD)("div",f,[(0,s.Wm)(ae,{rounded:"",dense:"",label:e.$t("task.plan_end_date"),"date-string":e.$utils.formatPgDate(J.item.plan_end_date),onUpdate:t[14]||(t[14]=e=>J.item.plan_end_date=e),readonly:!1,onClear:t[15]||(t[15]=e=>J.item.fact_end_date=null),class:"q-mb-sm col-md-2 col-sm-3 col-xs-6"},null,8,["label","date-string"])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),"new"!=this.id&&X.factEndDateShow?((0,s.wg)(),(0,s.iD)("div",v,[J.item.fact_end_date?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",x,[(0,s.Wm)(ae,{outlined:"",label:e.$t("task.fact_end_date"),"date-string":e.$utils.formatPgDate(J.item.fact_end_date),onUpdate:t[16]||(t[16]=e=>J.item.fact_end_date=e),readonly:!1,class:"q-mb-sm col-md-2 col-sm-3 col-xs-6"},null,8,["label","date-string"])])),J.item.fact_end_date?((0,s.wg)(),(0,s.iD)("div",Z,[(0,s.Wm)(ae,{rounded:"",dense:"",label:e.$t("task.fact_end_date"),"date-string":e.$utils.formatPgDate(J.item.fact_end_date),onUpdate:t[17]||(t[17]=e=>J.item.fact_end_date=e),readonly:!1,onClear:t[18]||(t[18]=e=>J.item.fact_end_date=null),class:"q-mb-sm col-md-2 col-sm-3 col-xs-6"},null,8,["label","date-string"])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),"new"!=this.id&&X.timePriorityShow?((0,s.wg)(),(0,s.iD)("div",D,[(0,s._)("div",Q,[(0,s.Wm)(te,{outlined:"",dense:"",type:"number",modelValue:J.item.estimate,"onUpdate:modelValue":t[19]||(t[19]=e=>J.item.estimate=e),label:e.$t("task.estimate"),readonly:!1,class:"q-mb-sm col-md-1 col-sm-2 col-xs-6"},null,8,["modelValue","label"])]),(0,s._)("div",U,[(0,s.Wm)(te,{outlined:"",dense:"",type:"number",modelValue:J.item.worked_time,"onUpdate:modelValue":t[20]||(t[20]=e=>J.item.worked_time=e),label:e.$t("task.worked_time"),readonly:!1,class:"q-mb-sm col-md-1 col-sm-2 col-xs-6"},null,8,["modelValue","label"])]),(0,s._)("div",S,[(0,s.Wm)(te,{outlined:"",dense:"",type:"number",modelValue:J.item.customer_priority,"onUpdate:modelValue":t[21]||(t[21]=e=>J.item.customer_priority=e),label:e.$t("task.customer_priority"),readonly:!1,class:"q-mb-sm col-md-1 col-sm-2 col-xs-6"},null,8,["modelValue","label"])])])):(0,s.kq)("",!0),"new"!=this.id&&X.howToCheckShow?((0,s.wg)(),(0,s.iD)("div",C,[(0,s._)("div",I,[(0,s.Wm)(te,{outlined:"",type:"text",modelValue:J.item.how_to_check,"onUpdate:modelValue":t[22]||(t[22]=e=>J.item.how_to_check=e),label:e.$t("task.how_to_check"),autogrow:"",readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["modelValue","label"])])])):(0,s.kq)("",!0),"new"!=this.id&&X.howToCheckShow&&J.item.how_to_check?((0,s.wg)(),(0,s.iD)("div",$,[(0,s._)("div",W,["new"!=this.id?((0,s.wg)(),(0,s.j4)(ie,{key:0,fldName:"how_to_check_files",label:e.$t("task.how_to_check_files"),fld:J.item.how_to_check_files,ext:{tableName:"task",tableId:this.id},onUpdate:t[23]||(t[23]=e=>J.item.how_to_check_files=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),"new"!=this.id&&X.howToCheckShow&&J.item.how_to_check?((0,s.wg)(),(0,s.iD)("div",M,[(0,s._)("div",V,["new"!=this.id?((0,s.wg)(),(0,s.j4)(oe,{key:0,label:e.$t("task.how_to_check_images"),fld:J.item.how_to_check_images,ext:{tableName:"task",tableId:this.id,fldName:"how_to_check_images"},onUpdate:t[24]||(t[24]=e=>J.item.how_to_check_images=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),"new"!=this.id&&X.resultShow?((0,s.wg)(),(0,s.iD)("div",P,[(0,s._)("div",j,[(0,s.Wm)(te,{outlined:"",type:"text",modelValue:J.item.result,"onUpdate:modelValue":t[25]||(t[25]=e=>J.item.result=e),label:e.$t("task.result"),autogrow:"",readonly:!1,class:"q-mb-sm col-md-8 col-sm-12 col-xs-12"},null,8,["modelValue","label"])])])):(0,s.kq)("",!0),"new"!=this.id&&X.resultShow?((0,s.wg)(),(0,s.iD)("div",N,[(0,s._)("div",T,["new"!=this.id?((0,s.wg)(),(0,s.j4)(ie,{key:0,fldName:"result_files",label:e.$t("task.result_files"),fld:J.item.result_files,ext:{tableName:"task",tableId:this.id},onUpdate:t[26]||(t[26]=e=>J.item.result_files=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),"new"!=this.id&&X.resultShow?((0,s.wg)(),(0,s.iD)("div",B,[(0,s._)("div",A,["new"!=this.id?((0,s.wg)(),(0,s.j4)(oe,{key:0,label:e.$t("task.result_images"),fld:J.item.result_images,ext:{tableName:"task",tableId:this.id,fldName:"result_images"},onUpdate:t[27]||(t[27]=e=>J.item.result_images=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),"new"!=this.id&&X.responsibleShow?((0,s.wg)(),(0,s.iD)("div",L,[J.item.executor_responsible_id?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",E,[(0,s.Wm)(le,{outlined:"",pgMethod:"contact_list",label:e.$t("task.executor_responsible_id"),item:J.item.executor_responsible_title,itemId:J.item.executor_responsible_id,ext:{avatar:"image/man.svg",isClearable:"true",pathUrl:"/contact"},onUpdate:t[28]||(t[28]=e=>J.item.executor_responsible_id=e.id),onClear:t[29]||(t[29]=e=>J.item.executor_responsible_id=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId","ext"])])),J.item.executor_responsible_id?((0,s.wg)(),(0,s.iD)("div",z,[(0,s.Wm)(le,{rounded:"",dense:"",pgMethod:"contact_list",label:e.$t("task.executor_responsible_id"),item:J.item.executor_responsible_title,itemId:J.item.executor_responsible_id,ext:{avatar:"image/man.svg",isClearable:"true",pathUrl:"/contact"},onUpdate:t[30]||(t[30]=e=>J.item.executor_responsible_id=e.id),onClear:t[31]||(t[31]=e=>J.item.executor_responsible_id=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId","ext"])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),"new"!=this.id&&X.responsibleShow?((0,s.wg)(),(0,s.iD)("div",H,[J.item.customer_responsible_id?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",O,[(0,s.Wm)(le,{outlined:"",pgMethod:"contact_list",label:e.$t("task.customer_responsible_id"),item:J.item.customer_responsible_title,itemId:J.item.customer_responsible_id,ext:{avatar:"image/man.svg",isClearable:"true",pathUrl:"/contact"},onUpdate:t[32]||(t[32]=e=>J.item.customer_responsible_id=e.id),onClear:t[33]||(t[33]=e=>J.item.customer_responsible_id=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId","ext"])])),J.item.customer_responsible_id?((0,s.wg)(),(0,s.iD)("div",F,[(0,s.Wm)(le,{rounded:"",dense:"",pgMethod:"contact_list",label:e.$t("task.customer_responsible_id"),item:J.item.customer_responsible_title,itemId:J.item.customer_responsible_id,ext:{avatar:"image/man.svg",isClearable:"true",pathUrl:"/contact"},onUpdate:t[34]||(t[34]=e=>J.item.customer_responsible_id=e.id),onClear:t[35]||(t[35]=e=>J.item.customer_responsible_id=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId","ext"])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s._)("div",R,[(0,s._)("div",Y,[(0,s.Wm)(de,{historyList:J.item.history,label:"история",rounded:!0,item:J.item},null,8,["historyList","item"])])]),l.isOpenInDialog?((0,s.wg)(),(0,s.j4)(ce,{key:12,color:"secondary",label:e.$t("message.save"),class:"q-mr-sm",onClick:X.save},null,8,["label","onClick"])):((0,s.wg)(),(0,s.j4)(me,{key:11,onSave:X.save,readonly:!1,onCancel:t[36]||(t[36]=t=>e.$router.push(X.docUrl))},null,8,["onSave"])),(0,s.Wm)(re,{position:"bottom-right",offset:[18,18]},{default:(0,s.w5)((()=>[(0,s.Wm)(ce,{size:"sm",fab:"",icon:"save",color:"primary",onClick:X.save},{default:(0,s.w5)((()=>[(0,s.Wm)(ne,null,{default:(0,s.w5)((()=>[K])),_:1})])),_:1},8,["onClick"])])),_:1})])):(0,s.kq)("",!0)])),_:1})}const J={props:["id","readonly"],mixins:[],data(){return{list:[],isShowAddDialog:!1,deleted:!1,item:{title:null}}},methods:{add(){this.isShowAddDialog=!0},reload(e){this.deleted=!!e,this.$utils.callPgMethod("work_list",{task_id:this.id,deleted:this.deleted,order_by:"created_at desc"},(e=>this.list=e))},saveNew(){if(!this.item.title)return void this.$q.notify({type:"negative",message:'не заполнено поле: "название"'});let e=Object.assign({id:-1,task_id:this.id},this.item);this.$utils.callPgMethod("work_update",e,(()=>{this.isShowAddDialog=!1,this.item.title=null,this.reload()}))},removeRecover({id:e}){this.$utils.callPgMethod("work_update",{id:e,deleted:!this.deleted},(()=>this.reload(this.deleted)))}},mounted(){this.reload()}};var X=l(74260),ee=l(10846),te=l(62025),le=l(2165),se=l(5363),ie=l(27011),oe=l(83414),ae=l(52035),de=l(75096),me=l(2350),ce=l(69721),ne=l(24554),re=l(46778),ue=l(10151),_e=l(25589),pe=l(34842),he=l(99367),be=l(60677),ge=l(7518),ke=l.n(ge);ke()(J,"components",{QBar:ee.Z,QSpace:te.Z,QBtn:le.Z,QTooltip:se.Z,QList:ie.Z,QItem:oe.Z,QItemSection:ae.Z,QAvatar:de.Z,QItemLabel:me.Z,QBadge:ce.Z,QIcon:ne.Z,QDialog:re.Z,QCard:ue.Z,QCardSection:_e.Z,QInput:pe.Z,QCardActions:he.Z}),ke()(J,"directives",{ClosePopup:be.Z});const we={props:["id","readonly"],mixins:[],data(){return{list:[],isShowAddDialog:!1,deleted:!1,item:{title:null}}},methods:{add(){this.isShowAddDialog=!0},reload(e){this.deleted=!!e,this.$utils.callPgMethod("customer_task_list",{task_id:this.id,deleted:this.deleted,order_by:"created_at desc"},(e=>this.list=e))},saveNew(){if(!this.item.title)return void this.$q.notify({type:"negative",message:'не заполнено поле: "название"'});let e=Object.assign({id:-1,task_id:this.id},this.item);this.$utils.callPgMethod("customer_task_update",e,(()=>{this.isShowAddDialog=!1,this.item.title=null,this.reload()}))},removeRecover({id:e}){this.$utils.callPgMethod("customer_task_update",{id:e,deleted:!this.deleted},(()=>this.reload(this.deleted)))}},mounted(){this.reload()}};ke()(we,"components",{QBar:ee.Z,QSpace:te.Z,QBtn:le.Z,QTooltip:se.Z,QList:ie.Z,QItem:oe.Z,QItemSection:ae.Z,QAvatar:de.Z,QItemLabel:me.Z,QBadge:ce.Z,QIcon:ne.Z,QDialog:re.Z,QCard:ue.Z,QCardSection:_e.Z,QInput:pe.Z,QCardActions:he.Z}),ke()(we,"directives",{ClosePopup:be.Z});var ye=l(43015),qe=l(1181);var fe=l(61959),ve=l(48825),xe=l(91589);const Ze={props:["item","currentUser"],setup(e,{emit:t}){const l=(0,fe.iH)(!1),s=()=>l.value=!0,i=(0,fe.iH)(null),o=(0,fe.iH)(""),a=(0,fe.iH)(null),d=(0,fe.iH)(null),m=(0,ve.Z)(),c=()=>{l.value=!0,xe.Z.callPgMethod("task_change_plan_end_date",{task_id:e.item.id,new_plan_end_date:i.value,reason:o.value,side_id:a.value,work_day_quantity:d.value},(e=>{t("reload"),l.value=!1,m.notify({type:"positive",message:"Плановая дата завершения изменена"})}))};return{isShowDialog:l,open:s,planEndDate:i,reason:o,planEndDateChange:c,sideId:a,workDayQuantity:d}}};ke()(Ze,"components",{QDialog:re.Z,QCard:ue.Z,QCardSection:_e.Z,QInput:pe.Z,QCardActions:he.Z,QBtn:le.Z,QTooltip:se.Z}),ke()(Ze,"directives",{ClosePopup:be.Z});const De=(0,s.Uk)("Отправить в бэклог"),Qe=(0,s.Uk)("Отправить в работу"),Ue=(0,s.Uk)("Отправить на внутреннее тестирование"),Se=(0,s.Uk)("Отправить на тестирование заказчику"),Ce=(0,s.Uk)("Готово!");function Ie(e,t,l,i,o,a){const d=(0,s.up)("q-tooltip"),m=(0,s.up)("q-btn");return l.item.stage_id<6?((0,s.wg)(),(0,s.j4)(m,{key:0,round:"",push:"",icon:"skip_next",color:"secondary",onClick:i.setNextStage},{default:(0,s.w5)((()=>[1===l.item.stage_id?((0,s.wg)(),(0,s.j4)(d,{key:0,anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,s.w5)((()=>[De])),_:1})):(0,s.kq)("",!0),2===l.item.stage_id?((0,s.wg)(),(0,s.j4)(d,{key:1,anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,s.w5)((()=>[Qe])),_:1})):(0,s.kq)("",!0),3===l.item.stage_id?((0,s.wg)(),(0,s.j4)(d,{key:2,anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,s.w5)((()=>[Ue])),_:1})):(0,s.kq)("",!0),4===l.item.stage_id?((0,s.wg)(),(0,s.j4)(d,{key:3,anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,s.w5)((()=>[Se])),_:1})):(0,s.kq)("",!0),5===l.item.stage_id?((0,s.wg)(),(0,s.j4)(d,{key:4,anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,s.w5)((()=>[Ce])),_:1})):(0,s.kq)("",!0)])),_:1},8,["onClick"])):(0,s.kq)("",!0)}const $e={props:["item"],setup(e,{emit:t}){const l=()=>{xe.Z.callPgMethod("task_to_backlog",{id:e.item.id},(e=>{t("reload")}))},s=()=>{xe.Z.callPgMethod("task_to_in_process",{id:e.item.id},(e=>{t("reload")}))},i=()=>{xe.Z.callPgMethod("task_to_internal_check",{id:e.item.id},(e=>{t("reload")}))},o=()=>{xe.Z.callPgMethod("task_to_customer_check",{id:e.item.id},(e=>{t("reload")}))},a=()=>{xe.Z.callPgMethod("task_to_done",{id:e.item.id},(e=>{t("reload")}))},d=()=>{switch(e.item.stage_id){case 1:l();break;case 2:s();break;case 3:i();break;case 4:o();break;case 5:a();break}};return{setNextStage:d}}},We=(0,X.Z)($e,[["render",Ie]]),Me=We;ke()($e,"components",{QBtn:le.Z,QTooltip:se.Z});const Ve={props:["id","isOpenInDialog"],components:{SetNextStageButton:Me,TimelineDialogButton:qe.Z},mixins:[ye.Z],computed:{docUrl:function(){return"/task"},planEndDateShow(){switch(this.item.stage_id){case 2:return!0;case 3:return!0;case 4:return!0;case 5:return!0;case 6:return!0}return!1},factEndDateShow(){switch(this.item.stage_id){case 5:return!0;case 6:return!0}return!1},timePriorityShow(){switch(this.item.stage_id){case 2:return!0;case 3:return!0;case 4:return!0;case 5:return!0;case 6:return!0}return!1},workShow(){switch(this.item.stage_id){case 2:return!0;case 3:return!0;case 4:return!0;case 5:return!0;case 6:return!0}return!1},howToCheckShow(){switch(this.item.stage_id){case 4:return!0;case 5:return!0;case 6:return!0}return!1},resultShow(){switch(this.item.stage_id){case 5:return!0;case 6:return!0}return!1},responsibleShow(){switch(this.item.stage_id){case 2:return!0;case 3:return!0;case 4:return!0;case 5:return!0;case 6:return!0}return!1}},data(){return{item:null,flds:[{name:"title",label:"название",required:!0},{name:"type_id",label:"тип задачи"},{name:"stage_id",label:"этап",required:!0},{name:"state_id",label:"статус",required:!0},{name:"system_id",label:"система"},{name:"plan_end_date",label:"плановая дата завершения"},{name:"fact_end_date",label:"фактическая дата завершения"},{name:"customer_priority",label:"приоритет заказчика"},{name:"estimate",label:"оценка"},{name:"worked_time",label:"затрачено"},{name:"description",label:"описание"},{name:"description_files",label:"файлы описания"},{name:"description_images",label:"изображения описания"},{name:"how_to_check",label:"как проверить задачу"},{name:"how_to_check_files",label:"файлы проверки"},{name:"how_to_check_images",label:"изображения проверки"},{name:"result",label:"результат"},{name:"result_files",label:"файлы результата"},{name:"result_images",label:"изображения результата"},{name:"history",label:"история"},{name:"executor_responsible_id",label:"ответственный исполнитель"},{name:"customer_responsible_id",label:"ответственный заказчик"}],optionsFlds:[]}},watch:{},methods:{resultModify(e){return e},save(){this.$utils.saveItem.call(this,{method:"task_update",itemForSaveMod:{},resultModify:this.resultModify})},reload(){let e=e=>{this.item=this.resultModify(e)};this.$utils.getDocItemById.call(this,{method:"task_get_by_id",cb:e})}},mounted(){this.reload()}};var Pe=l(24379),je=l(21007);const Ne=(0,X.Z)(Ve,[["render",G]]),Te=Ne;ke()(Ve,"components",{QPage:Pe.Z,QInput:pe.Z,QBtn:le.Z,QPageSticky:je.Z,QTooltip:se.Z})}}]);