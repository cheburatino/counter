"use strict";(self["webpackChunkElectron"]=self["webpackChunkElectron"]||[]).push([[185],{70185:(e,l,t)=>{t.r(l),t.d(l,{default:()=>Le});t(90246);var s=t(75305);const i={key:1,class:"q-mt-sm"},a={class:"row q-col-gutter-md q-mb-sm"},o={class:"col-md-4 col-sm-6 col-xs-12"},d={class:"row q-col-gutter-md q-mb-sm"},m={class:"col-md-1 col-sm-2 col-xs-6"},n={class:"col-md-1 col-sm-2 col-xs-6"},c={class:"col-md-1 col-sm-2 col-xs-6"},r={key:0,class:"row q-col-gutter-md q-mb-sm"},u={class:"col-md-2 col-sm-4 col-xs-6"},_={class:"row q-col-gutter-md q-mb-sm"},p={key:0,class:"col-md-4 col-sm-6 col-xs-12"},g={key:1,class:"col-md-4 col-sm-6 col-xs-12"},b={class:"row q-col-gutter-md q-mb-sm"},k={key:0,class:"col-md-4 col-sm-6 col-xs-12"},w={key:1,class:"col-md-4 col-sm-6 col-xs-12"},v={class:"row q-col-gutter-md q-mb-sm"},y={key:0,class:"col-md-4 col-sm-6 col-xs-12"},q={key:1,class:"col-md-4 col-sm-6 col-xs-12"},f={class:"row q-col-gutter-md q-mb-sm"},x={key:0,class:"col-md-4 col-sm-6 col-xs-12"},h={key:1,class:"col-md-4 col-sm-6 col-xs-12"},D={key:1,class:"row q-col-gutter-md q-mb-sm"},C={key:0,class:"col-md-4 col-sm-6 col-xs-12"},V={key:1,class:"col-md-4 col-sm-6 col-xs-12"},$={class:"row q-col-gutter-md q-mb-sm"},U={class:"col-md-4 col-sm-6 col-xs-12"},W={class:"row q-col-gutter-md q-mb-sm"},Z={class:"col-md-4 col-sm-6 col-xs-12"},I={class:"row q-col-gutter-md q-mb-sm"},Q={class:"col-md-4 col-sm-6 col-xs-12"},M={key:2,class:"row q-col-gutter-md q-mb-sm"},T={class:"col-md-4 col-sm-6 col-xs-12"},P={key:3,class:"row q-col-gutter-md q-mb-sm"},j={class:"col-md-4 col-sm-6 col-xs-12"},S={key:4,class:"row q-col-gutter-md q-mb-sm"},N={class:"col-md-4 col-sm-6 col-xs-12"},z={class:"row q-col-gutter-md q-mb-sm"},H={class:"col-md-4 col-sm-6 col-xs-12"},B={key:5,class:"row q-col-gutter-md q-mb-sm"},A=(0,s._)("div",{class:"col-md-4 col-sm-6 col-xs-12"},null,-1),O=[A],F={key:6,class:"row q-col-gutter-md q-mb-sm"},L={class:"col-md-4 col-sm-6 col-xs-12"},R={key:7,class:"row q-col-gutter-md q-mb-sm"},E={class:"col-md-4 col-sm-6 col-xs-12"},K={key:8,class:"row q-col-gutter-md q-mb-sm"},J={class:"col-md-4 col-sm-6 col-xs-12"},Y=(0,s.Uk)("Сохранить");function G(e,l,t,A,G,X){const ee=(0,s.up)("comp-breadcrumb"),le=(0,s.up)("q-input"),te=(0,s.up)("q-checkbox"),se=(0,s.up)("comp-fld-ref-search"),ie=(0,s.up)("comp-fld-date"),ae=(0,s.up)("comp-fld-files"),oe=(0,s.up)("comp-fld-img-list"),de=(0,s.up)("time-counter"),me=(0,s.up)("comp-item-btn-save"),ne=(0,s.up)("q-btn"),ce=(0,s.up)("q-tooltip"),re=(0,s.up)("q-page-sticky"),ue=(0,s.up)("q-page");return(0,s.wg)(),(0,s.j4)(ue,{padding:""},{default:(0,s.w5)((()=>[t.isOpenInDialog?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(ee,{key:0,list:[{label:"Работы",to:"/work",docType:"work"},{label:G.item?G.item.title?G.item.title:"Редактирование":"",docType:"edit"}]},null,8,["list"])),G.item?((0,s.wg)(),(0,s.iD)("div",i,[(0,s._)("div",a,[(0,s._)("div",o,[(0,s.Wm)(le,{outlined:"",type:"text",modelValue:G.item.title,"onUpdate:modelValue":l[0]||(l[0]=e=>G.item.title=e),label:e.$t("work.title"),autogrow:"",readonly:!1,class:"q-mb-sm col-md-2 col-sm-3 col-xs-6"},null,8,["modelValue","label"])])]),(0,s._)("div",d,[(0,s._)("div",m,[(0,s.Wm)(le,{outlined:"",type:"number",modelValue:G.item.estimate,"onUpdate:modelValue":l[1]||(l[1]=e=>G.item.estimate=e),label:e.$t("work.estimate"),readonly:!1,class:"q-mb-sm col-md-1 col-sm-2 col-xs-6"},null,8,["modelValue","label"])]),(0,s._)("div",n,[(0,s.Wm)(le,{outlined:"",type:"number",modelValue:G.item.worked_time,"onUpdate:modelValue":l[2]||(l[2]=e=>G.item.worked_time=e),label:e.$t("work.worked_time"),readonly:!0,class:"q-mb-sm col-md-1 col-sm-2 col-xs-6"},null,8,["modelValue","label"])]),(0,s._)("div",c,[(0,s.Wm)(le,{outlined:"",type:"number",modelValue:G.item.specialist_priority,"onUpdate:modelValue":l[3]||(l[3]=e=>G.item.specialist_priority=e),label:e.$t("work.specialist_priority"),readonly:!1,class:"q-mb-sm col-md-1 col-sm-2 col-xs-6"},null,8,["modelValue","label"])])]),2===G.item.state_id||3===G.item.state_id?((0,s.wg)(),(0,s.iD)("div",r,[(0,s._)("div",u,[(0,s.Wm)(te,{label:e.$t("work.today"),modelValue:G.item.today,"onUpdate:modelValue":l[4]||(l[4]=e=>G.item.today=e),disable:!1,"false-value":!1,"indeterminate-value":"some",class:"q-mb-sm col-md-1 col-sm-2 col-xs-6"},null,8,["label","modelValue"])])])):(0,s.kq)("",!0),(0,s._)("div",_,[G.item.state_id?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",p,[(0,s.Wm)(se,{outlined:"",pgMethod:"ctlg_work_state_list",label:e.$t("work.state_id"),item:G.item.state_title,itemId:G.item.state_id,ext:{},onUpdate:l[5]||(l[5]=e=>G.item.state_id=e.id),onClear:l[6]||(l[6]=e=>G.item.state_id=null),readonly:!1,class:"q-mb-sm col-md-2 col-sm-3 col-xs-6"},null,8,["label","item","itemId"])])),G.item.state_id?((0,s.wg)(),(0,s.iD)("div",g,[(0,s.Wm)(se,{rounded:"",dense:"",pgMethod:"ctlg_work_state_list",label:e.$t("work.state_id"),item:G.item.state_title,itemId:G.item.state_id,ext:{},onUpdate:l[7]||(l[7]=e=>G.item.state_id=e.id),onClear:l[8]||(l[8]=e=>G.item.state_id=null),readonly:!1,class:"q-mb-sm col-md-2 col-sm-3 col-xs-6"},null,8,["label","item","itemId"])])):(0,s.kq)("",!0)]),(0,s._)("div",b,[G.item.system_id?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",k,[(0,s.Wm)(se,{outlined:"",pgMethod:"system_list",label:e.$t("work.system_id"),item:G.item.system_title,itemId:G.item.system_id,ext:{avatar:"image/system.png",isClearable:"true",pathUrl:"/system"},onUpdate:l[9]||(l[9]=e=>G.item.system_id=e.id),onClear:l[10]||(l[10]=e=>G.item.system_id=null),readonly:!1,class:"q-mb-sm col-md-2 col-sm-3 col-xs-6"},null,8,["label","item","itemId","ext"])])),G.item.system_id?((0,s.wg)(),(0,s.iD)("div",w,[(0,s.Wm)(se,{rounded:"",dense:"",pgMethod:"system_list",label:e.$t("work.system_id"),item:G.item.system_title,itemId:G.item.system_id,ext:{avatar:"image/system.png",isClearable:"true",pathUrl:"/system"},onUpdate:l[11]||(l[11]=e=>G.item.system_id=e.id),onClear:l[12]||(l[12]=e=>G.item.system_id=null),readonly:!1,class:"q-mb-sm col-md-2 col-sm-3 col-xs-6"},null,8,["label","item","itemId","ext"])])):(0,s.kq)("",!0)]),(0,s._)("div",v,[G.item.task_id?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",y,[(0,s.Wm)(se,{outlined:"",pgMethod:"task_list",label:e.$t("work.task_id"),item:G.item.task_title,itemId:G.item.task_id,ext:{avatar:"image/task.svg",isClearable:"true",pathUrl:"/task"},onUpdate:l[13]||(l[13]=e=>G.item.task_id=e.id),onClear:l[14]||(l[14]=e=>G.item.task_id=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId","ext"])])),G.item.task_id?((0,s.wg)(),(0,s.iD)("div",q,[(0,s.Wm)(se,{rounded:"",dense:"",pgMethod:"task_list",label:e.$t("work.task_id"),item:G.item.task_title,itemId:G.item.task_id,ext:{avatar:"image/task.svg",isClearable:"true",pathUrl:"/task"},onUpdate:l[15]||(l[15]=e=>G.item.task_id=e.id),onClear:l[16]||(l[16]=e=>G.item.task_id=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId","ext"])])):(0,s.kq)("",!0)]),(0,s._)("div",f,[G.item.plan_end_date?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",x,[(0,s.Wm)(ie,{outlined:"",label:e.$t("work.plan_end_date"),"date-string":e.$utils.formatPgDate(G.item.plan_end_date),onUpdate:l[17]||(l[17]=e=>G.item.plan_end_date=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","date-string"])])),G.item.plan_end_date?((0,s.wg)(),(0,s.iD)("div",h,[(0,s.Wm)(ie,{rounded:"",dense:"",label:e.$t("work.plan_end_date"),"date-string":e.$utils.formatPgDate(G.item.plan_end_date),onUpdate:l[18]||(l[18]=e=>G.item.plan_end_date=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","date-string"])])):(0,s.kq)("",!0)]),2===G.item.state_id||3===G.item.state_id||4===G.item.state_id?((0,s.wg)(),(0,s.iD)("div",D,[G.item.fact_end_date?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",C,[(0,s.Wm)(ie,{outlined:"",label:e.$t("work.fact_end_date"),"date-string":e.$utils.formatPgDate(G.item.fact_end_date),onUpdate:l[19]||(l[19]=e=>G.item.fact_end_date=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","date-string"])])),G.item.fact_end_date?((0,s.wg)(),(0,s.iD)("div",V,[(0,s.Wm)(ie,{rounded:"",dense:"",label:e.$t("work.fact_end_date"),"date-string":e.$utils.formatPgDate(G.item.fact_end_date),onUpdate:l[20]||(l[20]=e=>G.item.fact_end_date=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","date-string"])])):(0,s.kq)("",!0)])):(0,s.kq)("",!0),(0,s._)("div",$,[(0,s._)("div",U,[(0,s.Wm)(le,{outlined:"",type:"text",modelValue:G.item.description,"onUpdate:modelValue":l[21]||(l[21]=e=>G.item.description=e),label:e.$t("work.description"),autogrow:"",readonly:!1,class:"q-mb-sm col-md-8 col-sm-12 col-xs-12"},null,8,["modelValue","label"])])]),(0,s._)("div",W,[(0,s._)("div",Z,["new"!=this.id?((0,s.wg)(),(0,s.j4)(ae,{key:0,fldName:"description_files",label:e.$t("work.description_files"),fld:G.item.description_files,ext:{tableName:"work",tableId:this.id},onUpdate:l[22]||(l[22]=e=>G.item.description_files=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])]),(0,s._)("div",I,[(0,s._)("div",Q,["new"!=this.id?((0,s.wg)(),(0,s.j4)(oe,{key:0,label:e.$t("work.description_images"),fld:G.item.description_images,ext:{tableName:"work",tableId:this.id,fldName:"description_images"},onUpdate:l[23]||(l[23]=e=>G.item.description_images=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])]),2===G.item.state_id||3===G.item.state_id||4===G.item.state_id?((0,s.wg)(),(0,s.iD)("div",M,[(0,s._)("div",T,[(0,s.Wm)(le,{outlined:"",type:"text",modelValue:G.item.process,"onUpdate:modelValue":l[24]||(l[24]=e=>G.item.process=e),label:e.$t("work.process"),autogrow:"",readonly:!1,class:"q-mb-sm col-md-8 col-sm-12 col-xs-12"},null,8,["modelValue","label"])])])):(0,s.kq)("",!0),2===G.item.state_id||3===G.item.state_id||4===G.item.state_id?((0,s.wg)(),(0,s.iD)("div",P,[(0,s._)("div",j,["new"!=this.id?((0,s.wg)(),(0,s.j4)(ae,{key:0,fldName:"process_files",label:e.$t("work.process_files"),fld:G.item.process_files,ext:{tableName:"work",tableId:this.id},onUpdate:l[25]||(l[25]=e=>G.item.process_files=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),2===G.item.state_id||3===G.item.state_id||4===G.item.state_id?((0,s.wg)(),(0,s.iD)("div",S,[(0,s._)("div",N,["new"!=this.id?((0,s.wg)(),(0,s.j4)(oe,{key:0,label:e.$t("work.process_images"),fld:G.item.process_images,ext:{tableName:"work",tableId:this.id,fldName:"process_images"},onUpdate:l[26]||(l[26]=e=>G.item.process_images=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),(0,s._)("div",z,[(0,s._)("div",H,[2===G.item.state_id||3===G.item.state_id||4===G.item.state_id?((0,s.wg)(),(0,s.j4)(de,{key:0,item:G.item,onReloadTimeWidget:X.reloadTimeWidget},null,8,["item","onReloadTimeWidget"])):(0,s.kq)("",!0)])]),2===G.item.state_id||3===G.item.state_id||4===G.item.state_id?((0,s.wg)(),(0,s.iD)("div",B,O)):(0,s.kq)("",!0),3===G.item.state_id||4===G.item.state_id?((0,s.wg)(),(0,s.iD)("div",F,[(0,s._)("div",L,[(0,s.Wm)(le,{outlined:"",type:"text",modelValue:G.item.result,"onUpdate:modelValue":l[27]||(l[27]=e=>G.item.result=e),label:e.$t("work.result"),autogrow:"",readonly:!1,class:"q-mb-sm col-md-8 col-sm-12 col-xs-12"},null,8,["modelValue","label"])])])):(0,s.kq)("",!0),3===G.item.state_id||4===G.item.state_id?((0,s.wg)(),(0,s.iD)("div",R,[(0,s._)("div",E,["new"!=this.id?((0,s.wg)(),(0,s.j4)(ae,{key:0,fldName:"result_files",label:e.$t("work.result_files"),fld:G.item.result_files,ext:{tableName:"work",tableId:this.id},onUpdate:l[28]||(l[28]=e=>G.item.result_files=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),3===G.item.state_id||4===G.item.state_id?((0,s.wg)(),(0,s.iD)("div",K,[(0,s._)("div",J,["new"!=this.id?((0,s.wg)(),(0,s.j4)(oe,{key:0,label:e.$t("work.result_images"),fld:G.item.result_images,ext:{tableName:"work",tableId:this.id,fldName:"result_images"},onUpdate:l[29]||(l[29]=e=>G.item.result_images=e),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","fld","ext"])):(0,s.kq)("",!0)])])):(0,s.kq)("",!0),t.isOpenInDialog?((0,s.wg)(),(0,s.j4)(ne,{key:10,color:"secondary",label:e.$t("message.save"),class:"q-mr-sm",onClick:X.save},null,8,["label","onClick"])):((0,s.wg)(),(0,s.j4)(me,{key:9,onSave:X.save,readonly:!1,onCancel:l[30]||(l[30]=l=>e.$router.push(X.docUrl))},null,8,["onSave"])),(0,s.Wm)(re,{position:"bottom-right",offset:[18,18]},{default:(0,s.w5)((()=>[(0,s.Wm)(ne,{size:"sm",fab:"",icon:"save",color:"primary",onClick:X.save},{default:(0,s.w5)((()=>[(0,s.Wm)(ce,null,{default:(0,s.w5)((()=>[Y])),_:1})])),_:1},8,["onClick"])])),_:1})])):(0,s.kq)("",!0)])),_:1})}const X={props:["id","readonly"],mixins:[],data(){return{list:[],isShowAddDialog:!1,deleted:!1,item:{title:null}}},methods:{add(){this.isShowAddDialog=!0},reload(e){this.deleted=!!e,this.$utils.callPgMethod("time_list",{work_id:this.id,deleted:this.deleted,order_by:"created_at desc"},(e=>this.list=e))},saveNew(){if(!this.item.title)return void this.$q.notify({type:"negative",message:'не заполнено поле: "название"'});let e=Object.assign({id:-1,work_id:this.id},this.item);this.$utils.callPgMethod("time_update",e,(()=>{this.isShowAddDialog=!1,this.item.title=null,this.reload()}))},removeRecover({id:e}){this.$utils.callPgMethod("time_update",{id:e,deleted:!this.deleted},(()=>this.reload(this.deleted)))}},mounted(){this.reload()}};var ee=t(74260),le=t(10846),te=t(62025),se=t(2165),ie=t(5363),ae=t(27011),oe=t(83414),de=t(52035),me=t(75096),ne=t(2350),ce=t(69721),re=t(24554),ue=t(46778),_e=t(10151),pe=t(25589),ge=t(34842),be=t(99367),ke=t(60677),we=t(7518),ve=t.n(we);ve()(X,"components",{QBar:le.Z,QSpace:te.Z,QBtn:se.Z,QTooltip:ie.Z,QList:ae.Z,QItem:oe.Z,QItemSection:de.Z,QAvatar:me.Z,QItemLabel:ne.Z,QBadge:ce.Z,QIcon:re.Z,QDialog:ue.Z,QCard:_e.Z,QCardSection:pe.Z,QInput:ge.Z,QCardActions:be.Z}),ve()(X,"directives",{ClosePopup:ke.Z});var ye=t(43015);const qe=e=>((0,s.dD)("data-v-6cd5b7a1"),e=e(),(0,s.Cn)(),e),fe=qe((()=>(0,s._)("h4",null,"Запустить новый счётчик?",-1))),xe=qe((()=>(0,s._)("h4",{class:"text-center"},"Закрыть счётчик",-1))),he=qe((()=>(0,s._)("p",null,null,-1))),De=qe((()=>(0,s._)("p",null,null,-1))),Ce=qe((()=>(0,s._)("div",null,null,-1))),Ve=(0,s.Uk)("Всего полезной нагрузки по работе "),$e=qe((()=>(0,s._)("br",null,null,-1))),Ue=qe((()=>(0,s._)("p",null,null,-1))),We=qe((()=>(0,s._)("p",null,null,-1))),Ze={align:"center"},Ie={class:"text-center row justify-between"},Qe={class:"q-pa-md q-gutter-sm"},Me={class:"q-pa-md q-mr-sm q-gutter-sm",style:{"padding-left":"0px"}},Te={class:"q-mb-none"};function Pe(e,l,t,i,a,o){const d=(0,s.up)("q-btn"),m=(0,s.up)("q-card"),n=(0,s.up)("q-dialog"),c=(0,s.up)("q-input");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(n,{modelValue:i.isPlayDialog,"onUpdate:modelValue":l[0]||(l[0]=e=>i.isPlayDialog=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"q-pa-md q-gutter-sm text-center"},{default:(0,s.w5)((()=>[fe,(0,s.Wm)(d,{rounded:"",push:"",icon:"local_fire_department",color:"secondary",size:"xl",label:"Ну погнали",onClick:i.createTime},null,8,["onClick"])])),_:1})])),_:1},8,["modelValue"]),(0,s.Wm)(n,{modelValue:i.isConfirmDialog,"onUpdate:modelValue":l[5]||(l[5]=e=>i.isConfirmDialog=e)},{default:(0,s.w5)((()=>[(0,s.Wm)(m,{class:"q-pa-md q-gutter-sm",style:{"min-width":"30vw"}},{default:(0,s.w5)((()=>[xe,he,De,(0,s._)("p",null,[(0,s._)("strong",null,"ID: "+(0,s.zw)(i.activeTime.id),1)]),(0,s._)("p",null,[(0,s._)("strong",null,"Начало: "+(0,s.zw)(new Date(i.activeTime.start_time).toLocaleString()),1)]),Ce,(0,s._)("div",null,[(0,s.Wm)(c,{autogrow:"",label:"Работа",readonly:!0,modelValue:i.activeTime.options.title.work_title,"onUpdate:modelValue":l[1]||(l[1]=e=>i.activeTime.options.title.work_title=e),class:"q-my-md"},null,8,["modelValue"])]),(0,s._)("div",null,[(0,s.Wm)(c,{autogrow:"",label:"Система",readonly:!0,modelValue:i.activeTime.options.title.system_title,"onUpdate:modelValue":l[2]||(l[2]=e=>i.activeTime.options.title.system_title=e),class:"q-mb-md"},null,8,["modelValue"])]),(0,s._)("div",null,[(0,s.Wm)(c,{autogrow:"",label:"Полезная нагрузка",readonly:!0,modelValue:i.activeTime.effort,"onUpdate:modelValue":l[3]||(l[3]=e=>i.activeTime.effort=e),class:"q-mb-md"},null,8,["modelValue"])]),(0,s._)("p",null,[(0,s._)("strong",null,[Ve,$e,(0,s.Uk)("после завершения: "+(0,s.zw)(t.item.worked_time+i.activeTime.effort),1)])]),Ue,We,(0,s._)("div",null,[(0,s.Wm)(c,{autogrow:"",autofocus:"",modelValue:i.timeDescription,"onUpdate:modelValue":l[4]||(l[4]=e=>i.timeDescription=e),label:"Описание",class:"q-mb-md"},null,8,["modelValue"])]),(0,s._)("div",Ze,[(0,s.Wm)(d,{rounded:"",push:"","icon-right":"done",color:"positive",size:"xl",label:"Готово",onClick:i.counterConfirm},null,8,["onClick"])])])),_:1})])),_:1},8,["modelValue"]),(0,s._)("div",null,[(0,s.Wm)(m,{style:{"border-radius":"20px"}},{default:(0,s.w5)((()=>[(0,s._)("div",Ie,[(0,s._)("div",Qe,[i.isCounting?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(d,{key:0,rounded:"",push:"",icon:"play_arrow",color:"secondary",size:"xl",onClick:i.counterPlay,style:(0,s.j5)(i.elapsedSeconds?"":"margin-left: 40px")},null,8,["onClick","style"])),i.isCounting?((0,s.wg)(),(0,s.j4)(d,{key:1,rounded:"",push:"",icon:"pause",color:"warning",size:"xl",onClick:i.counterPause,style:{"margin-left":"40px"}},null,8,["onClick"])):(0,s.kq)("",!0),!i.isCounting&&i.elapsedSeconds?((0,s.wg)(),(0,s.j4)(d,{key:2,rounded:"",push:"",icon:"done",color:"positive",size:"xl",onClick:i.counterConfirmDialogButton},null,8,["onClick"])):(0,s.kq)("",!0)]),(0,s._)("div",Me,[(0,s._)("h2",Te,(0,s.zw)(i.counterDisplay),1)])])])),_:1})])],64)}var je=t(91589);const Se={name:"TimeCounter",components:{},props:["item"],setup(e,{emit:l}){const t=(0,s.iH)(0),i=(0,s.iH)("00:00");let a=(0,s.iH)(null);const o=(0,s.iH)(!1),d=(0,s.iH)(!1),m=(0,s.iH)(!1),n=(0,s.iH)(""),c=(0,s.iH)(null),r=(0,s.Fl)((()=>{if(c.value&&1===c.value.state_id&&!c.value.counter_start_time&&(c.value.effort>0&&(p(60*c.value.effort),g()),0===c.value.effort&&(p(Math.round((Date.now()-Date.parse(c.value.start_time))/1e3)),g())),c.value&&1===c.value.state_id&&c.value.counter_start_time){if(c.value.effort>0&&(p(Math.round(60*c.value.effort+(Date.now()-Date.parse(c.value.counter_start_time))/1e3)),g()),0!==c.value.effort)return 0;p(Math.round((Date.now()-Date.parse(c.value.counter_start_time))/1e3)),g()}if(c.value&&2===c.value.state_id){if(b(),!(c.value.effort>0))return 0;p(60*c.value.effort)}return t.value})),u=e=>{je.Z.callPgMethod("time_get_by_id",{id:e},(e=>{c.value=e,r.value++,l("reloadTimeWidget")}))},_=()=>{t.value++,p(t.value)},p=e=>{t.value=e;const l=Math.floor(t.value%216e3/60/60),s=Math.floor(t.value%3600/60),a=t.value%60,o=e=>e<10?`0${e}`:e;t.value>59&&(i.value=`${l}:${o(s)}`),t.value<60&&(i.value=`${o(s)}:${o(a)}`)},g=()=>{b(),a=setInterval((()=>{_()}),1e3),o.value=!0},b=()=>{clearInterval(a),o.value=!1},k=()=>{c.value&&2===c.value.state_id?je.Z.callPgMethod("time_counter_continue",{work_id:e.item.id},(e=>{console.log("time_counter_continue result time id:",e.result.id),u(e.result.id)})):d.value=!0},w=()=>{je.Z.callPgMethod("time_counter_create",{work_id:e.item.id,system_id:e.item.system_id},(e=>{d.value=!1,u(e.result.id),g(),l("reloadTimeWidget")}))},v=()=>{je.Z.callPgMethod("time_list",{work_id:e.item.id,deleted:!1,order_by:"state_id"},(e=>{e[0]&&(3!==e[0].state_id?u(e[0].id):c.value=null)}))};v();const y=()=>{b(),je.Z.callPgMethod("time_counter_pause",{work_id:e.item.id},(e=>{u(e.result.id),b()}))},q=()=>{m.value=!0},f=()=>{je.Z.callPgMethod("time_counter_confirm",{work_id:e.item.id,description:n.value},(e=>{m.value=!1,b(),n.value="",i.value="00:00",t.value=null,c.value=null,l("reloadTimeWidget")}))};return(0,s.Jd)((()=>{b()})),{counterDisplay:i,initCountdown:g,stopCountdown:b,elapsedSeconds:t,isCounting:o,isPlayDialog:d,counterPlay:k,createTime:w,counterPause:y,isConfirmDialog:m,counterConfirmDialogButton:q,counterConfirm:f,activeTime:c,timeDescription:n}}},Ne=(0,ee.Z)(Se,[["render",Pe],["__scopeId","data-v-6cd5b7a1"]]),ze=Ne;ve()(Se,"components",{QDialog:ue.Z,QCard:_e.Z,QBtn:se.Z,QInput:ge.Z});const He={props:["id","isOpenInDialog"],components:{TimeCounter:ze},mixins:[ye.Z],computed:{docUrl:function(){return"/work"}},data(){return{item:null,timeKey:0,flds:[{name:"title",label:"название",required:!0},{name:"estimate",label:"оценка"},{name:"worked_time",label:"затрачено"},{name:"today",label:"в работе сегодня"},{name:"specialist_priority",label:"приоритет"},{name:"state_id",label:"статус"},{name:"system_id",label:"система"},{name:"executor_id",label:"исполнитель"},{name:"task_id",label:"задача"},{name:"plan_end_date",label:"плановая дата завершения"},{name:"fact_end_date",label:"фактическая дата завершения"},{name:"description",label:"описание"},{name:"description_files",label:"файлы описания"},{name:"description_images",label:"изображения описания"},{name:"process",label:"процесс"},{name:"process_files",label:"файлы результата"},{name:"process_images",label:"изображения результата"},{name:"result",label:"результат"},{name:"result_files",label:"файлы результата"},{name:"result_images",label:"изображения результата"}],optionsFlds:[]}},watch:{},methods:{resultModify(e){return e},save(){this.$utils.saveItem.call(this,{method:"work_update",itemForSaveMod:{},resultModify:this.resultModify})},reload(){let e=e=>{this.item=this.resultModify(e)};this.$utils.getDocItemById.call(this,{method:"work_get_by_id",cb:e})},reloadTimeWidget(){this.timeKey++}},mounted(){this.reload()}};var Be=t(24379),Ae=t(65735),Oe=t(21007);const Fe=(0,ee.Z)(He,[["render",G]]),Le=Fe;ve()(He,"components",{QPage:Be.Z,QInput:ge.Z,QCheckbox:Ae.Z,QBtn:se.Z,QPageSticky:Oe.Z,QTooltip:ie.Z})}}]);