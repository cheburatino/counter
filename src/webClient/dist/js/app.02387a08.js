(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{0:function(t,e,s){t.exports=s("2f39")},"0725":function(t,e,s){"use strict";var a=s("2f63"),i=s.n(a);i.a},"2f39":function(t,e,s){"use strict";s.r(e);var a=s("a34a"),i=s.n(a),n=(s("a481"),s("96cf"),s("c973")),o=s.n(n),l=(s("573e"),s("7d6e"),s("e54f"),s("62f2"),s("7e6d"),s("a026")),r=s("14c0"),c=s("b05d"),u=s("cb32"),d=s("4d5a"),p=s("d847"),m=s("58a8"),f=s("b047"),h=s("e359"),g=s("52ee"),b=s("9404"),v=s("24e8"),w=s("54e1"),_=s("9c40"),x=s("f20b"),y=s("ead5"),q=s("079eb"),k=s("f09f"),S=s("4b7e"),D=s("a370"),j=s("8f8e"),$=s("8169"),C=s("d66b"),N=s("8572"),F=s("3b73"),I=s("c294"),O=s("72db"),T=s("0016"),U=s("068f"),L=s("27f9"),M=s("ef35"),E=s("74f7"),P=s("1c1c"),R=s("3845"),Q=s("66e5"),z=s("4074"),A=s("0170"),Y=s("4e73"),B=s("09e3"),H=s("9989"),V=s("de5e"),J=s("7cbe"),G=s("42a1"),W=s("3786"),K=s("7867"),Z=s("4983"),X=s("eb85"),tt=s("2c91"),et=s("8380"),st=s("ddd8"),at=s("c1d0"),it=s("e9c1"),nt=s("87fe"),ot=s("f531"),lt=s("b19c"),rt=s("8562"),ct=s("eaac"),ut=s("429b"),dt=s("7460"),pt=s("adad"),mt=s("823b"),ft=s("ca78"),ht=s("05eb"),gt=s("74af"),bt=s("9564"),vt=s("65c6"),wt=s("6ac5"),_t=s("05c0"),xt=s("bd08"),yt=s("7f41"),qt=s("db86"),kt=s("ee89"),St=s("6ac0"),Dt=s("714f"),jt=s("7f67"),$t=s("2a19"),Ct=s("436b");l["a"].use(c["a"],{config:{},lang:r["a"],components:{QAvatar:u["a"],QLayout:d["a"],QBar:p["a"],QBadge:m["a"],QChip:f["a"],QHeader:h["a"],QDate:g["a"],QDrawer:b["a"],QDialog:v["a"],QBanner:w["a"],QBtn:_["a"],QBtnDropdown:x["a"],QBreadcrumbs:y["a"],QBreadcrumbsEl:q["a"],QCard:k["a"],QCardActions:S["a"],QCardSection:D["a"],QCheckbox:j["a"],QChatMessage:$["a"],QEditor:C["a"],QField:N["a"],QExpansionItem:F["a"],QFab:I["a"],QFabAction:O["a"],QIcon:T["a"],QImg:U["a"],QInput:L["a"],QInfiniteScroll:M["a"],QInnerLoading:E["a"],QList:P["a"],QKnob:R["a"],QItem:Q["a"],QItemSection:z["a"],QItemLabel:A["a"],QMenu:Y["a"],QPageContainer:B["a"],QPage:H["a"],QPageSticky:V["a"],QPopupProxy:J["a"],QPopupEdit:G["a"],QRadio:W["a"],QRouteTab:K["a"],QScrollArea:Z["a"],QSeparator:X["a"],QSpace:tt["a"],QSpinnerDots:et["a"],QSelect:st["a"],QSlider:at["a"],QSlideTransition:it["a"],QStep:nt["a"],QStepper:ot["a"],QStepperNavigation:lt["a"],QSplitter:rt["a"],QTable:ct["a"],QTabs:ut["a"],QTab:dt["a"],QTabPanels:pt["a"],QTabPanel:mt["a"],QTime:ft["a"],QTimeline:ht["a"],QTimelineEntry:gt["a"],QToggle:bt["a"],QToolbar:vt["a"],QToolbarTitle:wt["a"],QTooltip:_t["a"],QTr:xt["a"],QTree:yt["a"],QTd:qt["a"],QUploader:kt["a"],QVideo:St["a"]},directives:{Ripple:Dt["a"],ClosePopup:jt["a"]},plugins:{Notify:$t["a"],Dialog:Ct["a"]}});var Nt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"q-app"}},[t.isLoggedIn||t.isInLogingProcess?t._e():s("auth-comp"),t.isWaitingAuth?s("waiting-auth-page"):t._e(),t.isFired?s("fired-page"):t._e(),t.isLoggedIn&&t.isWorking?s("q-layout",{attrs:{view:"hHh Lpr lFf"}},[s("q-header",{staticClass:"bg-white text-grey-8 q-py-xs",attrs:{reveal:"",elevated:""}},[s("q-toolbar",[s("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"menu"},on:{click:function(e){t.leftSide=!t.leftSide}}}),s("q-btn",{staticClass:"q-ml-xs",attrs:{flat:"","no-caps":"","no-wrap":""},on:{click:function(e){return t.$router.push("/")}}},[s("q-toolbar-title",{staticClass:"text-weight-bold",attrs:{shrink:""}},[t._v("\n              "+t._s(t.$config.uiAppName)+"\n            ")])],1),s("q-space"),s("div",{staticClass:"q-gutter-sm row items-center no-wrap"},[s("toolbar-task-btn",{attrs:{counter:t.taskCounter},on:{click:t.toggleTaskList}}),s("toolbar-message-btn",{attrs:{counter:t.messageCounter},on:{click:t.toggleMsgList}}),s("current-user-toolbar-menu",{attrs:{currentUser:t.currentUser},on:{logout:t.logout}})],1)],1)],1),s("side-menu",{attrs:{leftSide:t.leftSide,currentUser:t.currentUser},on:{hide:function(e){t.leftSide=!1}}}),s("message-list",{ref:"messageList",attrs:{rightSide:t.isShowMsgList,currentUser:t.currentUser},on:{hide:function(e){t.isShowMsgList=!1},updateCounter:function(e){return t.messageCounter=e}}}),s("task-list",{ref:"taskList",attrs:{rightSide:t.isShowTaskList,currentUser:t.currentUser},on:{hide:function(e){t.isShowTaskList=!1},updateCounter:function(e){return t.taskCounter=e}}}),s("q-page-container",[s("router-view",{key:t.$route.fullPath,attrs:{currentUser:t.currentUser},on:{reloadMsgList:function(e){t.$refs.messageList&&t.$refs.messageList.reload()}}})],1)],1):t._e()],1)},Ft=[],It=s("f488"),Ot=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-btn",{attrs:{round:"",flat:""}},[s("q-avatar",{attrs:{rounded:"",size:"26px"}},[t.currentUser.avatar?s("comp-stat-img-src",{attrs:{src:t.currentUser.avatar}}):s("img",{attrs:{src:"https://www.svgrepo.com/show/95333/avatar.svg"}})],1),s("q-menu",{attrs:{"transition-show":"flip-right","transition-hide":"flip-left","auto-close":""}},[s("q-list",{attrs:{dense:""}},[s("q-item",{staticClass:"GL__menu-link-signed-in"},[s("q-item-section",[s("div",[s("strong",[t._v(t._s(t.currentUser.fullname))])])])],1),s("q-separator"),s("q-item",{staticClass:"GL__menu-link",attrs:{clickable:""}},[s("q-item-section",{on:{click:function(e){return t.$router.push("/profile")}}},[t._v("редактировать")])],1),s("q-separator"),s("q-item",{staticClass:"GL__menu-link",attrs:{clickable:""}},[s("q-item-section",{on:{click:function(e){return t.$emit("logout")}}},[t._v("выйти")])],1)],1)],1)],1)},Tt=[],Ut={props:["currentUser"],data:function(){return{}}},Lt=Ut,Mt=s("2877"),Et=Object(Mt["a"])(Lt,Ot,Tt,!1,null,null,null),Pt=Et.exports,Rt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-drawer",{attrs:{value:t.leftSide,side:"left",bordered:"","show-if-above":"","content-class":"bg-grey-2",width:240},on:{hide:function(e){return t.$emit("hide")}}},[s("q-scroll-area",{staticClass:"fit"},[s("q-list",{attrs:{padding:""}},t._l(t.menuLinks,(function(e){return s("div",{key:e.text},[t.isRole(e.roles)?s("span",[e.isFolder?s("q-expansion-item",{attrs:{"header-class":"text-grey",closed:""},scopedSlots:t._u([{key:"header",fn:function(){return[s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{attrs:{rounded:""}},[s("img",{attrs:{src:e.icon}})])],1),s("q-item-section",[t._v("\n                    "+t._s(e.text)+"\n                  ")])]},proxy:!0}],null,!0)},t._l(e.linkList,(function(e){return s("span",{key:e.text},[t.isRole(e.roles)?s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{"inset-level":1,clickable:"",to:e.url,exact:""}},[s("q-item-section",[s("q-item-label",[t._v(t._s(e.text))])],1)],1):t._e()],1)})),0):s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:"",to:e.url,exact:""}},[s("q-item-section",{attrs:{avatar:""}},[s("q-avatar",{attrs:{rounded:""}},[s("img",{attrs:{src:e.icon}})])],1),s("q-item-section",[s("q-item-label",[t._v(t._s(e.text))])],1)],1)],1):t._e()])})),0)],1)],1)},Qt=[],zt=(s("6762"),s("2fdb"),{props:["leftSide","currentUser"],computed:{isRole:function(){var t=this;return function(e){if(!e||0===e.length)return!0;if(!t.currentUser.role)return!1;var s=!1;return t.currentUser.role.map((function(t){e.includes(t)&&(s=!0)})),s}}},data:function(){return{menuLinks:[{icon:"statics/image/user.svg",text:"Пользователи",url:"/users",roles:["admin"]},{icon:"statics/image/project.svg",text:"Проекты",url:"/project",roles:[]},{icon:"statics/image/internal_task.svg",text:"Внутренние задачи",url:"/internal_task",roles:[]},{icon:"statics/image/client.svg",text:"Клиенты",url:"/client",roles:[]},{icon:"statics/image/man.svg",text:"Люди",url:"/man",roles:[]}]}}}),At=zt,Yt=Object(Mt["a"])(At,Rt,Qt,!1,null,null,null),Bt=Yt.exports,Ht=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isRedirectToLoginPage?s("login-page"):s("div",[s("router-view")],1)],1)},Vt=[],Jt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"layout"},[s("div",[t._m(0),s("div",{staticClass:"row justify-center q-mt-lg"},[s("email-btn")],1)])])},Gt=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row justify-center",staticStyle:{"margin-top":"20px","margin-bottom":"10px"}},[s("img",{staticStyle:{width:"auto","max-height":"100px"},attrs:{src:"statics/image/electron_logo.png",alt:""}})])}],Wt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-btn",{attrs:{size:"md",outline:"",color:"primary",disabled:t.disabled},on:{click:t.login}},[s("q-icon",{attrs:{left:"",size:"3em",name:"perm_identity"}}),s("div",[t._v("войти")])],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.modalIsOpened,callback:function(e){t.modalIsOpened=e},expression:"modalIsOpened"}},[s("q-card",{staticStyle:{"min-width":"35%"}},[s("q-toolbar",[s("q-toolbar-title",[s("span",{staticClass:"text-weight-bold"},[t._v(t._s(t.dialogTitle))])]),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"}})],1),s("q-card-section",[t.emailRegister.isNewRegister||t.emailRegister.isPasswordRecover?t._e():s("comp-login-form",{on:{register:t.showNewEmailUserRegister,passwordRecover:t.showPasswordRecover}}),t.emailRegister.isNewRegister?s("comp-register-form",{on:{cancel:t.resetRegisterForm}}):t._e(),t.emailRegister.isPasswordRecover?s("comp-recover-password-form",{on:{cancel:t.resetPasswordRecover}}):t._e()],1)],1)],1)],1)},Kt=[],Zt=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"q-gutter-md"},[s("q-input",{attrs:{outlined:"",type:"email",label:"email",autofocus:!0},scopedSlots:t._u([{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:"email"}})]},proxy:!0}]),model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),s("q-input",{attrs:{outlined:"",type:"password",label:"пароль"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.login(e))}},scopedSlots:t._u([{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:"lock"}})]},proxy:!0}]),model:{value:t.password,callback:function(e){t.password=e},expression:"password"}}),s("div",[s("q-btn",{staticClass:"full-width",attrs:{color:"primary"},on:{click:t.login,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login(e)}}},[t._v("войти")])],1),s("div",{staticClass:"row wrap justify-center items-start content-start"},[s("q-btn",{staticClass:"col",staticStyle:{"margin-bottom":"10px"},attrs:{flat:"",color:"secondary"},on:{click:function(e){return t.$emit("register")}}},[t._v("\n      зарегистрироваться\n    ")]),s("q-btn",{staticClass:"col",staticStyle:{"margin-bottom":"10px"},attrs:{flat:"",color:"secondary"},on:{click:function(e){return t.$emit("passwordRecover")}}},[t._v("забыли\n      пароль?\n    ")])],1)],1)},Xt=[],te={data:function(){return{email:null,password:null}},methods:{login:function(){var t=this;ee(this.email)?!this.password||this.password.length<7?this.$q.notify({message:"Пароль должен быть больше 7 знаков",type:"negative",position:"top-right"}):this.$utils.postApiRequest({url:"/auth/email",params:{login:this.email,password:this.password},isShowError:!1}).subscribe((function(e){e.ok?t.$currentUser.login({user:e.result}):e.message.includes("user not found")?t.$q.notify({message:"Пользователь с таким email не найден",type:"negative",position:"top-right"}):e.message.includes("wrong password")?t.$q.notify({message:"Неверный пароль",type:"negative",position:"top-right"}):t.$q.notify({message:e.message,type:"negative",position:"top-right"})})):this.$q.notify({message:'Поле "email" заполнено неверно',type:"negative",position:"top-right"})}}},ee=function(t){var e=/\S+@\S+\.\S+/;return e.test(t)},se=te,ae=Object(Mt["a"])(se,Zt,Xt,!1,null,null,null),ie=ae.exports,ne=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isRegisterSuccess?t._e():s("div",{staticClass:"q-gutter-md"},[t._l(t.flds,(function(e,a){return s("q-input",{key:e.model,attrs:{outlined:"",type:e.type,label:e.label,autofocus:0===a},scopedSlots:t._u([{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:e.icon}})]},proxy:!0}],null,!0),model:{value:t.regForm[e.model],callback:function(s){t.$set(t.regForm,e.model,s)},expression:"regForm[fld.model]"}})})),s("div",{staticClass:"row wrap justify-center items-start content-start q-gutter-md",staticStyle:{"margin-left":"0"}},[s("q-btn",{staticClass:"col",attrs:{outline:"",color:"secondary"},on:{click:function(e){return t.$emit("cancel")}}},[t._v("отмена")]),s("q-btn",{staticClass:"col",attrs:{color:"primary"},on:{click:t.login}},[t._v("ok")])],1)],2),t.isRegisterSuccess?s("div",[t._m(0)]):t._e()])},oe=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticStyle:{padding:"20px"}},[t._v("Проверьте указанный в регистрации email."),s("br"),t._v("Должно прийти письмо для\n      подтверждения почтового адреса.\n    ")])}],le=(s("f751"),{data:function(){return{regForm:{},flds:[{model:"login",label:"email",type:"email",icon:"email"},{model:"password",label:"пароль",type:"password",icon:"lock"},{model:"passwordRepeat",label:"повторите пароль",type:"password",icon:"lock"},{model:"last_name",label:"фамилия",type:"text",icon:"person"},{model:"first_name",label:"имя",type:"text",icon:"person_outline"}],isRegisterSuccess:!1}},methods:{login:function(){var t=this;if(re(this.regForm.login))if(!this.regForm.password||this.regForm.password.length<7)this.$q.notify({message:"Пароль должен быть больше 7 знаков",type:"negative",position:"top-right"});else if(this.regForm.password===this.regForm.passwordRepeat)if(this.regForm.first_name)if(this.regForm.last_name){var e=Object.assign({is_register:!0},this.regForm);this.$utils.postApiRequest({url:"/auth/email",params:e,isShowError:!1}).subscribe((function(e){e.ok?t.isRegisterSuccess=!0:e.message.includes("email already exist")?t.$q.notify({message:"Пользователь с таким email уже зарегестрирован",type:"negative",position:"top-right"}):t.$q.notify({message:e.message,type:"negative",position:"top-right"})}))}else this.$q.notify({message:'Необходимо заполнить поле "фамилия"',type:"negative",position:"top-right"});else this.$q.notify({message:'Необходимо заполнить поле "имя"',type:"negative",position:"top-right"});else this.$q.notify({message:"Повторно введенный пароль не совпадает с первым вариантом",type:"negative",position:"top-right"});else this.$q.notify({message:'Поле "email" заполнено неверно',type:"negative",position:"top-right"})}},mounted:function(){var t=this;this.flds.map((function(e){return t.$set(t.regForm,e,null)}))}}),re=function(t){var e=/\S+@\S+\.\S+/;return e.test(t)},ce=le,ue=Object(Mt["a"])(ce,ne,oe,!1,null,null,null),de=ue.exports,pe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isSuccess?t._e():s("div",{staticClass:"q-gutter-md"},[s("q-input",{attrs:{outlined:"",type:"email",label:"Ваш email",autofocus:!0},scopedSlots:t._u([{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:"email"}})]},proxy:!0}],null,!1,3271653952),model:{value:t.email,callback:function(e){t.email=e},expression:"email"}}),s("div",{staticClass:"row wrap justify-center items-start content-start q-gutter-md",staticStyle:{"margin-left":"0"}},[s("q-btn",{staticClass:"col",attrs:{outline:"",color:"secondary"},on:{click:function(e){return t.$emit("cancel")}}},[t._v("отмена")]),s("q-btn",{staticClass:"col",attrs:{color:"primary"},on:{click:t.ok}},[t._v("ok")])],1)],1),t.isSuccess?s("q-banner",{staticClass:"bg-grey-3 q-pa-md",attrs:{"inline-actions":""}},[s("div",{staticStyle:{padding:"20px"}},[t._v("Проверьте указанный в регистрации email."),s("br"),t._v("Должно прийти письмо с ссылкой для\n      восстановления пароля.\n    ")])]):t._e()],1)},me=[],fe={data:function(){return{email:null,isSuccess:!1}},methods:{ok:function(){var t=this;he(this.email)?this.$utils.postApiRequest({url:"/auth/email_auth_start_recover_password",params:{email:this.email},isShowError:!1}).subscribe((function(e){e.ok?t.isSuccess=!0:e.message.includes("user not found")?t.$q.notify({message:"Пользователь с таким email не зарегестрирован",type:"negative",position:"top-right"}):t.$q.notify({message:e.message,type:"negative",position:"top-right"})})):this.$q.notify({message:'Поле "email" заполнено неверно',type:"negative",position:"top-right"})}}},he=function(t){var e=/\S+@\S+\.\S+/;return e.test(t)},ge=fe,be=Object(Mt["a"])(ge,pe,me,!1,null,null,null),ve=be.exports,we={props:["disabled"],components:{compLoginForm:ie,compRegisterForm:de,compRecoverPasswordForm:ve},computed:{dialogTitle:function(){return this.emailRegister.isNewRegister?"Регистрация":this.emailRegister.isPasswordRecover?"Восстановление пароля":"Авторизация"}},data:function(){return{modalIsOpened:!1,emailRegister:{isNewRegister:!1,isNewRegisterSuccess:!1,isPasswordRecover:!1,isPasswordRecoverSuccess:!1}}},methods:{login:function(){this.modalIsOpened=!0},showNewEmailUserRegister:function(){this.emailRegister.isNewRegister=!0,this.emailRegister.isNewRegisterSuccess=!1},resetRegisterForm:function(){this.emailRegister.isNewRegister=!1},showPasswordRecover:function(){this.emailRegister.isPasswordRecover=!0},resetPasswordRecover:function(){this.emailRegister.isPasswordRecover=!1}}},_e=we,xe=(s("ca37"),Object(Mt["a"])(_e,Wt,Kt,!1,null,"793f4158",null)),ye=xe.exports,qe={components:{emailBtn:ye},data:function(){return{}}},ke=qe,Se=Object(Mt["a"])(ke,Jt,Gt,!1,null,null,null),De=Se.exports,je={components:{loginPage:De},computed:{isRedirectToLoginPage:function(){return!["/check_user_email","/email_auth_recover_password"].includes(this.$route.path)}}},$e=je,Ce=Object(Mt["a"])($e,Ht,Vt,!1,null,null,null),Ne=Ce.exports,Fe=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-btn",{attrs:{round:"",dense:"",flat:"",color:"grey-8",icon:"access_alarm"},on:{click:function(e){return t.$emit("click")}}},[t.counter>0?s("q-badge",{attrs:{color:"red","text-color":"white",floating:""}},[t._v("\n    "+t._s(t.counter)+"\n  ")]):t._e(),s("q-tooltip",[t._v("Задачи")])],1)},Ie=[],Oe={props:["counter"]},Te=Oe,Ue=Object(Mt["a"])(Te,Fe,Ie,!1,null,null,null),Le=Ue.exports,Me=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-btn",{attrs:{round:"",dense:"",flat:"",color:"grey-8",icon:"notifications"},on:{click:function(e){return t.$emit("click")}}},[t.counter>0?s("q-badge",{attrs:{color:"red","text-color":"white",floating:""}},[t._v("\n    "+t._s(t.counter)+"\n  ")]):t._e(),s("q-tooltip",[t._v("Сообщения")])],1)},Ee=[],Pe={props:["counter"]},Re=Pe,Qe=Object(Mt["a"])(Re,Me,Ee,!1,null,null,null),ze=Qe.exports,Ae=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-drawer",{attrs:{value:t.rightSide,side:"right",bordered:""},on:{hide:function(e){return t.$emit("hide")}}},[s("q-list",{attrs:{separator:""}},[s("q-item-label",{attrs:{header:""}},[t._v("\n        Сообщения\n      ")]),s("div",{staticStyle:{position:"absolute",top:"10px",right:"10px"}},[s("q-btn",{attrs:{round:"",flat:"",color:"secondary",icon:"refresh",size:"sm"},on:{click:t.reload}})],1),s("q-separator"),t._l(t.listForRender,(function(e){return s(e.template,{key:e.id,tag:"component",attrs:{item:e},on:{markAsRead:t.markAsRead}})}))],2),s("q-separator")],1)],1)},Ye=[],Be=(s("20d6"),s("c1df")),He=s.n(Be),Ve=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-item",[s("q-avatar",{attrs:{square:""}},[s("q-icon",{attrs:{name:t.item.type,color:t.item.type}})],1),s("q-item-section",[s("q-item-label",[t._v(t._s(t.item.title))]),s("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.formatDate(t.item.created_at)))]),s("q-item-label",[t.item.data.message?s("q-btn",{attrs:{label:"детали",size:"xs",flat:""},on:{click:function(e){return t.showDetailDialog(t.item)}}}):t._e()],1)],1),s("q-item-section",{attrs:{side:""}},[s("div",{staticClass:"text-grey-8"},[s("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"done"},on:{click:function(e){return t.markAsRead(t.item.id)}}})],1)])],1),s("q-dialog",{model:{value:t.isShowDetailDialog,callback:function(e){t.isShowDetailDialog=e},expression:"isShowDetailDialog"}},[s("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[t._v(t._s(t.detailDialogItem.title))])]),t.detailDialogItem.data?s("q-card-section",{staticClass:"q-pt-none"},[s("span",{domProps:{innerHTML:t._s(t.detailDialogItem.data.message)}})]):t._e(),s("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK"}})],1)],1)],1)],1)},Je=[],Ge={props:["item"],data:function(){return{isShowDetailDialog:!1,detailDialogItem:{}}},methods:{showDetailDialog:function(t){this.detailDialogItem=t,this.isShowDetailDialog=!0},formatDate:function(t){return He()(t).format("DD/MM hh:mm")},markAsRead:function(t){var e=this;this.$utils.postCallPgMethod({method:"message_mark_as_read",params:{id:t}}).subscribe((function(s){s.ok&&e.$emit("markAsRead",t)}))}}},We=Ge,Ke=Object(Mt["a"])(We,Ve,Je,!1,null,null,null),Ze=Ke.exports,Xe={props:["currentUser","rightSide"],components:{defaultTmpl:Ze},computed:{listForRender:function(){return this.list.filter((function(t){return!t.is_read}))}},data:function(){return{list:[],isShowDetailDialog:!1,detailDialogItem:{}}},methods:{newMessage:function(t){-1===this.list.findIndex((function(e){return t.id===e.id}))&&(t.type||(t.type="info"),t.template=t.options&&t.options.template?t.options.template:"defaultTmpl",this.list.unshift(t),this.showNotifyMsg(),this.updateCounter())},reload:function(){var t=this;this.$utils.postCallPgMethod({method:"message_list",params:{is_read:!1,order_by:"created_at desc"}}).subscribe((function(e){e.ok&&(t.list=e.result.map((function(t){return t.type||(t.type="info"),t.template=t.options&&t.options.template?t.options.template:"defaultTmpl",t})),t.updateCounter(),t.list.length>0&&t.showNotifyMsg())}))},updateCounter:function(){this.$emit("updateCounter",this.list.filter((function(t){return!t.is_read})).length)},markAsRead:function(t){var e=this;this.$utils.postCallPgMethod({method:"message_mark_as_read",params:{id:t}}).subscribe((function(s){if(s.ok){var a=e.list.findIndex((function(e){return e.id===t}));e.list[a].is_read=!0,e.updateCounter()}}))},showDetailDialog:function(t){this.detailDialogItem=t,this.isShowDetailDialog=!0},formatDate:function(t){return He()(t).format("DD/MM hh:mm")},showNotifyMsg:function(){this.$q.notify({position:"top-right",message:"У Вас новые непрочитанные сообщения",avatar:"https://image.flaticon.com/icons/svg/945/945202.svg",timeout:1e3})}},mounted:function(){this.currentUser.id&&this.reload()}},ts=Xe,es=Object(Mt["a"])(ts,Ae,Ye,!1,null,null,null),ss=es.exports,as=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-drawer",{attrs:{value:t.rightSide,side:"right",bordered:""},on:{hide:function(e){return t.$emit("hide")}}},[s("q-list",{attrs:{separator:""}},[s("q-item-label",{attrs:{header:""}},[t._v("\n          Задачи\n        ")]),s("q-separator"),t._l(t.listForRender,(function(t){return s(t.template,{key:t.id,tag:"component",attrs:{item:t}})}))],2),s("q-separator")],1),s("comp-dialog-task-done",{ref:"doneTaskDialog"})],1)},is=[],ns=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-item",[s("q-item-section",{attrs:{avatar:"",top:""},on:{click:function(e){return t.$router.push("/task/"+t.item.id)}}},[t.item&&t.item.task_type_options&&t.item.task_type_options.iconUrl?[s("q-avatar",{attrs:{rounded:""}},[s("q-img",{attrs:{src:t.item.task_type_options.iconUrl}})],1)]:[t.item.isDeadlinePass?s("q-avatar",{attrs:{rounded:"",icon:"warning",color:"orange","text-color":"white"}}):s("q-avatar",{attrs:{rounded:"",icon:"error_outline",color:"info","text-color":"white"}})]],2),s("q-item-section",[s("q-item-label",[t._v(t._s(t.item.task_type_title))]),s("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.$utils.formatPgDate(t.item.deadline)))])],1),"finished"!=t.item.state?s("q-item-section",{attrs:{side:""}},[s("div",{staticClass:"text-grey-8"},[s("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"done"},on:{click:function(e){return t.$refs.doneTaskDialog.open(t.item)}}})],1)]):t._e(),s("comp-dialog-task-done",{ref:"doneTaskDialog",on:{taskFinished:function(e){return t.$emit("taskFinished",e)}}})],1)},os=[],ls={props:["item"],data:function(){return{}},methods:{}},rs=ls,cs=Object(Mt["a"])(rs,ns,os,!1,null,null,null),us=cs.exports,ds={props:["currentUser","rightSide"],components:{defaultTmpl:us},computed:{listForRender:function(){return this.list.filter((function(t){return"in_process"===t.state})).map((function(t){return t.template=t.options&&t.options.template?t.options.template:"defaultTmpl",t}))},icon:function(){return function(t){return this.$config.breadcrumbIcons[t]||"label"}}},data:function(){return{list:[]}},methods:{},mounted:function(){var t=this;this.currentUser.id&&(this.$userTasks.loadList(),this.$userTasks.getList$().subscribe((function(e){var s=t.list.findIndex((function(t){return t.id===e.id}));-1===s?t.list.push(e):t.list.splice(s,1,e),t.$emit("updateCounter",t.listForRender.length)})))}},ps=ds,ms=Object(Mt["a"])(ps,as,is,!1,null,null,null),fs=ms.exports,hs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"layout"},[s("div",[t._m(0),s("div",{staticClass:"row justify-center q-mt-lg"},[s("q-banner",{staticClass:"bg-grey-3",scopedSlots:t._u([{key:"avatar",fn:function(){return[s("q-avatar",{attrs:{rounded:""}},[s("img",{attrs:{src:"https://image.flaticon.com/icons/svg/197/197729.svg"}})])]},proxy:!0}])},[t._v("\n        Ожидаем подтверждения Вашей авторизации\n      ")])],1)])])},gs=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row justify-center",staticStyle:{"margin-top":"20px","margin-bottom":"10px"}},[s("img",{staticStyle:{width:"auto","max-height":"100px"},attrs:{src:"[[appLogoSrc]]",alt:""}})])}],bs={data:function(){return{}}},vs=bs,ws=Object(Mt["a"])(vs,hs,gs,!1,null,null,null),_s=ws.exports,xs=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"layout"},[s("div",[t._m(0),s("div",{staticClass:"row justify-center q-mt-lg"},[s("q-banner",{staticClass:"bg-grey-3",scopedSlots:t._u([{key:"avatar",fn:function(){return[s("q-avatar",{attrs:{rounded:""}},[s("img",{attrs:{src:"https://image.flaticon.com/icons/svg/440/440682.svg"}})])]},proxy:!0}])},[t._v("\n        Ваш аккаунт заблокирован. Обратитесь к администратору.\n      ")])],1)])])},ys=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row justify-center",staticStyle:{"margin-top":"20px","margin-bottom":"10px"}},[s("img",{staticStyle:{width:"auto","max-height":"100px"},attrs:{src:"[[appLogoSrc]]",alt:""}})])}],qs={data:function(){return{}}},ks=qs,Ss=Object(Mt["a"])(ks,xs,ys,!1,null,null,null),Ds=Ss.exports,js={mixins:[It["a"]],components:{waitingAuthPage:_s,currentUserToolbarMenu:Pt,sideMenu:Bt,authComp:Ne,messageList:ss,toolbarTaskBtn:Le,toolbarMessageBtn:ze,taskList:fs,firedPage:Ds},data:function(){return{leftSide:!0,isShowMsgList:!1,isShowTaskList:!1,messageCounter:0,taskCounter:0}},methods:{toggleTaskList:function(){var t=this;this.isShowTaskList?this.isShowTaskList=!1:this.isShowMsgList?(this.isShowMsgList=!1,this.$nextTick((function(){return t.isShowTaskList=!0}))):this.isShowTaskList=!0},toggleMsgList:function(){var t=this;this.isShowMsgList?this.isShowMsgList=!1:this.isShowTaskList?(this.isShowTaskList=!1,this.$nextTick((function(){return t.isShowMsgList=!0}))):this.isShowMsgList=!0},hideRightSidebar:function(){this.isShowMsgList=!1,this.isShowTaskList=!1}},mounted:function(){var t=this;this.$currentUser.login();var e=localStorage.getItem(this.$config.appName),s=new EventSource("".concat(this.$config.apiUrl(),"/api/sse?authToken=").concat(e));s.onmessage=function(e){if("string"===typeof e.data){var s=JSON.parse(e.data);"message"===s.sse_type&&(s.data&&"string"===typeof s.data&&(s.data=JSON.parse(s.data)),s.options&&"string"===typeof s.options&&(s.options=JSON.parse(s.options)),t.$refs.messageList.newMessage(s)),"task"===s.sse_type&&(s.data&&"string"===typeof s.data&&(s.data=JSON.parse(s.data)),t.$userTasks.addTask(s))}}}},$s=js,Cs=Object(Mt["a"])($s,Nt,Ft,!1,null,null,null),Ns=Cs.exports,Fs=s("8c4f"),Is=[{path:"/",component:function(){return s.e(11).then(s.bind(null,"5251"))}},{path:"/check_user_email",component:function(){return s.e(5).then(s.bind(null,"5aee"))}},{path:"/email_auth_recover_password",component:function(){return s.e(6).then(s.bind(null,"c786"))}},{path:"/users",component:function(){return s.e(3).then(s.bind(null,"e867"))}},{path:"/users/:id",component:function(){return s.e(4).then(s.bind(null,"147e"))},props:!0},{path:"/profile",component:function(){return s.e(9).then(s.bind(null,"542f"))}},{path:"/task",component:function(){return s.e(20).then(s.bind(null,"92f4"))}},{path:"/task/:id",component:function(){return s.e(21).then(s.bind(null,"d3af"))},props:!0},{path:"/taskType",component:function(){return s.e(18).then(s.bind(null,"bafe"))}},{path:"/taskType/:id",component:function(){return Promise.all([s.e(0),s.e(19)]).then(s.bind(null,"469c"))},props:!0},{path:"/client",component:function(){return s.e(7).then(s.bind(null,"51c5"))},props:!0},{path:"/client/:id",component:function(){return s.e(8).then(s.bind(null,"872b"))},props:!0},{path:"/project",component:function(){return s.e(16).then(s.bind(null,"6d1f"))},props:!0},{path:"/project/:id",component:function(){return s.e(17).then(s.bind(null,"2d54"))},props:!0},{path:"/internal_task",component:function(){return s.e(12).then(s.bind(null,"883f"))},props:!0},{path:"/internal_task/:id",component:function(){return s.e(13).then(s.bind(null,"63d0"))},props:!0},{path:"/man",component:function(){return s.e(14).then(s.bind(null,"79da"))},props:!0},{path:"/man/:id",component:function(){return s.e(15).then(s.bind(null,"f214"))},props:!0}];Is.push({path:"*",component:function(){return s.e(10).then(s.bind(null,"17c6"))}});var Os=Is;l["a"].use(Fs["a"]);var Ts=function(){var t=new Fs["a"]({scrollBehavior:function(){return{x:0,y:0}},routes:Os,mode:"history",base:"/"});return t},Us=function(){return Ls.apply(this,arguments)};function Ls(){return Ls=o()(i.a.mark((function t(){var e,s;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("function"!==typeof Ts){t.next=6;break}return t.next=3,Ts({Vue:l["a"]});case 3:t.t0=t.sent,t.next=7;break;case 6:t.t0=Ts;case 7:return e=t.t0,s={router:e,render:function(t){return t(Ns)}},s.el="#q-app",t.abrupt("return",{app:s,router:e});case 11:case"end":return t.stop()}}),t)}))),Ls.apply(this,arguments)}var Ms,Es,Ps={appName:"Electron",uiAppName:"Electron",apiUrl:function(){return"https://system.i-electron.ru"},wsUrl:function(){return"wss://system.i-electron.ru"},isEmailAuth:{firstName:!0,lastName:!0},logoSrc:"statics/image/electron_logo.png",dadataToken:"1cf3a086e3dbe1306ed142d2b5fbc1b324b8eb60",breadcrumbIcons:{client:"fas fa-male",project:"fas fa-project-diagram",internal_task:"fas fa-clipboard-check",man:"fas fa-male"},tablesForTask:{}},Rs=function(){var t=o()(i.a.mark((function t(e){var s;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=e.Vue,s.use({install:function(t,e){t.prototype.$config=Ps}},{});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Qs=(s("6b54"),s("ac6a"),s("cadf"),s("06db"),s("456d"),s("386d"),s("448a")),zs=s.n(Qs),As=(s("7f7f"),s("17f5")),Ys=s("b7d7"),Bs=s("ebb6"),Hs=s("f59d"),Vs=s("5929"),Js=s("2ef0"),Gs=s.n(Js),Ws=s("612d"),Ks=s.n(Ws),Zs=function(t){var e=t.url,s=t.params,a=t.isShowError,i=void 0===a||a;return Object(Vs["a"])({url:"".concat(Ps.apiUrl()).concat(e),method:"POST",headers:ua(),body:{params:s}}).pipe(Object(Ys["a"])(1),Object(Bs["a"])(da()),Object(Hs["a"])(pa(i)))},Xs=function(t){var e=t.method,s=t.params,a=t.isShowError,i=void 0===a||a,n=t.successMsg,o=void 0===n?null:n;return Object(Vs["a"])({url:"".concat(Ps.apiUrl(),"/api/call_pg_func"),method:"POST",headers:ua(),body:{method:e,params:s}}).pipe(Object(Ys["a"])(1),Object(Bs["a"])(da({successMsg:o})),Object(Hs["a"])(pa(i)))},ta=function(t){var e=t.method,s=t.params,a=t.cb,i=t.successMsg;return Xs({method:e,params:s,successMsg:i}).subscribe((function(t){return a?a(t.ok?t.result:null):null}))},ea=function(t){var e=this,s=t.method,a=t.cb;if("new"===this.id)this.item={id:-1},Gs.a.flattenDeep(this.flds).map((function(t){e.$set(e.item,t.name,t.default||null)}));else{a=a||function(t){e.item=t};var i=function(t){return Ks.a.compose(a,ia(e))(t)};ta({method:s,params:{id:this.id},cb:i})}},sa=function(t){var e=this,s=t.method,a=t.itemForSaveMod,i=void 0===a?{}:a,n=t.resultModify,o=t.cb,l=Object.assign({},this.item),r=Gs.a.flattenDeep(this.flds).map((function(t){var e=t.name;return e}));l.options||(l.options={}),l=Object.assign(l,i),this.optionsFlds&&this.optionsFlds.map((function(t){return l.options[t]=l[t]}));var c=Object.assign({},Gs.a.pick(l,["id"].concat(zs()(r),["options"]))),u=Gs.a.flattenDeep(this.flds).filter((function(t){return t.required&&!c[t.name]}));u.length>0?u.map((function(t){e.$q.notify({color:"negative",position:"bottom",message:"не заполнено поле '".concat(t.label,"'")})})):Xs({method:s,params:c,successMsg:"изменения сохранены"}).subscribe((function(t){t.ok&&(-1===e.item.id&&e.$router.push("".concat(e.docUrl,"/").concat(t.result.id)),n=n||function(t){return t},e.item=Ks.a.compose(n,ia(e))(t.result),e.$emit("updated",e.item),o&&o())}))},aa=function(t,e,s){Xs({method:t,params:e}).subscribe((function(t){t.ok&&s&&s(t.result)}))},ia=function(t){return function(e){return t.optionsFlds&&t.optionsFlds.map((function(t){return e[t]=e.options[t]})),e}},na=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=new URLSearchParams(window.location.search);Object.keys(t).forEach((function(a){e&&null!==t[a]?s.set(a,t[a]):s.delete(a)}));var a=window.location.protocol+"//"+window.location.host+window.location.pathname;s.toString().length>0&&(a=a+"?"+s.toString()),window.history.pushState({path:a},"",a)},oa=function(t){return t?He()(t,"YYYY-MM-DDTHH:mm:ss").format("DD-MM-YYYY HH:mm"):null},la=function(t){return t?He()(t,"YYYY-MM-DDTHH:mm:ss").format("DD-MM-YYYY"):null},ra=function(t){var e={in_work:"в работе",completed:"завершена"};return Array.isArray(t)?t.map((function(t){return e[t]})):e[t]},ca={postApiRequest:Zs,postCallPgMethod:Xs,callPgMethod:aa,pgCall:ta,getDocItemById:ea,saveItem:sa,updateUrlQuery:na,formatPgDateTime:oa,formatPgDate:la,_:Gs.a,i18n_internal_task_status:ra},ua=function(){var t={"Content-Type":"application/json"},e=localStorage.getItem(Ps.appName);return e&&(t["Auth-token"]=e),t},da=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.successMsg;return function(t){if(t.response&&!t.response.ok)throw new Error(t.response.message);return t.response&&t.response.ok&&e&&$t["a"].create({color:"positive",position:"bottom-right",message:e}),t.response}},pa=function(t){return function(e){var s=e.response?e.response.message:e.message;return t&&$t["a"].create({color:"negative",position:"top-right",message:s}),Object(As["a"])({ok:!1,message:s})}},ma=function(){var t=o()(i.a.mark((function t(e){var s;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=e.Vue,e.app,s.use({install:function(t,e){t.prototype.$utils=ca}},{});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),fa=s("970b"),ha=s.n(fa),ga=s("9523"),ba=s.n(ga),va=s("dba1"),wa=s("f508"),_a=new va["a"](null),xa=new va["a"](!1),ya=(Ms=function t(){var e=this;ha()(this,t),ba()(this,"getUser$",(function(){return _a})),ba()(this,"login",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=t.user,a=t.auth_token;s?(_a.next(s),localStorage.setItem(Ps.appName,s.auth_token)):(a||(a=localStorage.getItem(Ps.appName)),localStorage.setItem(Ps.appName,a),qa(!0),ca.postApiRequest({url:"/api/current_user",params:{auth_token:a},isShowError:!1}).subscribe((function(t){t.ok?(_a.next(t.result),localStorage.setItem(Ps.appName,t.result.auth_token),qa(!1)):(e.logout(),qa(!1))})))})),ba()(this,"logout",(function(){_a.next(null),localStorage.removeItem(Ps.appName)})),ba()(this,"getIsInLogingProcess",(function(){return xa}))},Ms),qa=function(t){t?(wa["a"].show({message:"авторизация"}),xa.next(!0)):(wa["a"].hide(),xa.next(!1))},ka=ya,Sa=function(t){var e=t.Vue;e.use({install:function(t,e){t.prototype.$currentUser=new ka}},{})},Da=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row"},[s("div",{class:t.colClassComputed},[s("q-infinite-scroll",{ref:"infiniteScroll",attrs:{offset:250},on:{load:t.itemListLoad},scopedSlots:t._u([{key:"loading",fn:function(){return[s("div",{staticClass:"row justify-center q-my-md"},[s("q-spinner-dots",{attrs:{color:"primary",size:"40px"}})],1)]},proxy:!0}])},[s("q-list",{staticClass:"rounded-borders",attrs:{bordered:"",separator:""}},[s("q-item",[s("q-item-section",[s("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.computedListTitle))])],1),s("q-item-section",{attrs:{top:"",side:""}},[s("div",{staticClass:"text-grey-8 q-gutter-xs"},[t.readonly||!t.newDocUrl&&!t.newDocEventOnly?t._e():[t.newDocEventOnly?s("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"add"},on:{click:function(e){return t.$emit("clickAddBtn")}}}):s("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"add"},on:{click:t.openNewDoc}})],t._t("addBtnsSlot"),t.searchFldName?s("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"search"},on:{click:t.toggleSearchFld}}):t._e(),t.listSortData?s("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"expand_less"}},[s("q-menu",{attrs:{"auto-close":""}},[s("q-list",{staticStyle:{"min-width":"100px"},attrs:{dense:""}},t._l(t.listSortData,(function(e){return s("q-item",{key:e.value,attrs:{clickable:""}},[s("q-item-section",{on:{click:function(s){return t.changeItemList({order_by:""+e.value})}}},[t._v(t._s(e.title)+"\n                      ")])],1)})),1)],1)],1):t._e(),t.listSortData?s("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"expand_more"}},[s("q-menu",{attrs:{"auto-close":""}},[s("q-list",{staticStyle:{"min-width":"100px"},attrs:{dense:""}},t._l(t.listSortData,(function(e){return s("q-item",{key:e.value,attrs:{clickable:""}},[s("q-item-section",{on:{click:function(s){return t.changeItemList({order_by:e.value+" desc"})}}},[t._v(t._s(e.title)+"\n                      ")])],1)})),1)],1)],1):t._e(),t.listFilterData?s("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"filter_list"}},[s("q-menu",{attrs:{"auto-close":""}},[s("q-list",{staticStyle:{"min-width":"100px"},attrs:{dense:""}},t._l(t.listFilterData,(function(e){return s("q-item",{key:e.title,attrs:{clickable:""}},[s("q-item-section",{on:{click:function(s){return t.changeItemList(e.value)}}},[t._v(t._s(e.title)+"\n                      ")])],1)})),1)],1)],1):t._e()],2)])],1),t.isShowSearchfld&&t.searchFldName?s("q-item",[s("q-item-section",{attrs:{top:""}},[s("div",{staticClass:"text-grey-8 q-gutter-xs"},[s("q-input",{ref:"searchInput",staticClass:"q-ml-md",attrs:{dense:"",filled:""},scopedSlots:t._u([{key:"append",fn:function(){return[""===t.searchTxt?s("q-icon",{attrs:{name:"search"}}):s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"clear"},on:{click:function(e){t.searchTxt=""}}})]},proxy:!0}],null,!1,4076338364),model:{value:t.searchTxt,callback:function(e){t.searchTxt=e},expression:"searchTxt"}})],1)])],1):t._e(),t._t("addFilterSlot"),t._l(t.itemList,(function(e){return s("q-item",{key:e.id},[t._t("listItem",null,{item:e})],2)}))],2)],1)],1),t.readonly||!t.newDocUrl&&!t.newDocEventOnly?t._e():s("q-page-sticky",{attrs:{position:"bottom-right",offset:[18,18]}},[t.newDocEventOnly?s("q-btn",{attrs:{fab:"",icon:"add",color:"accent"},on:{click:function(e){return t.$emit("clickAddBtn")}}}):s("q-btn",{attrs:{fab:"",icon:"add",color:"accent"},on:{click:t.openNewDoc}})],1)],1)},ja=[],$a=s("1c16"),Ca={props:["listTitle","listDeletedTitle","pgMethod","listSortData","listFilterData","searchFldName","newDocEventOnly","newDocUrl","isOpenNewInTab","urlQueryParams","ext","readonly","colClass","startFilter"],computed:{computedListTitle:function(){return this.listParams.deleted?this.listDeletedTitle:this.listTitle},colClassComputed:function(){return this.colClass||"col-xs-12 col-sm-12 col-md-6 q-gutter-md q-pt-md"}},data:function(){return{searchTxt:"",isShowSearchfld:!1,itemList:[],listParams:{page:0,per_page:10,deleted:!1},isUrlQueryProcessed:!1}},methods:{toggleSearchFld:function(){var t=this;this.isShowSearchfld=!this.isShowSearchfld,this.isShowSearchfld||(this.listParams[this.searchFldName]=""),this.isShowSearchfld&&this.$nextTick((function(){t.$refs.searchInput.focus()}))},itemListLoad:function(t,e){var s=this;if(!this.isUrlQueryProcessed&&(this.isUrlQueryProcessed=!0,this.urlQueryParams)){var a=new URLSearchParams(window.location.search);this.urlQueryParams.map((function(t){"string"===typeof t&&a.has(t)&&s.$set(s.listParams,t,a.get(t))}))}this.loadList({list:this.itemList,params:this.listParams,done:e})},loadList:function(t){var e=this,s=t.list,a=void 0===s?[]:s,i=t.params,n=void 0===i?{}:i,o=t.done;this.listParams.page++,this.$utils.updateUrlQuery(Gs.a.omit(n,["per_page","page"])),this.$utils.postCallPgMethod({method:this.pgMethod,params:Object.assign(n,this.ext?this.ext:{})}).subscribe((function(t){t.ok&&t.result&&t.result.length>0?(t.result.map((function(t){return a.push(t)})),e.$emit("updateCount",a.length),o&&o()):o&&o(!0)}))},reloadList:function(){this.itemList=[],this.listParams.page=0,this.$refs.infiniteScroll.resume(),this.loadList({list:this.itemList,params:this.listParams}),this.$forceUpdate()},reloadListDebounce:function(){this.reloadList()},changeItemList:function(t){this.listParams=Object.assign(this.listParams,t),this.reloadList()},openNewDoc:function(){this.isOpenNewInTab?window.open("/"+this.newDocUrl,"_blank"):this.$router.push(this.newDocUrl)}},watch:{searchTxt:function(t){this.searchFldName&&(0===t.length||t.length>3)&&(this.listParams[this.searchFldName]=t,this.reloadListDebounce())}},mounted:function(){this.startFilter&&(this.listParams=Object.assign(this.listParams,this.startFilter)),this.loadList({list:this.itemList,params:this.listParams}),this.reloadListDebounce=Object($a["a"])(this.reloadListDebounce,300)}},Na=Ca,Fa=Object(Mt["a"])(Na,Da,ja,!1,null,null,null),Ia=Fa.exports,Oa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-grey-8 q-gutter-xs"},[s("q-btn",{attrs:{size:"12px",flat:"",dense:"",round:"",icon:"more_vert"}},[s("q-menu",[s("q-list",{staticStyle:{"min-width":"100px"},attrs:{dense:""}},[t.isEdit?s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){return t.$emit("edit")}}},[s("q-item-section",[t._v("редактировать")])],1):t._e(),t.isDelete?s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(e){return t.confirmItemDeleteRecover(t.item)}}},[t.item.deleted?s("q-item-section",[t._v("восстановить")]):s("q-item-section",[t._v("удалить")])],1):t._e()],1)],1)],1)],1)},Ta=[],Ua={props:["item","itemProp","isDelete","isEdit","pgMethod"],methods:{confirmItemDeleteRecover:function(t){var e=this,s=t[this.itemProp]?t[this.itemProp]:"";this.$q.dialog({title:"Подтвердите",message:"".concat(t.deleted?"восстановить":"удалить"," : <strong>").concat(s,"</strong>"),ok:"ok",cancel:"отмена",html:!0}).onOk((function(){e.$utils.postCallPgMethod({method:e.pgMethod,params:{id:t.id,deleted:!t.deleted}}).subscribe((function(t){e.$emit("reload-list")}))}))}}},La=Ua,Ma=Object(Mt["a"])(La,Oa,Ta,!1,null,null,null),Ea=Ma.exports,Pa=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{class:t.columnClass},["separator"==t.type&&t.vif?s("div",{staticClass:"text-weight-bold form-separator-header"},[t._v(t._s(t.label))]):t._e(),"string"==t.type&&t.vif?s("q-input",{attrs:{outlined:"",type:t.type,label:t.label,value:t.fld,readonly:t.readonly,autogrow:""},on:{input:function(e){return t.$emit("update",e)}}}):t._e(),"number"==t.type&&t.vif?s("q-input",{attrs:{outlined:"",type:t.type,label:t.label,value:t.fld,readonly:t.readonly},on:{input:function(e){return t.$emit("update",e)}}}):t._e(),"phone"==t.type&&t.vif?s("q-input",{attrs:{outlined:"",label:t.label,value:t.fld,mask:"+# (###) ### - ####",readonly:t.readonly},on:{input:function(e){return t.$emit("update",e)}},scopedSlots:t._u([{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:"phone"}})]},proxy:!0}],null,!1,2596585552)}):t._e(),"select"==t.type&&t.vif?s("q-select",{attrs:{outlined:"",label:t.label,value:t.fld,options:t.selectOptions,readonly:t.readonly},on:{input:function(e){return t.$emit("update",e)}},scopedSlots:t._u([t.icon?{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:t.icon}})]},proxy:!0}:null],null,!0)}):t._e(),"selectMultiple"==t.type&&t.vif?s("q-select",{attrs:{outlined:"",label:t.label,value:t.fld,multiple:"",options:t.selectOptions,readonly:t.readonly},on:{input:function(e){return t.$emit("update",e)}}}):t._e(),"userId"==t.type&&t.vif?s("comp-fld-user-search",{attrs:{label:t.label,user:t.ajaxSelectTitle,ext:t.ext,readonly:t.readonly},on:{update:function(e){return t.$emit("update",e.id)}}}):t._e(),"refSearch"==t.type&&t.vif?s("comp-fld-ref-search",{attrs:{label:t.label,pgMethod:t.pgMethod,itemTitleFldName:t.itemTitleFldName,readonly:t.readonly,ext:t.ext},on:{update:function(e){return t.$emit("update",e.id)}}}):t._e(),"date"==t.type&&t.vif?s("comp-fld-date",{attrs:{label:t.label,"date-string":t.formatDateForSelector(t.fld),readonly:t.readonly},on:{update:function(e){return t.$emit("update",e)}}}):t._e(),"datetime"==t.type&&t.vif?s("comp-fld-date-time",{attrs:{label:t.label,"date-string":t.formatDateTimeForSelector(t.fld),readonly:t.readonly},on:{update:function(e){return t.$emit("update",e)}}}):t._e(),"checkbox"==t.type&&t.vif?s("div",{staticClass:"q-gutter-sm"},[s("q-checkbox",{attrs:{label:t.label},on:{input:function(e){return t.$emit("update",e)}},model:{value:t.localFld,callback:function(e){t.localFld=e},expression:"localFld"}})],1):t._e(),t.compName&&t.vif?s("div",[s(t.compName,{tag:"component",attrs:{label:t.label,fld:t.fld,type:t.type,item:t.item,ajaxSelectTitle:t.ajaxSelectTitle,selectOptions:t.selectOptions,columnClass:t.columnClass,ext:t.ext,readonly:t.readonly},on:{update:function(e){return t.$emit("update",e)}}})],1):t._e()],1)},Ra=[],Qa={props:{item:{},type:{},label:{},fld:{},selectOptions:null,ajaxSelectTitle:null,ext:null,readonly:null,columnClass:{default:"col-xs-12 col-sm-6 col-md-4"},icon:null,vif:{default:!0},compName:null,pgMethod:null,itemTitleFldName:null,href:null},data:function(){return{localFld:null}},methods:{formatDateForSelector:function(t){return t?He()(t,"YYYY-MM-DDTHH:mm:ss").format("DD-MM-YYYY"):null},formatDateTimeForSelector:function(t){return t?He()(t,"YYYY-MM-DDTHH:mm:ss").format("DD-MM-YYYY HH:mm"):null}},mounted:function(){this.localFld=this.fld}},za=Qa,Aa=(s("0725"),Object(Mt["a"])(za,Pa,Ra,!1,null,null,null)),Ya=Aa.exports,Ba=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"300",label:t.label,options:t.options,readonly:t.readonly},on:{filter:t.filterFn},scopedSlots:t._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[t._v("\n        No results\n      ")])],1)]},proxy:!0}]),model:{value:t.localUser,callback:function(e){t.localUser=e},expression:"localUser"}})},Ha=[],Va={props:{user:{type:String},label:{type:String},ext:{type:Object},readonly:{type:Boolean,default:!1}},data:function(){return{localUser:{},options:[]}},created:function(){var t=this.user?this.user:null;this.localUser={label:t,value:t}},watch:{localUser:function(t){t&&t.user&&this.$emit("update",{id:t.user.id,fullname:t.user.fullname})}},methods:{filterFn:function(t,e,s){var a=this;e((function(){a.$utils.postCallPgMethod({method:"user_list",params:Object.assign({search_fullname:t,per_page:20},a.ext?a.ext:{})}).subscribe((function(t){t.ok&&(t.result||(t.result=[]),a.options=t.result.map((function(t){return{label:t.fullname,value:t.fullname,user:t,avatar:t.avatar}})))}))}))}}},Ja=Va,Ga=Object(Mt["a"])(Ja,Ba,Ha,!1,null,null,null),Wa=Ga.exports,Ka=function(){var t,e=this,s=e.$createElement,a=e._self._c||s;return a("div",[a("q-breadcrumbs",{attrs:{gutter:"sm"}},[a("q-breadcrumbs-el",{attrs:{label:e.$config.uiAppName,to:"/"}}),e._l((t=[]).concat.apply(t,e.list),(function(t){return a("q-breadcrumbs-el",{key:t.label,attrs:{label:t.label,to:t.to,icon:e.icon(t)}})}))],2),a("q-separator",{staticClass:"q-mt-sm"})],1)},Za=[],Xa={props:["list"],computed:{icon:function(){return function(t){return"edit"===t.docType?"edit":t.icon||this.$config.breadcrumbIcons[t.docType]||"label"}}}},ti=Xa,ei=Object(Mt["a"])(ti,Ka,Za,!1,null,null,null),si=ei.exports,ai=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-item-section",{attrs:{side:""}},[t.item.deleted?t._e():s("q-btn",{attrs:{flat:"",round:"",icon:"delete_forever"},on:{click:function(e){t.isShowDeleteDialog=!0}}},[s("q-tooltip",[t._v("Удалить")])],1),t.item.deleted?s("q-btn",{attrs:{flat:"",round:"",icon:"check_circle_outline"},on:{click:t.update}},[s("q-tooltip",[t._v("Восстановить")])],1):t._e()],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.isShowDeleteDialog,callback:function(e){t.isShowDeleteDialog=e},expression:"isShowDeleteDialog"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[s("q-avatar",{attrs:{rounded:"",icon:"warning",color:"warning","text-color":"white"}}),s("span",{staticClass:"q-ml-sm"},[t._v("Удалить?")])],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Удалить"},on:{click:t.update}})],1)],1)],1)],1)},ii=[],ni={props:["item","updateMethod"],data:function(){return{list:[],isShowDeleteDialog:!1}},methods:{update:function(){var t=this;this.updateMethod?this.$utils.postCallPgMethod({method:this.updateMethod,params:{id:this.item.id,deleted:!this.item.deleted}}).subscribe((function(e){e.ok&&t.$emit("success")})):this.$emit("success")}}},oi=ni,li=Object(Mt["a"])(oi,ai,ii,!1,null,null,null),ri=li.exports,ci=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-input",{attrs:{dense:t.dense,outlined:"",label:t.label,readonly:t.readonly,mask:"##-##-####"},scopedSlots:t._u([t.is_remove?{key:"append",fn:function(){return[s("q-btn",{attrs:{round:"",flat:"",size:"sm",icon:"clear"},on:{click:t.clear}})]},proxy:!0}:null,t.readonly?null:{key:"prepend",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[s("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[s("q-date",{attrs:{mask:"DD-MM-YYYY",readonly:t.readonly},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1)]},proxy:!0}],null,!0),model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})},ui=[],di=s("bd4c"),pi={props:["dateString","label","dense","is_remove","readonly"],data:function(){return{date:null}},watch:{dateString:function(t,e){t&&(this.date=t)},date:function(t,e){if(t&&t!==e){var s=di["b"].extractDate(t,"DD-MM-YYYY");if(di["b"].isBetweenDates(s,new Date(1900,1,1),new Date(2050,1,1))){var a=di["b"].formatDate(s,"YYYY-MM-DDTHH:mm:ss");this.$emit("update",a)}}}},methods:{clear:function(){this.$emit("clear"),this.date=null}},mounted:function(){this.dateString&&(this.date=this.dateString)}},mi=pi,fi=Object(Mt["a"])(mi,ci,ui,!1,null,null,null),hi=fi.exports,gi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-input",{attrs:{outlined:"",label:t.label,readonly:t.readonly,mask:"##-##-#### ##:##"},scopedSlots:t._u([t.readonly?null:{key:"prepend",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[s("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[s("q-date",{attrs:{mask:"DD-MM-YYYY HH:mm"},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1)]},proxy:!0},t.readonly?null:{key:"append",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"access_time"}},[s("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[s("q-time",{attrs:{mask:"DD-MM-YYYY HH:mm",format24h:""},on:{input:function(){return t.$refs.qDateProxy.hide()}},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1)]},proxy:!0}],null,!0),model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})},bi=[],vi={props:["dateString","label","readonly"],data:function(){return{date:null}},watch:{date:function(t,e){if(t!==e){var s=di["b"].extractDate(t,"DD-MM-YYYY HH:mm");if(di["b"].isBetweenDates(s,new Date(1900,1,1),new Date(2050,1,1))){var a=di["b"].formatDate(s,"YYYY-MM-DDTHH:mm:ss");this.$emit("update",a)}}}},mounted:function(){this.dateString&&(this.date=this.dateString)}},wi=vi,_i=Object(Mt["a"])(wi,gi,bi,!1,null,null,null),xi=_i.exports,yi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"q-py-md"},[t.readonly?t._e():s("q-btn",{staticClass:"q-mr-sm",attrs:{color:"secondary",label:"сохранить"},on:{click:function(e){return t.$emit("save")}}}),s("q-btn",{attrs:{outline:"",color:"secondary",label:"отмена"},on:{click:function(e){return t.$emit("cancel")}}})],1)},qi=[],ki={props:["readonly"]},Si=ki,Di=Object(Mt["a"])(Si,yi,qi,!1,null,null,null),ji=Di.exports,$i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-select",{attrs:{outlined:"","use-input":"","fill-input":"","emit-value":"","map-options":"",multiple:"","use-chips":"",label:t.label,options:t.options},scopedSlots:t._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[t._v("\n        No results\n      ")])],1)]},proxy:!0}]),model:{value:t.localUser,callback:function(e){t.localUser=e},expression:"localUser"}})},Ci=[],Ni={props:{userIds:{type:Array},label:{type:String}},data:function(){return{localUser:[],options:[],filterOptions:[]}},watch:{localUser:function(t){t&&this.$emit("update",t)}},methods:{filterFn:function(t,e){var s=this;e((function(){if(""===t)s.filterOptions=s.options;else{var e=t.toLowerCase();s.filterOptions=s.options.filter((function(t){return t.label.toLowerCase().indexOf(e)>-1}))}}))}},mounted:function(){var t=this;this.$utils.postCallPgMethod({method:"user_list",params:Object.assign({per_page:1e3,order_by:"fullname asc"})}).subscribe((function(e){e.ok&&(e.result||(e.result=[]),t.options=e.result.map((function(t){return{label:"".concat(t.fullname),value:t.id}})),t.userIds&&(t.localUser=t.userIds),t.$forceUpdate())}))}},Fi=Ni,Ii=Object(Mt["a"])(Fi,$i,Ci,!1,null,null,null),Oi=Ii.exports,Ti=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"300",label:t.label,options:t.options,readonly:t.readonly,dense:t.dense},on:{filter:t.filterFn},scopedSlots:t._u([t.ext&&t.ext.pathUrl?{key:"before",fn:function(){return[t.localItem&&t.localItem.id||t.itemId?s("router-link",{staticStyle:{cursor:"pointer"},attrs:{to:t.ext.pathUrl+"/"+(t.localItem&&t.localItem.id||t.itemId)}},[s("q-avatar",{attrs:{rounded:""}},[s("img",{attrs:{src:t.ext.avatar}})])],1):s("q-avatar",{staticStyle:{opacity:"0.7"},attrs:{rounded:""}},[s("img",{attrs:{src:t.ext.avatar}})])]},proxy:!0}:null,{key:"append",fn:function(){return[t.ext&&t.ext.addNewUrl&&!t.readonly?s("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"add"},on:{click:t.openNewTab}}):t._e(),t.ext&&t.ext.isClearable&&t.localItem.label&&!t.readonly?s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"cancel"},on:{click:function(e){return e.stopPropagation(),t.clear(e)}}}):t._e()]},proxy:!0},t.ext&&t.ext.isSaveBtn&&t.localItem.label&&!t.readonly?{key:"after",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"save",color:"primary"},on:{click:function(e){return t.$emit("save")}}})]},proxy:!0}:null,{key:"option",fn:function(e){return[s("q-item",t._g(t._b({},"q-item",e.itemProps,!1),e.itemEvents),[e.opt.icon?s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{name:e.opt.icon}})],1):t._e(),s("q-item-section",[s("q-item-label",{domProps:{innerHTML:t._s(e.opt.label)}}),t.ext&&t.ext.descriptionFunc?s("q-item-label",{attrs:{caption:""}},[t._v(t._s(t.ext.descriptionFunc(e.opt.item)))]):t._e()],1)],1)]}},{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[t._v("\n        Ничего не найдено\n      ")])],1)]},proxy:!0}],null,!0),model:{value:t.localItem,callback:function(e){t.localItem=e},expression:"localItem"}})},Ui=[],Li=(s("c5f6"),{props:{itemId:{type:Number},item:{type:String},label:{type:String},ext:{type:Object},readonly:{type:Boolean,default:!1},dense:{type:Boolean,default:!1},itemTitleFldName:{type:String,default:"title"},pgMethod:{type:String}},data:function(){return{localItem:{},options:[]}},created:function(){var t,e=this.item?this.item:null;this.localItem={label:e,value:(null===(t=this.ext)||void 0===t?void 0:t.value)||e}},watch:{localItem:function(t){t&&t.id&&this.$emit("update",{id:t.id,item:t})}},methods:{clear:function(){this.localItem={label:null,value:null},this.$emit("clear")},filterFn:function(t,e,s){var a=this;e((function(){a.$utils.postCallPgMethod({method:a.pgMethod,params:Object.assign({search_text:t,per_page:20},a.ext?a.ext:{})}).subscribe((function(t){t.ok&&(t.result||(t.result=[]),a.options=t.result.map((function(t){var e,s,i=t[a.itemTitleFldName];return null!==(e=a.ext)&&void 0!==e&&e.itemTitleFunc&&(i=a.ext.itemTitleFunc(t)),{label:i,value:"".concat(t[null!==(s=a.ext)&&void 0!==s&&s.itemValueFldName?a.ext.itemValueFldName:a.itemTitleFldName]),id:t.id,item:t}})))}))}))},openNewTab:function(){window.open(this.ext.addNewUrl,"_blank")}},mounted:function(){var t=this;this.$utils.postCallPgMethod({method:this.pgMethod,params:Object.assign({search_text:"",per_page:20},this.ext?this.ext:{})}).subscribe((function(e){e.ok&&(e.result||(e.result=[]),t.options=e.result.map((function(e){var s,a=e[t.itemTitleFldName];return null!==(s=t.ext)&&void 0!==s&&s.itemTitleFunc&&(a=t.ext.itemTitleFunc(e)),{label:a,value:e[t.itemTitleFldName],id:e.id,item:e}})))}))}}),Mi=Li,Ei=Object(Mt["a"])(Mi,Ti,Ui,!1,null,null,null),Pi=Ei.exports,Ri=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"300",label:t.label,options:t.options,readonly:t.readonly},on:{filter:t.filterFn},scopedSlots:t._u([t.ext&&t.ext.isHideAddBtn?null:{key:"append",fn:function(){return[s("q-btn",{attrs:{round:"",dense:"",flat:"",icon:"add"},on:{click:function(e){t.isShowDialog=!0}}})]},proxy:!0},{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[t._v("\n          Ничего не найдено\n        ")])],1)]},proxy:!0}],null,!0),model:{value:t.localItem,callback:function(e){t.localItem=e},expression:"localItem"}}),s("q-dialog",{attrs:{persistent:""},model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-card",{staticStyle:{"min-width":"350px"}},[s("q-card-section",[s("q-input",{attrs:{outlined:"",label:"Название города"},model:{value:t.newCityName,callback:function(e){t.newCityName=e},expression:"newCityName"}})],1),s("q-card-section"),s("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Добавить"},on:{click:t.add}})],1)],1)],1)],1)},Qi=[],zi={props:{item:{type:String},ajaxSelectTitle:{type:String},label:{type:String},ext:{type:Object},readonly:{type:Boolean,default:!1}},data:function(){return{localItem:{},options:[],isShowDialog:!1,newCityName:null}},created:function(){var t=this.ajaxSelectTitle?this.ajaxSelectTitle:null;this.localItem={label:t,value:t}},watch:{localItem:function(t){t&&t.id&&this.$emit("update",t.id)}},methods:{filterFn:function(t,e,s){var a=this;e((function(){a.$utils.postCallPgMethod({method:"city_list",params:Object.assign({search_text:t,per_page:20},a.ext?a.ext:{})}).subscribe((function(t){t.ok&&(t.result||(t.result=[]),a.options=t.result.map((function(t){return{label:t.title,value:t.title,id:t.id}})))}))}))},add:function(){var t=this;this.$utils.postCallPgMethod({method:"city_update",params:{id:-1,title:this.newCityName},isShowError:!1}).subscribe((function(e){if(e.ok){var s=e.result;t.localItem={label:s.title,value:s.id},t.newCityName=null}else e.message.includes("city_already_exist")&&(e.message="Город с таким назваанием уже существует"),t.$q.notify({color:"negative",position:"bottom",message:e.message})}))}}},Ai=zi,Yi=Object(Mt["a"])(Ai,Ri,Qi,!1,null,null,null),Bi=Yi.exports,Hi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-input",{attrs:{outlined:"",label:t.label,autogrow:""},model:{value:t.localItem,callback:function(e){t.localItem=e},expression:"localItem"}})},Vi=[],Ji={props:{label:{},fld:{},ext:null,readonly:null,columnClass:{default:"col-xs-12 col-sm-6 col-md-4"},icon:null,vif:{default:!0}},data:function(){return{localItem:null}},watch:{localItem:function(){this.update()}},methods:{update:function(){this.$emit("update",{text:this.localItem})}},mounted:function(){this.fld&&(this.localItem=this.fld.text)}},Gi=Ji,Wi=Object(Mt["a"])(Gi,Hi,Vi,!1,null,null,null),Ki=Wi.exports,Zi=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-bar",{staticClass:"bg-secondary text-white shadow-2"},[s("div",[t._v(t._s(t.label))]),s("q-space"),t.isShowList&&t.list.length>0?s("q-btn",{attrs:{dense:"",flat:"",icon:"expand_less"},on:{click:function(e){t.isShowList=!1}}}):t._e(),!t.isShowList&&t.list.length>0?s("q-btn",{attrs:{dense:"",flat:"",icon:"expand_more"},on:{click:function(e){t.isShowList=!0}}}):t._e(),t.readonly?t._e():s("q-btn",{attrs:{dense:"",flat:"",icon:"add"},on:{click:function(e){t.isShowDialog=!0}}})],1),t.isShowList?s("q-list",{attrs:{bordered:"",separator:""}},t._l(t.filteredList,(function(e){return s("q-item",{key:e.filename},[s("q-item-section",{attrs:{avatar:""},on:{click:function(s){return t.downloadFile(e)}}},[s("q-avatar",{attrs:{rounded:""}},[s("img",{attrs:{src:"https://image.flaticon.com/icons/svg/1037/1037308.svg"}})])],1),s("q-item-section",[s("q-item-label",[t._v(t._s(e.filename))])],1),t.readonly?t._e():s("q-item-section",{attrs:{side:""}},[s("q-btn",{attrs:{flat:"",round:"",icon:"delete",size:"sm"},on:{click:function(s){return t.showDeleteDialog(e.filename)}}},[s("q-tooltip",[t._v("Удалить")])],1)],1)],1)})),1):t._e(),s("q-dialog",{model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-uploader",{ref:"uploader",attrs:{label:"Выберите файл для загрузки","auto-upload":"",url:t.uploadUrl,headers:t.headers,accept:t.ext&&t.ext.accept?t.ext.accept:"","max-file-size":t.ext&&t.ext.maxFileSize?t.ext.maxFileSize:1e7,"form-fields":[{name:"tableName",value:t.ext.tableName},{name:"tableId",value:t.ext.tableId}]},on:{rejected:t.rejected,uploaded:t.uploaded,failed:t.failed}})],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.isShowDeleteDialog,callback:function(e){t.isShowDeleteDialog=e},expression:"isShowDeleteDialog"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[s("q-avatar",{attrs:{rounded:"",icon:"warning",color:"warning","text-color":"white"}}),s("span",{staticClass:"q-ml-sm"},[t._v("Удалить?")])],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Удалить"},on:{click:t.remove}})],1)],1)],1)],1)},Xi=[],tn=(s("551c"),s("28a5"),s("7514"),s("bc3a")),en=s.n(tn),sn={props:{fld:{},fldName:{default:"files"},label:{},readonly:null,icon:null,vif:{default:!0},ext:null},computed:{uploadUrl:function(){return"".concat(this.$config.apiUrl(),"/api/upload_file")},headers:function(){var t=localStorage.getItem(this.$config.appName);return[{name:"Auth-token",value:t}]},filteredList:function(){return this.list.filter((function(t){return!t.deleted}))}},data:function(){return{isShowDialog:!1,isShowList:!0,list:[],isShowDeleteDialog:!1,selectedForDeleteFilename:null}},methods:{uploaded:function(t){var e=this,s=t.xhr.response,a=JSON.parse(s);a.ok?(this.$refs.uploader.reset(),this.isShowDialog=!1,this.list.find((function(t){return t.filename===a.result.filename&&!t.deleted}))||(this.list.push(a.result),this.$utils.postCallPgMethod({method:"".concat(this.ext.tableName,"_update"),params:ba()({id:this.ext.tableId},this.fldName,this.list)}).subscribe((function(t){e.$emit("update",e.list)})))):this.$q.notify({color:"negative",position:"bottom",message:a.message})},failed:function(t){var e="ошибка загрузки";if(t.xhr&&t.xhr.responseText){var s=JSON.parse(t.xhr.responseText);s.message&&(e=s.message)}this.$q.notify({color:"negative",position:"bottom",message:e})},rejected:function(t){var e=function(t){var e=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=0,a=parseInt(t,10)||0;while(a>=1024&&++s)a/=1024;return a.toFixed(a<10&&s>0?1:0)+" "+e[s]},s="данный файл не соответствует ограничениям";if(t.length>0&&"accept"===t[0].failedPropValidation&&(s="Допустимы только файлы с раширением: ".concat(this.ext.accept," ")),t.length>0&&"max-file-size"===t[0].failedPropValidation){var a=e(this.ext.maxFileSize||1e7);s="Допустимы только файлы не больше: ".concat(a)}this.$q.notify({color:"negative",position:"bottom",message:s})},downloadFile:function(t){var e=this;en()({url:"".concat(this.$config.apiUrl()).concat(t.url),method:"GET",headers:{"Auth-token":localStorage.getItem(this.$config.appName)},responseType:"blob"}).then((function(e){var s=window.URL.createObjectURL(new Blob([e.data])),a=document.createElement("a");a.href=s,a.setAttribute("download",t.filename),document.body.appendChild(a),a.click()})).catch((function(t){var s=t.response.data;t.response.data&&(s=t.response.data.message,"not found"===s&&(s="файл с такой ссылкой не найден")),e.$q.notify({message:s,type:"negative",position:"top-right"})}))},showDeleteDialog:function(t){this.selectedForDeleteFilename=t,this.isShowDeleteDialog=!0},remove:function(){var t=this,e=this.list.findIndex((function(e){return e.filename===t.selectedForDeleteFilename&&!e.deleted}));this.list[e].deleted=!0;var s=this.list[e].url.split("/",-1).slice(-1),a=this.list.splice(e,1);this.list.push(a[0]),this.$utils.postApiRequest({url:"/api/remove_file/".concat(s)}).subscribe((function(e){e.ok&&(t.selectedForDeleteFilename=null)})),this.$utils.postCallPgMethod({method:"".concat(this.ext.tableName,"_update"),params:ba()({id:this.ext.tableId},this.fldName,this.list)}).subscribe((function(e){t.$emit("update",t.list)}))}},mounted:function(){if(!this.ext)throw new Error('compFldFiles missed param: "ext"');if(!this.ext.tableName)throw new Error('compFldFiles missed param: "ext.tableName"');if(!this.ext.tableId)throw new Error('compFldFiles missed param: "ext.tableId"');this.list=this.fld||[],en.a.interceptors.response.use((function(t){return t}),(function(t){return"blob"===t.request.responseType&&t.response.data instanceof Blob&&t.response.data.type&&-1!==t.response.data.type.toLowerCase().indexOf("json")?new Promise((function(e,s){var a=new FileReader;a.onload=function(){t.response.data=JSON.parse(a.result),e(Promise.reject(t))},a.onerror=function(){s(t)},a.readAsText(t.response.data)})):Promise.reject(t)}))}},an=sn,nn=Object(Mt["a"])(an,Zi,Xi,!1,null,null,null),on=nn.exports,ln=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"q-gutter-md row items-start",staticStyle:{position:"relative"}},[s("comp-stat-img-src",{attrs:{src:t.localSrc}},[t.label?s("div",{staticClass:"absolute-top-left text-subtitle2"},[t._v("\n        "+t._s(t.label)+"\n      ")]):t._e()]),s("q-btn",{staticClass:"absolute-top-right",attrs:{outline:"",round:"",icon:"add",color:"grey"},on:{click:function(e){t.isShowDialog=!0}}},[s("q-tooltip",[t._v("Загрузить фото")])],1),s("q-btn",{staticClass:"absolute-bottom-right",attrs:{outline:"",round:"",size:"sm",icon:"delete",color:"grey"},on:{click:function(e){t.isShowDeleteDialog=!0}}},[s("q-tooltip",[t._v("Удалить фото")])],1)],1),s("q-dialog",{model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-uploader",{ref:"uploader",attrs:{label:"Выберите файл для загрузки","auto-upload":"",url:t.uploadUrl,headers:t.headers,accept:t.ext&&t.ext.accept?t.ext.accept:"","max-file-size":t.ext&&t.ext.maxFileSize?t.ext.maxFileSize:1e7,"form-fields":t.formField},on:{rejected:t.rejected,uploaded:t.uploaded,failed:t.failed}})],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.isShowDeleteDialog,callback:function(e){t.isShowDeleteDialog=e},expression:"isShowDeleteDialog"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[s("q-avatar",{attrs:{rounded:"",icon:"warning",color:"warning","text-color":"white"}}),s("span",{staticClass:"q-ml-sm"},[t._v("Удалить?")])],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Удалить"},on:{click:t.remove}})],1)],1)],1)],1)},rn=[],cn={props:{fld:{},label:{},readonly:null,icon:null,vif:{default:!0},ext:{}},computed:{uploadUrl:function(){return"".concat(this.$config.apiUrl(),"/api/").concat(this.ext.uploadUrl||"upload_image")},headers:function(){var t=localStorage.getItem(this.$config.appName);return[{name:"Auth-token",value:t}]},formField:function(){var t=[{name:"tableName",value:this.ext.tableName},{name:"tableId",value:this.ext.tableId}];return this.ext.width&&t.push({name:"width",value:this.ext.width}),this.ext.crop&&t.push({name:"crop",value:this.ext.crop}),t}},data:function(){return{isShowDialog:!1,isShowDeleteDialog:!1,localSrc:null}},watch:{fld:function(t){t&&(this.localSrc=t)}},methods:{uploaded:function(t){var e=t.xhr.response,s=JSON.parse(e);s.ok?(this.localSrc=s.result.file,this.$refs.uploader.reset(),this.isShowDialog=!1,this.$emit("update",this.localSrc),this.ext.fldName&&this.$utils.postCallPgMethod({method:"".concat(this.ext.methodUpdate||this.ext.tableName+"_update"),params:ba()({id:this.ext.tableId},this.ext.fldName,this.localSrc)}).subscribe((function(t){}))):this.$q.notify({color:"negative",position:"bottom",message:s.message})},failed:function(t){var e="ошибка загрузки";if(t.xhr&&t.xhr.responseText){var s=JSON.parse(t.xhr.responseText);s.message&&(e=s.message)}this.$q.notify({color:"negative",position:"bottom",message:e})},rejected:function(t){var e=function(t){var e=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=0,a=parseInt(t,10)||0;while(a>=1024&&++s)a/=1024;return a.toFixed(a<10&&s>0?1:0)+" "+e[s]},s="данный файл не соответствует ограничениям";if(t.length>0&&"accept"===t[0].failedPropValidation&&(s="Допустимы только файлы с раширением: ".concat(this.ext.accept," ")),t.length>0&&"max-file-size"===t[0].failedPropValidation){var a=e(this.ext.maxFileSize||1e7);s="Допустимы только файлы не больше: ".concat(a)}this.$q.notify({color:"negative",position:"bottom",message:s})},remove:function(){var t=this;this.ext.fldName?this.$utils.postCallPgMethod({method:"".concat(this.ext.methodUpdate||this.ext.tableName+"_update"),params:ba()({id:this.ext.tableId},this.ext.fldName,null)}).subscribe((function(e){t.localSrc=null,t.$emit("update",null)})):(this.localSrc=null,this.$emit("update",null))}},mounted:function(){if(!this.ext)throw new Error('compFldFiles missed param: "ext"');if(!this.ext.methodUpdate&&(!this.ext.tableId||!this.ext.tableName))throw new Error('compFldFiles missed param: "ext.methodUpdate" OR "ext.tableId" AND "ext.tableName"');this.localSrc=this.fld||null}},un=cn,dn=Object(Mt["a"])(un,ln,rn,!1,null,null,null),pn=dn.exports,mn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("p",{staticClass:"text-caption"},[t._v(t._s(t.label))]),s("div",{staticClass:"q-gutter-md row items-start"},[t._l(t.list,(function(e,a){return s("comp-stat-img-src",{key:e.file,staticStyle:{width:"150px"},attrs:{src:e.file},on:{error:function(s){return t.imgSrcError(e.file,s)}}},[s("a",{attrs:{href:t.imgUrl(e.file),target:"_blank"}},[s("q-btn",{staticClass:"absolute-top-right",attrs:{flat:"",round:"",size:"sm",icon:"link",color:"white"}})],1),t.readonly?t._e():s("q-btn",{staticClass:"absolute-bottom-right",attrs:{flat:"",round:"",size:"sm",icon:"delete",color:"white"},on:{click:function(s){return t.showDeleteDialog(e.file)}}},[s("q-tooltip",[t._v("Удалить фото")])],1),!t.readonly&&a>0?s("q-btn",{staticClass:"absolute-bottom-left",attrs:{flat:"",round:"",size:"sm",icon:"keyboard_backspace",color:"white"},on:{click:function(s){return t.moveLeft(e.file,a)}}},[s("q-tooltip",[t._v("Поменять местами")])],1):t._e()],1)})),t.readonly?t._e():s("q-btn",{attrs:{flat:"",round:"",icon:"add",size:"sm"},on:{click:function(e){t.isShowDialog=!0}}},[s("q-tooltip",[t._v("Добавить фото")])],1),!t.readonly&&t.ext&&t.ext.canAddUrls?s("q-btn",{attrs:{size:"sm",flat:"",round:"",icon:"add"},on:{click:function(e){t.isShowDialogAddUrl=!0}}},[s("q-tooltip",[t._v("Добавить ссылку")])],1):t._e()],2),s("q-dialog",{model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-uploader",{ref:"uploader",attrs:{label:"Выберите файл для загрузки",multiple:"",url:t.uploadUrl,headers:t.headers,accept:t.ext&&t.ext.accept?t.ext.accept:"","max-file-size":t.ext&&t.ext.maxFileSize?t.ext.maxFileSize:1e7,"form-fields":t.formField},on:{rejected:t.rejected,uploaded:t.uploaded,failed:t.failed,finish:t.finish}})],1),s("q-dialog",{model:{value:t.isShowDialogAddUrl,callback:function(e){t.isShowDialogAddUrl=e},expression:"isShowDialogAddUrl"}},[s("q-card",{staticClass:"q-px-sm q-pb-md",staticStyle:{width:"300px"}},[s("q-img",{attrs:{src:t.newImgUrl?t.newImgUrl:"https://www.cowgirlcontractcleaning.com/wp-content/uploads/sites/360/2018/05/placeholder-img-4.jpg"}}),s("q-card-section",[s("q-input",{attrs:{label:"ссылка на фото"},model:{value:t.newImgUrl,callback:function(e){t.newImgUrl=e},expression:"newImgUrl"}})],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Ок"},on:{click:t.addImgUrl}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.isShowDeleteDialog,callback:function(e){t.isShowDeleteDialog=e},expression:"isShowDeleteDialog"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[s("q-avatar",{attrs:{rounded:"",icon:"warning",color:"warning","text-color":"white"}}),s("span",{staticClass:"q-ml-sm"},[t._v("Удалить?")])],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Удалить"},on:{click:t.remove}})],1)],1)],1)],1)},fn=[],hn={props:{fld:{},label:{},readonly:null,icon:null,vif:{default:!0},ext:{}},computed:{uploadUrl:function(){return"".concat(this.$config.apiUrl(),"/api/").concat(this.ext.uploadUrl||"upload_image")},headers:function(){var t=localStorage.getItem(this.$config.appName);return[{name:"Auth-token",value:t}]},formField:function(){var t=[{name:"tableName",value:this.ext.tableName},{name:"tableId",value:this.ext.tableId}];return this.ext.width&&t.push({name:"width",value:this.ext.width}),this.ext.crop&&t.push({name:"crop",value:this.ext.crop}),t},imgUrl:function(){var t=this;return function(e){return e.includes("http")?e:"".concat(t.$config.apiUrl()).concat(e)}}},data:function(){return{isShowDialog:!1,list:[],isShowDeleteDialog:!1,isShowDialogAddUrl:!1,selectedForDeleteFilename:null,newImgUrl:null}},methods:{uploaded:function(t){var e=t.xhr.response,s=JSON.parse(e);s.ok?this.list.push(s.result):this.$q.notify({color:"negative",position:"bottom",message:s.message})},failed:function(t){var e="ошибка загрузки";if(t.xhr&&t.xhr.responseText){var s=JSON.parse(t.xhr.responseText);s.message&&(e=s.message)}this.$q.notify({color:"negative",position:"bottom",message:e})},rejected:function(t){var e=function(t){var e=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],s=0,a=parseInt(t,10)||0;while(a>=1024&&++s)a/=1024;return a.toFixed(a<10&&s>0?1:0)+" "+e[s]},s="данный файл не соответствует ограничениям";if(t.length>0&&"accept"===t[0].failedPropValidation&&(s="Допустимы только файлы с раширением: ".concat(this.ext.accept," ")),t.length>0&&"max-file-size"===t[0].failedPropValidation){var a=e(this.ext.maxFileSize||1e7);s="Допустимы только файлы не больше: ".concat(a)}this.$q.notify({color:"negative",position:"bottom",message:s})},showDeleteDialog:function(t){this.selectedForDeleteFilename=t,this.isShowDeleteDialog=!0},imgSrcError:function(t,e){this.$q.notify({color:"negative",position:"bottom",message:'ошибка: url "'.concat(t,'" не является ссылкой на фото ')}),this.selectedForDeleteFilename=t,this.remove()},moveLeft:function(t,e){var s=this.list[e];this.list[e]=this.list[e-1],this.$set(this.list,e-1,s),this.$emit("update",this.list)},remove:function(){var t=this,e=this.list.findIndex((function(e){return e.file===t.selectedForDeleteFilename&&!e.deleted}));this.list[e].deleted=!0;var s=this.list.splice(e,1);this.list.push(s[0]),this.$utils.postCallPgMethod({method:"".concat(this.ext.methodUpdate||this.ext.tableName+"_update"),params:ba()({id:this.ext.tableId},this.ext.fldName,this.list)}).subscribe((function(e){t.$emit("update",t.list)}))},addImgUrl:function(){var t=this;this.isShowDialog=!1,this.list.push({file:this.newImgUrl}),this.$utils.postCallPgMethod({method:"".concat(this.ext.methodUpdate||this.ext.tableName+"_update"),params:ba()({id:this.ext.tableId},this.ext.fldName,this.list)}).subscribe((function(e){e.ok&&(t.newImgUrl=null)}))},finish:function(){this.$refs.uploader.reset(),this.isShowDialog=!1,this.$emit("update",this.list),this.$utils.postCallPgMethod({method:"".concat(this.ext.methodUpdate||this.ext.tableName+"_update"),params:ba()({id:this.ext.tableId},this.ext.fldName,this.list)}).subscribe((function(t){}))}},mounted:function(){if(!this.readonly){if(!this.ext)throw new Error('compFldFiles missed param: "ext"');if(!this.ext.fldName)throw new Error('compFldFiles missed param: "ext.fldName"');if(!this.ext.methodUpdate&&(!this.ext.tableId||!this.ext.tableName))throw new Error('compFldFiles missed param: "ext.methodUpdate" OR "ext.tableId" AND "ext.tableName"')}this.fld?this.list=this.fld.filter((function(t){return!t.deleted})):this.list=[]}},gn=hn,bn=Object(Mt["a"])(gn,mn,fn,!1,null,null,null),vn=bn.exports,wn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.item?s("div",[s("comp-dadata-address-dialog",{ref:"addressDialog",on:{update:t.updateAddress}}),s("div",{staticClass:"row q-col-gutter-md q-mb-sm"},[s("div",{staticClass:"col-12"},[s("q-input",{attrs:{outlined:"",label:"Адрес"},scopedSlots:t._u([t.item.geo_lat?{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:"place"},on:{click:t.openOnMap}},[s("q-tooltip",[t._v("показать на карте")])],1)]},proxy:!0}:null,{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"},on:{click:function(e){return t.$refs.addressDialog.open()}}})]},proxy:!0}],null,!0),model:{value:t.item.full,callback:function(e){t.$set(t.item,"full",e)},expression:"item.full"}})],1)])],1):t._e()])},_n=[],xn={props:{fld:{},label:{},readonly:null},data:function(){return{item:null}},watch:{item:{handler:function(t){this.$emit("update",t)},deep:!0}},methods:{updateAddress:function(t){var e,s;if(Array.isArray(t)){if(!t[0])return;e=t[0].value,s=t[0].data}else e=t.value,s=t.data;var a=e,i=s,n=i.city,o=i.region,l=i.area,r=i.street,c=i.postal_code,u=i.house,d=i.place,p=i.geo_lat,m=i.geo_lon;this.item.full=a,this.item.geo_lat=p,this.item.geo_lon=m,this.item.source={city:n,region:o,area:l,street:r,postal_code:c,house:u,place:d}},openOnMap:function(){var t=window.open("http://maps.yandex.ru/?text=".concat(this.item.geo_lat,",").concat(this.item.geo_lon),"_blank");t.focus()}},mounted:function(){this.item=this.fld||{full:null}}},yn=xn,qn=Object(Mt["a"])(yn,wn,_n,!1,null,null,null),kn=qn.exports,Sn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-input",{attrs:{label:t.label,outlined:"",debounce:"500"},scopedSlots:t._u([{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),s("q-list",{attrs:{bordered:"",separator:""}},t._l(t.resultList,(function(e,a){return s("q-item",{key:e.data.hid},[s("q-item-section",{attrs:{side:""}},[s("q-item-label",[t._v(t._s(a+1)+"\n          "),s("q-btn",{attrs:{flat:"",round:"",size:"sm",icon:"add"},on:{click:function(s){return t.$emit("add",e)}}}),s("q-btn",{attrs:{flat:"",round:"",size:"sm",icon:"help_outline"},on:{click:function(s){return t.openDialogWithDetails(e)}}})],1)],1),s("q-item-section",[s("q-item-label",[t._v(t._s(e.value))]),s("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.data.inn)+" "+t._s(e.data.address.value))])],1)],1)})),1),0==t.resultList.length?s("p",{staticClass:"text-caption"},[t._v("не найдено")]):t._e(),t.selectedItem?s("q-dialog",{model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[t._v(t._s(t.selectedItem.value))])]),s("q-separator"),s("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"50vh"}},t._l(t.flds,(function(e){return s("div",{staticClass:"row q-col-gutter-md q-mb-sm"},t._l(e,(function(e){return s("q-input",{key:e.name,class:e.class,attrs:{outlined:"",label:e.label,value:e.value(t.selectedItem.data),readonly:""}})})),1)})),0),s("q-separator"),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"ok",color:"primary"}})],1)],1)],1):t._e()],1)},Dn=[],jn={props:{label:{type:String}},data:function(){var t=this;return{search:"7707083893",resultList:[],selectedItem:null,isShowDialog:!1,flds:[[{value:function(t){return t.inn},label:"ИНН",class:"col-xs-12 col-sm-6"},{value:function(t){return t.kpp},label:"КПП",class:"col-xs-12 col-sm-6"}],[{value:function(t){return t.opf.full},label:"ОПФ",class:"col-xs-12 col-sm-6"},{value:function(e){return t.$t("onecContragent.status_".concat(e.state.status))},label:"Статус",class:"col-xs-12 col-sm-6"}]]}},watch:{search:function(t){t&&t.length>0&&this.getList()}},methods:{getList:function(){var t=this;$n({query:this.search}).subscribe((function(e){e&&(e||(e=[]),t.resultList=e)}))},openDialogWithDetails:function(t){this.selectedItem=t,this.isShowDialog=!0}}},$n=function(t){var e=t.query;return Object(Vs["a"])({url:"https://suggestions.dadata.ru/suggestions/api/4_1/rs/findById/party",method:"POST",headers:Cn(),body:{query:e}}).pipe(Object(Ys["a"])(1),Object(Bs["a"])(Nn()),Object(Hs["a"])(Fn()))},Cn=function(){var t={"Content-Type":"application/json",Accept:"application/json",Authorization:"Token ".concat(Ps.dadataToken)};return t},Nn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.successMsg;return function(t){if(!t.response)throw new Error(t.response.message);return t.response.suggestions}},Fn=function(t){return function(e){var s=e.response?e.response.message:e.message;return t&&$t["a"].create({color:"negative",position:"top-right",message:s}),Object(As["a"])({ok:!1,message:s})}},In=jn,On=Object(Mt["a"])(In,Sn,Dn,!1,null,null,null),Tn=On.exports,Un=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-input",{attrs:{dense:"",label:t.label,filled:"",debounce:"300"},scopedSlots:t._u([t.isFirstSelected?{key:"prepend",fn:function(){return[s("q-icon",{attrs:{name:"add"},on:{click:t.add}})]},proxy:!0}:null,{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!0),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t.notFound?s("p",{staticClass:"text-caption q-mb-none"},[t._v("не найдено")]):t._e(),t.resultList.length>1?s("p",{staticClass:"text-caption q-mb-none"},[t._v("выберите вариант из списка или продолжите ввод")]):t._e(),t.resultList.length>0?s("q-list",{attrs:{bordered:"",separator:""}},t._l(t.resultList,(function(e){return s("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],key:e.data.hid,attrs:{clickable:""}},[s("q-item-section",{on:{click:function(s){return t.selectAddress(e)}}},[s("q-item-label",[t._v(t._s(e.value))])],1)],1)})),1):t._e()],1)},Ln=[],Mn={props:{label:{type:String}},data:function(){return{search:"",resultList:[],selectedItem:null,notFound:!1,isFirstSelected:!1}},watch:{search:function(t){t&&t.length>0&&this.getList()}},methods:{getList:function(){var t=this;En({query:this.search}).subscribe((function(e){e&&(e||(e=[]),t.resultList=e,t.notFound=0===e.length,0===e.length&&(t.isFirstSelected=!1))}))},selectAddress:function(t){var e=this;this.search=t.value,this.isFirstSelected=!0,this.$nextTick((function(){1===e.resultList.length&&(e.resultList=[])}))},add:function(){var t=this;En({query:this.search,count:1}).subscribe((function(e){e&&(t.resultList=[],t.search="",t.$emit("update",e))}))}}},En=function(t){var e=t.query,s=t.count,a=void 0===s?10:s;return Object(Vs["a"])({url:"https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/address",method:"POST",headers:Pn(),body:{query:e,count:a}}).pipe(Object(Ys["a"])(1),Object(Bs["a"])(Rn()),Object(Hs["a"])(Qn()))},Pn=function(){var t={"Content-Type":"application/json",Accept:"application/json",Authorization:"Token ".concat(Ps.dadataToken)};return t},Rn=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.successMsg;return function(t){if(!t.response)throw new Error(t.response.message);return t.response.suggestions}},Qn=function(t){return function(e){var s=e.response?e.response.message:e.message;return t&&$t["a"].create({color:"negative",position:"top-right",message:s}),Object(As["a"])({ok:!1,message:s})}},zn=Mn,An=Object(Mt["a"])(zn,Un,Ln,!1,null,null,null),Yn=An.exports,Bn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-dialog",{model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[s("q-card-section",[s("comp-dadata-address",{staticClass:"q-mb-md",attrs:{label:"Поиск адреса"},on:{update:t.update}})],1)],1)],1)],1)},Hn=[],Vn={props:{label:{type:String}},data:function(){return{isShowDialog:!1}},methods:{open:function(){this.isShowDialog=!0},update:function(t){this.$emit("update",t),this.isShowDialog=!1}}},Jn=Vn,Gn=Object(Mt["a"])(Jn,Bn,Hn,!1,null,null,null),Wn=Gn.exports,Kn=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("q-input",{attrs:{label:t.label,outlined:"",debounce:"500"},scopedSlots:t._u([{key:"append",fn:function(){return[s("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t.resultList.length>0?s("q-list",{attrs:{bordered:"",separator:""}},t._l(t.resultList,(function(e,a){return s("q-item",{key:e.data.hid},[s("q-item-section",{attrs:{side:""}},[s("q-item-label",[t._v(t._s(a+1)+"\n          "),s("q-btn",{attrs:{flat:"",round:"",size:"sm",icon:"add"},on:{click:function(s){return t.$emit("add",e)}}}),s("q-btn",{attrs:{flat:"",round:"",size:"sm",icon:"help_outline"},on:{click:function(s){return t.openDialogWithDetails(e)}}})],1)],1),s("q-item-section",[s("q-item-label",[t._v(t._s(e.value))]),s("q-item-label",{attrs:{caption:""}},[t._v(t._s(e.data.inn)+" "+t._s(e.data.address.value))])],1)],1)})),1):t._e(),t.notFound?s("p",{staticClass:"text-caption"},[t._v("не найдено")]):t._e(),t.selectedItem?s("q-dialog",{model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[t._v(t._s(t.selectedItem.value))])]),s("q-separator"),s("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"50vh"}},t._l(t.flds,(function(e){return s("div",{staticClass:"row q-col-gutter-md q-mb-sm"},t._l(e,(function(e){return s("q-input",{key:e.name,class:e.class,attrs:{outlined:"",label:e.label,value:e.value(t.selectedItem.data),readonly:""}})})),1)})),0),s("q-separator"),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"ok",color:"primary"}})],1)],1)],1):t._e()],1)},Zn=[],Xn={props:{label:{type:String}},data:function(){return{search:"",resultList:[],selectedItem:null,isShowDialog:!1,notFound:!1,flds:[[{value:function(t){return t.inn},label:"ИНН",class:"col-xs-12 col-sm-6"},{value:function(t){return t.kpp},label:"КПП",class:"col-xs-12 col-sm-6"}],[{value:function(t){return t.opf.full},label:"ОПФ",class:"col-xs-12 col-sm-6"},{value:function(t){return io(t.state.status)},label:"Статус",class:"col-xs-12 col-sm-6"}]]}},watch:{search:function(t){t&&t.length>0&&this.getList()}},methods:{getList:function(){var t=this;to({query:this.search}).subscribe((function(e){e&&(e||(e=[]),t.resultList=e,t.notFound=0===e.length)}))},openDialogWithDetails:function(t){this.selectedItem=t,this.isShowDialog=!0}}},to=function(t){var e=t.query;return Object(Vs["a"])({url:"https://suggestions.dadata.ru/suggestions/api/4_1/rs/suggest/party",method:"POST",headers:eo(),body:{query:e}}).pipe(Object(Ys["a"])(1),Object(Bs["a"])(so()),Object(Hs["a"])(ao()))},eo=function(){var t={"Content-Type":"application/json",Accept:"application/json",Authorization:"Token ".concat(Ps.dadataToken)};return t},so=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.successMsg;return function(t){if(!t.response)throw new Error(t.response.message);return t.response.suggestions}},ao=function(t){return function(e){var s=e.response?e.response.message:e.message;return t&&$t["a"].create({color:"negative",position:"top-right",message:s}),Object(As["a"])({ok:!1,message:s})}},io=function(t){switch(t){case"ACTIVE":return"действующая";case"LIQUIDATING":return"ликвидируется";case"LIQUIDATED":return"ликвидирована";case"REORGANIZING":return"в процессе присоединения к другому юрлицу";default:return t}},no=Xn,oo=Object(Mt["a"])(no,Kn,Zn,!1,null,null,null),lo=oo.exports,ro=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-select",{attrs:{outlined:"","use-input":"","hide-selected":"","fill-input":"","input-debounce":"300",label:t.label,options:t.options},on:{filter:t.filterFn},scopedSlots:t._u([{key:"no-option",fn:function(){return[s("q-item",[s("q-item-section",{staticClass:"text-grey"},[t._v("\n        Ничего не найдено\n      ")])],1)]},proxy:!0}]),model:{value:t.item,callback:function(e){t.item=e},expression:"item"}})},co=[],uo={props:{label:{},pgMethod:{},title:{},ext:{},existIds:{}},data:function(){return{item:null,options:[]}},watch:{item:function(t){t&&this.$emit("update",t.value)}},methods:{filterFn:function(t,e,s){var a=this;e((function(){a.loadData(t)}))},loadData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",s={search_text:e,per_page:20};this.ext&&(s=Object.assign({search_text:e,per_page:20},this.ext)),this.$utils.postCallPgMethod({method:this.pgMethod,params:s}).subscribe((function(e){e.ok&&(e.result||(e.result=[]),t.existIds&&Array.isArray(t.existIds)&&(e.result=e.result.filter((function(e){return!t.existIds.includes(e.id)}))),t.options=e.result.map((function(e){var s=e[t.title?t.title:"title"];return Gs.a.isFunction(t.title)&&(s=t.title(e)),s||(s="неверно указан параметр для label"),{label:s,value:e}})))}))}},mounted:function(){this.loadData()}},po=uo,mo=Object(Mt["a"])(po,ro,co,!1,null,null,null),fo=mo.exports,ho=function(){var t=this,e=t.$createElement,s=t._self._c||e;return"new"!=t.id?s("div",[s("q-bar",{staticClass:"bg-secondary text-white shadow-2"},[s("div",[t._v(t._s(t.label))]),s("q-space"),t.isShowList&&t.list.length>0?s("q-btn",{attrs:{dense:"",flat:"",icon:"expand_less"},on:{click:function(e){t.isShowList=!1}}}):t._e(),!t.isShowList&&t.list.length>0?s("q-btn",{attrs:{dense:"",flat:"",icon:"expand_more"},on:{click:function(e){t.isShowList=!0}}}):t._e(),t.readonly?t._e():s("q-btn",{attrs:{dense:"",flat:"",icon:"add"},on:{click:function(e){t.isShowAddDialog=!0}}})],1),t.isShowList?s("q-list",{attrs:{bordered:"",separator:""}},t._l(t.filteredList,(function(e){return s("q-item",{key:e.id},[s("q-item-section",{attrs:{avatar:""},on:{click:function(s){return t.$router.push(t.tableDependRoute+"/"+e[t.tableDependFldName])}}},[s("q-avatar",{attrs:{rounded:""}},[s("comp-stat-img-src",{attrs:{src:t.avatar(e)}})],1)],1),s("q-item-section",[s("q-item-label",[t._v(t._s(e.options.title[t.tableDependFldTitle]))]),t._t("default",null,{item:e})],2),t.readonly?t._e():s("q-item-section",{attrs:{side:""}},[s("div",{staticClass:"text-grey-8 q-gutter-xs"},[t.flds?s("q-btn",{attrs:{flat:"",round:"",icon:"edit",size:"sm"},on:{click:function(s){return t.showEditDialog(e)}}},[s("q-tooltip",[t._v("Редактировать")])],1):t._e(),s("q-btn",{attrs:{flat:"",round:"",icon:"delete",size:"sm"},on:{click:function(s){return t.showDeleteDialog(e.id)}}},[s("q-tooltip",[t._v("Удалить")])],1)],1)])],1)})),1):t._e(),s("q-dialog",{attrs:{persistent:""},model:{value:t.isShowAddDialog,callback:function(e){t.isShowAddDialog=e},expression:"isShowAddDialog"}},[s("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[s("q-card-section",{staticClass:"row items-center"},[s("span",{staticClass:"q-ml-sm"},[t._v("Добавление")])]),s("q-card-section",[s("comp-search-ref-in-list-widget",{attrs:{label:"Поиск","pg-method":t.tableDependName+"_list",ext:t.searchExt},on:{update:function(e){return t.selectedForAdd=e}}}),t.flds?t._l(t.flds,(function(e){return s("div",{staticClass:"row q-col-gutter-md q-mt-sm"},t._l(e,(function(e){return s("comp-fld",{key:e.name,attrs:{fld:t.localItem[e.name],type:e.type,label:e.label,selectOptions:e.selectOptions?e.selectOptions():[],columnClass:e.columnClass},on:{update:function(s){t.localItem[e.name]=s}}})})),1)})):t._e()],2),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Добавить"},on:{click:t.add}}),t.hideCreateNew?t._e():s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"q-ml-md",attrs:{flat:"",label:"Создать"},on:{click:t.openNew}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.isShowEditDialog,callback:function(e){t.isShowEditDialog=e},expression:"isShowEditDialog"}},[s("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[s("q-card-section",[t.flds&&t.selectedForEdit?t._l(t.flds,(function(e){return s("div",{staticClass:"row q-col-gutter-md q-mt-sm"},t._l(e,(function(e){return s("comp-fld",{key:e.name,attrs:{fld:t.selectedForEdit[e.name],type:e.type,label:e.label,selectOptions:e.selectOptions?e.selectOptions():[],columnClass:e.columnClass},on:{update:function(s){t.selectedForEdit[e.name]=s}}})})),1)})):t._e()],2),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Ok"},on:{click:t.save}})],1)],1)],1),s("q-dialog",{attrs:{persistent:""},model:{value:t.isShowDeleteDialog,callback:function(e){t.isShowDeleteDialog=e},expression:"isShowDeleteDialog"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[s("q-avatar",{attrs:{rounded:"",icon:"warning",color:"warning","text-color":"white"}}),s("span",{staticClass:"q-ml-sm"},[t._v("Удалить?")])],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Удалить"},on:{click:t.remove}})],1)],1)],1)],1):t._e()},go=[],bo={props:["id","tableIdName","tableIdFldName","tableDependName","tableDependFldName","tableDependRoute","linkTableName","label","avatarSrc","hideCreateNew","flds","readonly","searchExt","filterListFn"],computed:{tableDependFldTitle:function(){return this.tableDependFldName.split("_id")[0]+"_title"},avatar:function(){return function(t){var e=this.tableDependFldName.split("_id")[0];return t.options.title[e+"_avatar"]||this.avatarSrc||"https://www.svgrepo.com/show/95333/avatar.svg"}},filteredList:function(){return this.filterListFn?this.list.filter(this.filterListFn):this.list}},data:function(){return{isShowList:!0,list:[],localItem:{},isShowAddDialog:!1,isShowDeleteDialog:!1,selectedForDeleteId:null,selectedForAdd:null,isShowEditDialog:!1,selectedForEdit:null}},methods:{showDeleteDialog:function(t){this.selectedForDeleteId=t,this.isShowDeleteDialog=!0},showEditDialog:function(t){this.isShowEditDialog=!0,this.selectedForEdit=t},add:function(){var t=this;if(this.selectedForAdd){var e={id:-1};e[this.tableIdFldName]=+this.id,e[this.tableDependFldName]=this.selectedForAdd.id,this.$utils.postCallPgMethod({method:"".concat(this.linkTableName,"_update"),params:Object.assign(e,this.localItem)}).subscribe((function(e){e.ok&&(t.reload(),t.$emit("reload"))}))}},remove:function(){var t=this;this.$utils.postCallPgMethod({method:"".concat(this.linkTableName,"_update"),params:{id:this.selectedForDeleteId,deleted:!0}}).subscribe((function(e){e.ok&&(t.reload(),t.$emit("reload"))}))},reload:function(){var t=this,e={};e[this.tableIdFldName]=+this.id,e.order_by="id",this.$utils.postCallPgMethod({method:"".concat(this.linkTableName,"_list"),params:e}).subscribe((function(e){e.ok&&(t.list=e.result)}))},save:function(){var t=this;this.$utils.postCallPgMethod({method:"".concat(this.linkTableName,"_update"),params:this.selectedForEdit}).subscribe((function(e){e.ok&&(t.isShowEditDialog=!1,t.selectedForEdit=null,t.reload(),t.$emit("reload"))}))},openNew:function(){window.open("".concat(this.tableDependRoute,"/new"),"_blank")}},mounted:function(){var t=this;this.reload(),this.flds&&Gs.a.flattenDeep(this.flds).map((function(e){t.$set(t.localItem,e.name,"checkbox"!==e.type&&null)}))}},vo=bo,wo=Object(Mt["a"])(vo,ho,go,!1,null,null,null),_o=wo.exports,xo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.is_btn_with_label?t._e():s("q-btn",{attrs:{icon:t.iconName,flat:"",round:"",size:t.btnSize},on:{click:function(e){t.isOpenUpload=!0}}},[t.tooltip?s("q-tooltip",[t._v(t._s(t.tooltip))]):t._e()],1),t.is_btn_with_label?s("q-btn",{attrs:{icon:t.iconName,outline:"",label:t.label,color:t.btnColor,size:t.btnSize},on:{click:function(e){t.isOpenUpload=!0}}},[t.tooltip?s("q-tooltip",[t._v(t._s(t.tooltip))]):t._e()],1):t._e(),s("q-dialog",{model:{value:t.isOpenUpload,callback:function(e){t.isOpenUpload=e},expression:"isOpenUpload"}},[s("q-card",[s("q-card-section",[s("q-uploader",{ref:"uploader",attrs:{label:t.labelName,"auto-upload":"",filter:t.checkFileType,url:t.uploadUrl,headers:t.headers},on:{uploaded:t.uploaded,failed:t.failed}})],1)],1)],1)],1)},yo=[],qo={props:["url","fileExt","icon","tooltip","label","is_btn_with_label","size","color"],computed:{uploadUrl:function(){return"".concat(this.$config.apiUrl(),"/api/").concat(this.url)},headers:function(){var t=localStorage.getItem(this.$config.appName);return[{name:"Auth-token",value:t}]},btnSize:function(){return this.size||"sm"},btnColor:function(){return this.color||"primary"}},data:function(){return{isOpenUpload:!1,iconName:"cloud_upload",labelName:"Выберите файл для загрузки"}},methods:{checkFileType:function(t){var e=this;if(this.fileExt&&this.fileExt.length>0){var s=t.filter((function(t){return e.fileExt.filter((function(e){return t.name.includes(".".concat(e))})).length>0}));return 0===s.length&&this.$q.notify({type:"negative",message:"файл должен иметь расширение ".concat(this.fileExt)}),s}return t},uploaded:function(t){var e=t.xhr.response,s=JSON.parse(e);s.ok?(this.$refs.uploader.reset(),this.isOpenUpload=!1,this.$emit("result",s.result)):this.$q.notify({color:"negative",position:"bottom",message:s.message})},failed:function(t){var e="ошибка загрузки";if(t.xhr&&t.xhr.responseText){var s=JSON.parse(t.xhr.responseText);s.message&&(e=s.message)}this.$q.notify({color:"negative",position:"bottom",message:e})}},mounted:function(){this.icon&&(this.iconName=this.icon),this.label&&(this.labelName=this.label)}},ko=qo,So=Object(Mt["a"])(ko,xo,yo,!1,null,null,null),Do=So.exports,jo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-dialog",{attrs:{persistent:""},model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[t.icon?s("q-avatar",{attrs:{icon:t.icon,color:"primary","text-color":"white"}}):t._e(),s("span",{staticClass:"q-ml-sm"},[t._v(t._s(t.label))])],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена",color:"primary"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Ок",color:"primary"},on:{click:function(e){return t.$emit("update",t.item)}}})],1)],1)],1)},$o=[],Co={props:["label","icon"],data:function(){return{isShowDialog:!1,item:null}},methods:{open:function(t){this.isShowDialog=!0,this.item=t}}},No=Co,Fo=Object(Mt["a"])(No,jo,$o,!1,null,null,null),Io=Fo.exports,Oo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-img",{attrs:{src:t.imgUrl},on:{error:function(e){return t.$emit("error",e)}}},[t._t("default")],2)},To=[],Uo={props:["src"],computed:{imgUrl:function(){return this.src?this.src.includes("http")?this.src:"".concat(this.$config.apiUrl()).concat(this.src):"https://www.foot.com/wp-content/uploads/2017/03/placeholder.gif"}}},Lo=Uo,Mo=Object(Mt["a"])(Lo,Oo,To,!1,null,null,null),Eo=Mo.exports,Po=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-dialog",{on:{hide:t.hide},model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[t._v("Создать задачу")]),s("div",{staticClass:"row q-col-gutter-md q-mb-sm"},[s("div",{staticClass:"col-12"},[s("comp-fld-ref-search",{attrs:{label:"Тип задачи",item:"",pgMethod:"task_type_list",ext:{table_name:t.table_name}},on:{update:t.updateTaskType}})],1)]),s("div",{staticClass:"row q-col-gutter-md q-mb-sm"},[s("div",{staticClass:"col-xs-12 col-sm-6 col-md-6"},[s("comp-fld-user-search",{attrs:{label:"Ответственный",user:""},on:{update:function(e){return t.task.executor_id=e.id}}})],1),s("div",{staticClass:"col-xs-12 col-sm-6 col-md-6"},[s("comp-fld-date-time",{attrs:{label:"Deadline"},on:{update:function(e){return t.task.deadline=e}}})],1)]),s("div",{staticClass:"row q-col-gutter-md q-mb-sm"},[s("div",{staticClass:"col-12"},[s("q-input",{attrs:{outlined:"",label:"Текст",autogrow:""},model:{value:t.task.content,callback:function(e){t.$set(t.task,"content",e)},expression:"task.content"}})],1)])]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{attrs:{flat:"",label:"OK",color:"primary"},on:{click:t.done}})],1)],1)],1)},Ro=[],Qo={props:["table_id","table_name"],data:function(){return{isShowDialog:!1,task:{}}},methods:{open:function(){this.isShowDialog=!0},hide:function(){},updateTaskType:function(t){var e=t.id,s=t.item;this.task.task_type_id=e;var a=s.item.table_name;a?(this.task.table_name=a,this.task.table_id=+this.table_id):(this.task.table_name=null,this.task.table_id=null)},done:function(){var t=this,e=!1,s=[{fld:"task_type_id",title:"Тип задачи"},{fld:"deadline",title:"Deadline"},{fld:"executor_id",title:"Ответственный"}];if(s.map((function(s){t.task[s.fld]||(e=!0,t.$q.notify({message:'Поле "'.concat(s.title,'" не заполнено'),type:"negative"}))})),!e){var a=Object.assign({id:-1},this.task);this.$utils.postCallPgMethod({method:"task_update",params:a}).subscribe((function(e){e.ok&&(t.isShowDialog=!1,t.task={},t.$emit("updated"))}))}}}},zo=Qo,Ao=Object(Mt["a"])(zo,Po,Ro,!1,null,null,null),Yo=Ao.exports,Bo=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-dialog",{on:{hide:t.hide},model:{value:t.isShowDialog,callback:function(e){t.isShowDialog=e},expression:"isShowDialog"}},[s("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[t._v(t._s(t.task.task_type_title))])]),s("q-card-section",{staticClass:"q-mt-md"},[s("q-slider",{attrs:{min:0,max:10,step:1,snap:"","label-always":"","label-value":"Оценка успешности: "+t.success_rate,markers:"",color:"primary"},model:{value:t.success_rate,callback:function(e){t.success_rate=e},expression:"success_rate"}})],1),s("q-card-section",[s("q-input",{attrs:{outlined:"",label:"Результат",autogrow:""},model:{value:t.taskResult,callback:function(e){t.taskResult=e},expression:"taskResult"}})],1),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Отмена"}}),s("q-btn",{attrs:{flat:"",label:"OK",color:"primary"},on:{click:t.done}})],1)],1)],1)},Ho=[],Vo={data:function(){return{isShowDialog:!1,task:{},success_rate:0,taskResult:null}},methods:{open:function(t){this.task=t,this.isShowDialog=!0},hide:function(){this.success_rate=0,this.taskResult=null},done:function(){var t=this;this.$utils.postCallPgMethod({method:"task_action_to_finished",params:{id:this.task.id,result:this.taskResult,success_rate:this.success_rate}}).subscribe((function(e){e.ok&&(t.$emit("taskFinished",t.task.id),t.isShowDialog=!1)}))}}},Jo=Vo,Go=Object(Mt["a"])(Jo,Bo,Ho,!1,null,null,null),Wo=Go.exports,Ko=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"row justify-center"},[t.isShowNewChatBtn?s("q-btn",{attrs:{round:"",color:"secondary"},on:{click:t.createChat}},[s("q-avatar",{attrs:{size:"52px"}},[s("img",{attrs:{src:"https://image.flaticon.com/icons/svg/3081/3081489.svg"}})]),s("q-tooltip",[t._v("создать чат")])],1):t._e(),t.chat?s("q-card",{staticStyle:{width:"100%","max-width":"400px"}},[s("q-bar",[s("q-icon",{attrs:{name:"chat"}}),s("div",[t._v("чат")])],1),s("q-scroll-area",{ref:"chatScroll",staticStyle:{height:"400px","max-width":"400px"},attrs:{"thumb-style":t.thumbStyle,"bar-style":t.barStyle}},[s("q-card-section",t._l(t.msgList,(function(e){return s("q-chat-message",{key:e.id,attrs:{name:e.fullname,avatar:e.avatar,text:[e.title],stamp:t.$utils.formatPgDateTime(e.updated_at),sent:""}})})),1)],1),s("q-card-section",[s("q-input",{attrs:{label:"написать сообщение",outlined:"",autogrow:""},scopedSlots:t._u([{key:"append",fn:function(){return[t.newMsg&&""!==t.newMsg?s("q-icon",{staticClass:"cursor-pointer",attrs:{name:"send"},on:{click:t.send}}):t._e()]},proxy:!0}],null,!1,2858649021),model:{value:t.newMsg,callback:function(e){t.newMsg=e},expression:"newMsg"}})],1)],1):t._e()],1)},Zo=[],Xo={props:["table_name","table_id"],data:function(){return{chat:null,isShowNewChatBtn:!1,msgList:[],newMsg:null,thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#027be3",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#027be3",width:"9px",opacity:.2}}},methods:{createChat:function(){var t=this;this.isShowNewChatBtn=!1,this.$utils.postCallPgMethod({method:"chat_update",params:{id:-1,table_name:this.table_name,table_id:this.table_id}}).subscribe((function(e){e.ok&&(t.reload(),t.newMsg=null)}))},send:function(){var t=this;this.$utils.postCallPgMethod({method:"chat_message_update",params:{id:-1,chat_id:this.chat.id,title:this.newMsg}}).subscribe((function(e){e.ok&&(t.reload(),t.newMsg=null)}))},reload:function(){var t=this;this.$utils.postCallPgMethod({method:"chat_for_table_id",params:{table_name:this.table_name,table_id:this.table_id},isShowError:!1}).subscribe((function(e){e.ok&&(t.isShowNewChatBtn=!1,e.result.length>0&&(t.chat=e.result[0],t.msgList=e.result[0].message_list||[],t.msgList=t.msgList.map((function(e){return e.avatar?(e.avatar="".concat(t.$config.apiUrl()).concat(e.avatar),console.log("v.avatar:",e.avatar)):e.avatar="https://www.svgrepo.com/show/95333/avatar.svg",e})),t.$nextTick((function(){var e=t.$refs.chatScroll,s=e.getScrollTarget(),a=100;e.setScrollPosition(s.scrollHeight,a)}))))}))}},mounted:function(){var t=this;this.reload(),setTimeout((function(){t.chat||(t.isShowNewChatBtn=!0)}),400)}},tl=Xo,el=Object(Mt["a"])(tl,Ko,Zo,!1,null,null,null),sl=el.exports,al=function(t){t.component("comp-doc-list",Ia),t.component("comp-item-dropdown-btn",Ea),t.component("comp-fld",Ya),t.component("comp-fld-user-search",Wa),t.component("comp-fld-user-multiple-search",Oi),t.component("comp-breadcrumb",si),t.component("comp-delete-btn-in-list",ri),t.component("comp-fld-date",hi),t.component("comp-fld-date-time",xi),t.component("comp-item-btn-save",ji),t.component("comp-fld-ref-search",Pi),t.component("comp-fld-select-city",Bi),t.component("comp-fld-contact",Ki),t.component("comp-fld-files",on),t.component("comp-fld-img",pn),t.component("comp-fld-address",kn),t.component("comp-fld-img-list",vn),t.component("comp-dadata-suggestion",Tn),t.component("comp-dadata-address",Yn),t.component("comp-dadata-address-dialog",Wn),t.component("comp-dadata-company",lo),t.component("comp-search-ref-in-list-widget",fo),t.component("comp-link-list-widget",_o),t.component("comp-stat-img-src",Eo),t.component("comp-dialog-confirm",Io),t.component("comp-dialog-task-add",Yo),t.component("comp-dialog-task-done",Wo),t.component("comp-chat",sl),t.component("comp-file-upload",Do)},il=function(t){var e=t.Vue;al(e)},nl=s("4b96"),ol=new nl["a"],ll=(Es=function t(){ha()(this,t),ba()(this,"getList$",(function(){return ol})),ba()(this,"loadList",(function(){ca.postCallPgMethod({method:"task_list_for_user",params:{state:"in_process"}}).subscribe((function(t){t.ok&&t.result.map((function(t){ol.next(rl(t))}))}))})),ba()(this,"addTask",(function(t){ol.next(rl(t))}))},Es),rl=function(t){return new Date(t.deadline)<new Date&&(t.isDeadlinePass=!0),t},cl=ll,ul=function(t){var e=t.Vue;e.use({install:function(t,e){t.prototype.$userTasks=new cl}},{})},dl=function(){var t=o()(i.a.mark((function t(e){var s;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s=e.Vue,s.use({install:function(t,e){t.prototype.$axios=en.a}},{});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function pl(){return ml.apply(this,arguments)}function ml(){return ml=o()(i.a.mark((function t(){var e,s,a,n,o,r,c,u;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Us();case 2:e=t.sent,s=e.app,a=e.router,n=!0,o=function(t){n=!1,window.location.href=t},r=window.location.href.replace(window.location.origin,""),c=[Rs,ma,Sa,il,ul,dl],u=0;case 10:if(!(!0===n&&u<c.length)){t.next=28;break}if("function"===typeof c[u]){t.next=13;break}return t.abrupt("continue",25);case 13:return t.prev=13,t.next=16,c[u]({app:s,router:a,Vue:l["a"],ssrContext:null,redirect:o,urlPath:r});case 16:t.next=25;break;case 18:if(t.prev=18,t.t0=t["catch"](13),!t.t0||!t.t0.url){t.next=23;break}return window.location.href=t.t0.url,t.abrupt("return");case 23:return console.error("[Quasar] boot error:",t.t0),t.abrupt("return");case 25:u++,t.next=10;break;case 28:if(!1!==n){t.next=30;break}return t.abrupt("return");case 30:new l["a"](s);case 31:case"end":return t.stop()}}),t,null,[[13,18]])}))),ml.apply(this,arguments)}pl()},"2f63":function(t,e,s){},4678:function(t,e,s){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function i(t){var e=n(t);return s(e)}function n(t){if(!s.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}i.keys=function(){return Object.keys(a)},i.resolve=n,t.exports=i,i.id="4678"},6348:function(t,e,s){},"7e6d":function(t,e,s){},ca37:function(t,e,s){"use strict";var a=s("6348"),i=s.n(a);i.a},f488:function(t,e,s){"use strict";s("6762"),s("2fdb");var a=s("2bd2"),i=s("9f2d");e["a"]={computed:{isLoggedIn:function(){return this.currentUser},isWorking:function(){return this.currentUser&&this.currentUser.options&&"working"===this.currentUser.options.state},isWaitingAuth:function(){return this.currentUser&&this.currentUser.options&&"waiting_auth"===this.currentUser.options.state},isFired:function(){return this.currentUser&&this.currentUser.options&&"fired"===this.currentUser.options.state},isAdmin:function(){var t,e;return null===(t=this.currentUser)||void 0===t||null===(e=t.role)||void 0===e?void 0:e.includes("admin")}},data:function(){return{currentUser:{},isInLogingProcess:!1,currentUserdestroy$:new a["a"]}},methods:{login:function(){this.$currentUser.login()},logout:function(){this.$currentUser.logout()}},mounted:function(){var t=this;this.$currentUser.getUser$().pipe(Object(i["a"])(this.currentUserdestroy$)).subscribe((function(e){t.currentUser=e})),this.$currentUser.getIsInLogingProcess().pipe(Object(i["a"])(this.currentUserdestroy$)).subscribe((function(e){t.isInLogingProcess=e}))},destroyed:function(){this.currentUserdestroy$.next(!0),this.currentUserdestroy$.complete()}}}},[[0,2,0]]]);