"use strict";(self["webpackChunkCounter"]=self["webpackChunkCounter"]||[]).push([[9833],{1181:(e,l,t)=>{t.d(l,{Z:()=>h});var a=t(75305);const d={class:"q-px-lg q-pb-md"},o={style:{color:"grey","font-size":"0.8rem"}},i={key:0,class:"q-pa-md row justify-center"},r=(0,a.Uk)(" было "),u=(0,a.Uk)(" изменено на ");function n(e,l,t,n,s,m){const c=(0,a.up)("q-timeline-entry"),p=(0,a.up)("q-item-section"),w=(0,a.up)("q-card"),_=(0,a.up)("q-timeline"),f=(0,a.up)("q-card-section"),y=(0,a.up)("q-dialog"),v=(0,a.up)("q-btn");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(y,{modelValue:n.isShowDialog,"onUpdate:modelValue":l[0]||(l[0]=e=>n.isShowDialog=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{style:{"max-width":"100vw","min-width":"50vw"}},{default:(0,a.w5)((()=>[(0,a.Wm)(f,null,{default:(0,a.w5)((()=>[(0,a._)("div",d,[(0,a.Wm)(_,{color:"secondary",layout:n.timelineLayout},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{heading:"",tag:"h6"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(t.item.title),1)])),_:1}),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.historyList,(e=>((0,a.wg)(),(0,a.j4)(c,{key:e.id,icon:e.icon,color:e.color},{title:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[(0,a._)("div",null,(0,a.zw)(e.type),1),(0,a._)("div",o,(0,a.zw)(e.user_full_name),1)])),_:2},1024)])),subtitle:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(new Date(e.datetime).toLocaleDateString("ru",{weekday:"short",day:"numeric",month:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),1)])),default:(0,a.w5)((()=>[e.old_value?((0,a.wg)(),(0,a.iD)("div",i,[r,(0,a.Wm)(w,{class:"col-12 q-pa-md"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(e.old_value),1)])),_:2},1024),u,(0,a.Wm)(w,{class:"col-12 q-pa-md",style:{"background-color":"rgba(33,186,69,0.1)"}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(e.new_value),1)])),_:2},1024)])):(0,a.kq)("",!0)])),_:2},1032,["icon","color"])))),128))])),_:1},8,["layout"])])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(v,{round:t.round,rounded:t.rounded,push:"",icon:"history",color:"accent",label:t.label,onClick:l[1]||(l[1]=e=>n.open())},null,8,["round","rounded","label"])],64)}var s=t(48825);const m={props:["historyList","item","label","rounded","round"],setup(e){const l=(0,a.iH)(!1),t=(0,s.Z)(),d=(0,a.Fl)((()=>t.screen.lt.sm?"dense":t.screen.lt.md?"comfortable":"loose")),o=()=>{l.value=!0};return{isShowDialog:l,open:o,timelineLayout:d}}};var c=t(74260),p=t(46778),w=t(10151),_=t(25589),f=t(1432),y=t(23424),v=t(52035),g=t(2165),k=t(7518),b=t.n(k);const W=(0,c.Z)(m,[["render",n]]),h=W;b()(m,"components",{QDialog:p.Z,QCard:w.Z,QCardSection:_.Z,QTimeline:f.Z,QTimelineEntry:y.Z,QItemSection:v.Z,QBtn:g.Z})},99833:(e,l,t)=>{t.r(l),t.d(l,{default:()=>Se});var a=t(75305);const d={class:"q-pa-md"},o={key:0},i={key:1},r={class:"row justify-start items-center"},u=(0,a._)("img",{src:"image/task.svg",alt:""},null,-1),n=(0,a.Uk)("    "),s={class:"row justify-center items-center"},m=(0,a._)("img",{src:"image/system.svg",alt:""},null,-1);function c(e,l,t,c,p,w){const _=(0,a.up)("comp-breadcrumb"),f=(0,a.up)("task-add-button"),y=(0,a.up)("filter-component"),v=(0,a.up)("q-space"),g=(0,a.up)("q-th"),k=(0,a.up)("q-td"),b=(0,a.up)("q-avatar"),W=(0,a.up)("q-item-label"),h=(0,a.up)("q-item-section"),C=(0,a.up)("q-item"),q=(0,a.up)("timeline-dialog-button"),V=(0,a.up)("task-delete-button"),x=(0,a.up)("q-btn"),O=(0,a.up)("q-tr"),M=(0,a.up)("q-table"),Z=(0,a.up)("q-card-section"),H=(0,a.up)("q-card"),F=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(F,{padding:!t.isOpenInDialog},{default:(0,a.w5)((()=>[t.isOpenInDialog?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(_,{key:0,class:"text-capitalize",list:[{label:e.$t("task.name_plural"),docType:"task"}]},null,8,["list"])),(0,a.Wm)(H,{style:{"min-width":"70vw"}},{default:(0,a.w5)((()=>[(0,a.Wm)(Z,null,{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",d,[(0,a.Wm)(M,{title:"",rows:c.taskList,columns:c.columns,"row-key":"id","rows-per-page-options":[10,25,50,100]},{top:(0,a.w5)((()=>[(0,a.Wm)(f,{onReload:c.reload},null,8,["onReload"]),(0,a.Wm)(y,{tableMode:!0,currentUser:e.currentUser,onSqlRestBtnClickHandler:c.sqlRestBtnClickHandler},null,8,["currentUser","onSqlRestBtnClickHandler"]),(0,a.Wm)(v)])),"header-cell-delete":(0,a.w5)((e=>[(0,a.Wm)(g,{props:e,onClick:c.deletedFilter,style:{cursor:"pointer"}},{default:(0,a.w5)((()=>[c.deleted?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",o,(0,a.zw)(e.col.label),1)),c.deleted?((0,a.wg)(),(0,a.iD)("div",i," Восстановить ")):(0,a.kq)("",!0)])),_:2},1032,["props","onClick"])])),body:(0,a.w5)((e=>[(0,a.Wm)(O,{props:e,style:(0,a.j5)(!0===e.row.today?"background-color: #F2C037":"")},{default:(0,a.w5)((()=>[(0,a.Wm)(k,{key:"id",props:e,style:{width:"0"}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(e.row.id),1)])),_:2},1032,["props"]),(0,a.Wm)(k,{key:"title",props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{to:/task/+e.row.id,style:{cursor:"pointer"}},{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a._)("div",r,[(0,a.Wm)(b,{rounded:"",size:"sm"},{default:(0,a.w5)((()=>[u])),_:1}),n,(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(e.row.title),1)])),_:2},1024)])])),_:2},1024)])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,a.Wm)(k,{key:"type",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(e.row.options.title.type_title),1)])),_:2},1032,["props"]),(0,a.Wm)(k,{key:"state",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(e.row.options.title.state_title),1)])),_:2},1032,["props"]),(0,a.Wm)(k,{key:"stage",props:e},{default:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(e.row.options.title.stage_title),1)])),_:2},1032,["props"]),(0,a.Wm)(k,{key:"system",props:e},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{to:/system/+e.row.system_id,style:{cursor:"pointer"},align:"left"},{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a._)("div",s,[(0,a.Wm)(b,{rounded:"",size:"sm"},{default:(0,a.w5)((()=>[m])),_:1}),(0,a.Wm)(W,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,a.zw)(e.row.options.title.system_title),1)])),_:2},1024)])])),_:2},1024)])),_:2},1032,["to"])])),_:2},1032,["props"]),(0,a.Wm)(k,{key:"history",props:e,"auto-width":""},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{historyList:e.row.history,round:!0,item:e.row},null,8,["historyList","item"])])),_:2},1032,["props"]),(0,a.Wm)(k,{key:"delete",props:e,"auto-width":""},{default:(0,a.w5)((()=>[(0,a.Wm)(V,{item:e.row,onReload:l[0]||(l[0]=e=>c.reload())},null,8,["item"])])),_:2},1032,["props"]),(0,a.Wm)(k,{key:"log",props:e,"auto-width":""},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{onClick:l=>c.logg(e.row),icon:"info"},null,8,["onClick"])])),_:2},1032,["props"])])),_:2},1032,["props","style"])])),_:1},8,["rows","columns"])])])])),_:1})])),_:1})])),_:1},8,["padding"])}var p=t(43015),w=t(91589),_=t(1181);const f=(0,a._)("div",{class:"text-h6"},"Удалить задачу",-1),y=(0,a._)("strong",null,"Внимание!",-1),v=(0,a._)("p",null,null,-1),g=(0,a._)("p",null,"Вы точно хотите удалить задачу:",-1),k=(0,a._)("div",{class:"text-h6"},"Восстановить задачу",-1),b=(0,a._)("strong",null,"Внимание!",-1),W=(0,a._)("p",null,null,-1),h=(0,a._)("p",null,"Вы точно хотите восстановить задачу:",-1),C={align:"center"},q=(0,a.Uk)("Удалить"),V=(0,a.Uk)("Восстановить");function x(e,l,t,d,o,i){const r=(0,a.up)("q-card-section"),u=(0,a.up)("q-btn"),n=(0,a.up)("q-card-actions"),s=(0,a.up)("q-card"),m=(0,a.up)("q-dialog"),c=(0,a.up)("q-tooltip"),p=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(m,{modelValue:d.deleteDialog,"onUpdate:modelValue":l[0]||(l[0]=e=>d.deleteDialog=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{style:{"min-width":"20vw"}},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[f])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a._)("div",null,[y,v,g,(0,a._)("p",null,(0,a.zw)(t.item.title)+"?",1)])])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)(n,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Отмена"},null,512),[[p]]),(0,a.Wm)(u,{label:"Удалить",onClick:d.deleteTask,color:"positive"},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(m,{modelValue:d.restoreDialog,"onUpdate:modelValue":l[1]||(l[1]=e=>d.restoreDialog=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(s,{style:{"min-width":"20vw"}},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[k])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a._)("div",null,[b,W,h,(0,a._)("p",null,(0,a.zw)(t.item.title)+"?",1)])])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)(n,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Отмена"},null,512),[[p]]),(0,a.Wm)(u,{label:"Восстановить",onClick:d.restoreTask,color:"positive"},null,8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a._)("div",C,[t.item.deleted?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,icon:"delete",round:"",push:"",size:"md",onClick:l[2]||(l[2]=e=>d.openDeleteDialog())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,a.w5)((()=>[q])),_:1})])),_:1})),t.item.deleted?((0,a.wg)(),(0,a.j4)(u,{key:1,icon:"restore_from_trash",round:"",push:"",size:"md",onClick:l[3]||(l[3]=e=>d.openRestoreDialog())},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{anchor:"top middle",self:"bottom middle",offset:[10,10]},{default:(0,a.w5)((()=>[V])),_:1})])),_:1})):(0,a.kq)("",!0)])],64)}var O=t(61959),M=t(48825);const Z={props:["item","currentUser"],setup(e,{emit:l}){const t=(0,O.iH)(!1),a=()=>t.value=!0,d=(0,O.iH)(!1),o=()=>d.value=!0,i=(0,M.Z)(),r=()=>{t.value=!0,w.Z.callPgMethod("task_update",{id:e.item.id,deleted:!0},(e=>{l("reload"),t.value=!1,i.notify({type:"info",message:"Задача удалена"})}))},u=()=>{d.value=!0,w.Z.callPgMethod("task_update",{id:e.item.id,deleted:!1},(e=>{l("reload"),d.value=!1,i.notify({type:"positive",message:"Задача восстановлена"})}))};return{deleteDialog:t,restoreDialog:d,openDeleteDialog:a,openRestoreDialog:o,deleteTask:r,restoreTask:u}}};var H=t(74260),F=t(46778),D=t(10151),U=t(25589),T=t(99367),Q=t(2165),S=t(5363),I=t(60677),z=t(7518),P=t.n(z);const L=(0,H.Z)(Z,[["render",x]]),B=L;P()(Z,"components",{QDialog:F.Z,QCard:D.Z,QCardSection:U.Z,QCardActions:T.Z,QBtn:Q.Z,QTooltip:S.Z}),P()(Z,"directives",{ClosePopup:I.Z});const R=(0,a._)("div",{class:"text-h6"},"Добавить задачу",-1);function j(e,l,t,d,o,i){const r=(0,a.up)("q-card-section"),u=(0,a.up)("q-input"),n=(0,a.up)("comp-fld-ref-search"),s=(0,a.up)("q-btn"),m=(0,a.up)("q-card-actions"),c=(0,a.up)("q-card"),p=(0,a.up)("q-dialog"),w=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(p,{modelValue:d.isShowDialog,"onUpdate:modelValue":l[5]||(l[5]=e=>d.isShowDialog=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{style:{"min-width":"20vw"}},{default:(0,a.w5)((()=>[(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[R])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a._)("div",null,[(0,a._)("div",null,[d.systemId?((0,a.wg)(),(0,a.j4)(u,{key:0,modelValue:d.taskTitle,"onUpdate:modelValue":l[0]||(l[0]=e=>d.taskTitle=e),autogrow:"",label:"Название",class:"q-mb-md col-md-4 col-sm-6 col-xs-12"},null,8,["modelValue"])):(0,a.kq)("",!0)]),(0,a._)("div",null,[d.systemId?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(n,{key:0,outlined:"",pgMethod:"system_list",label:e.$t("task.system_id"),item:d.system,itemId:d.systemId,ext:{},onUpdate:l[1]||(l[1]=e=>d.systemId=e.id),onClear:l[2]||(l[2]=e=>d.systemId=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId"])),d.systemId?((0,a.wg)(),(0,a.j4)(n,{key:1,rounded:"",dense:"",pgMethod:"system_list",label:e.$t("task.system_id"),item:d.system,itemId:d.systemId,ext:{},onUpdate:l[3]||(l[3]=e=>d.systemId=e.id),onClear:l[4]||(l[4]=e=>d.systemId=null),readonly:!1,class:"q-mb-sm col-md-4 col-sm-6 col-xs-12"},null,8,["label","item","itemId"])):(0,a.kq)("",!0)])])])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[d.systemId&&d.taskTitle?((0,a.wg)(),(0,a.j4)(m,{key:0,align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(s,{flat:"",label:"Отмена"},null,512),[[w]]),(0,a.Wm)(s,{label:"Создать",onClick:d.addTask,color:"secondary"},null,8,["onClick"])])),_:1})):(0,a.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a._)("div",null,[(0,a.Wm)(s,{class:"q-mr-md",icon:"add",size:"md",round:"",push:"",color:"secondary",onClick:l[6]||(l[6]=e=>d.open())})])],64)}const K={props:["currentUser"],setup(e,{emit:l}){const t=(0,O.iH)(!1),a=()=>t.value=!0,d=(0,O.iH)(""),o=(0,O.iH)(null),i=(0,O.iH)(null),r=(0,O.iH)([]),u=()=>{w.Z.callPgMethod("system_list",{deleted:!1,order_by:"id desc"},(e=>{r.value=e}))};u();const n=(0,M.Z)(),s=()=>{t.value=!0,w.Z.callPgMethod("task_update",{id:-1,title:d.value,system_id:i.value,stage_id:1},(e=>{l("reload"),d.value="",i.value=null,t.value=!1,n.notify({type:"positive",message:"Задача создана"})}))};return{isShowDialog:t,open:a,taskTitle:d,system:o,systemId:i,addTask:s,systemList:r}}};var E=t(34842);const A=(0,H.Z)(K,[["render",j]]),Y=A;P()(K,"components",{QDialog:F.Z,QCard:D.Z,QCardSection:U.Z,QInput:E.Z,QCardActions:T.Z,QBtn:Q.Z}),P()(K,"directives",{ClosePopup:I.Z});const $={style:{"flex-wrap":"wrap",display:"flex","padding-left":"20px"}},N={style:{display:"flex",width:"50%","justify-content":"space-between","flex-wrap":"wrap","padding-right":"5px"}},G={style:{display:"flex","justify-content":"space-between",width:"100%",padding:"5px"}},J={style:{display:"flex",width:"50%","justify-content":"space-between","flex-wrap":"wrap"}},X={style:{display:"flex","justify-content":"space-between",width:"100%",padding:"5px"}},ee=(0,a._)("div",{class:"text-h6"},"Добавление нового фильтра",-1),le=(0,a._)("div",null,"Название фильтра:",-1),te=(0,a._)("div",null,"Условия фильтра:",-1),ae=(0,a._)("span",null,"сделать фильтром по умолчанию",-1),de=(0,a._)("div",{class:"text-h6"},"Редактирование фильтра",-1),oe=(0,a._)("div",null,"Название фильтра:",-1),ie=(0,a._)("div",null,"Условия фильтра:",-1),re=(0,a._)("span",null,"сделать фильтром по умолчанию",-1),ue={class:"q-ml-sm"},ne=(0,a._)("div",{class:"text-h6 text-center"},"Варианты фильтров",-1),se=(0,a._)("div",{class:"text-h6 text-center"},"Варианты сортировки",-1),me=(0,a._)("div",{class:"text-h6"},"Добавление новой сортировки",-1),ce=(0,a._)("div",null,"Название сортировки:",-1),pe=(0,a._)("div",null,"Условия сортировки:",-1),we=(0,a._)("span",null,"сделать сортировкой по умолчанию",-1),_e=(0,a._)("div",{class:"text-h6"},"Редактирование сортировки",-1),fe=(0,a._)("div",null,"Название сортировки:",-1),ye=(0,a._)("div",null,"Условия сортировки:",-1),ve=(0,a._)("span",null,"сделать сортировкой по умолчанию",-1),ge={class:"q-ml-sm"};function ke(e,l,t,d,o,i){const r=(0,a.up)("q-input"),u=(0,a.up)("q-btn"),n=(0,a.up)("q-card-section"),s=(0,a.up)("q-checkbox"),m=(0,a.up)("q-card-actions"),c=(0,a.up)("q-card"),p=(0,a.up)("q-dialog"),w=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",$,[(0,a._)("div",N,[(0,a.Wm)(r,{id:"sqlInput",onKeydown:d.keydownHandler,style:{width:"100%"},filled:"",dense:t.tableMode,modelValue:d.sqlRest,"onUpdate:modelValue":l[0]||(l[0]=e=>d.sqlRest=e),label:"Условия фильтра"},null,8,["onKeydown","dense","modelValue"]),(0,a._)("div",G,[(0,a._)("div",null,[(0,a.Wm)(u,{push:"",style:{"margin-right":"5px","margin-bottom":"5px","background-color":"rgba(255,255,255,0.2)"},"text-color":"primary",label:d.activeFilterTitle,onClick:l[1]||(l[1]=()=>d.isFiltersModal=!0)},null,8,["label"])]),(0,a._)("div",null,[(0,a.Wm)(u,{push:"",style:{"background-color":"rgba(255,255,255,0.2)"},"text-color":"primary",label:"+",onClick:d.openCreateFilterModal},null,8,["onClick"])])])]),(0,a._)("div",J,[(0,a.Wm)(r,{id:"sqlInput",onKeydown:d.keydownHandlerOrder,style:{width:"100%"},filled:"",modelValue:d.orderRest,"onUpdate:modelValue":l[2]||(l[2]=e=>d.orderRest=e),dense:t.tableMode,label:"Условия сортировки"},null,8,["onKeydown","modelValue","dense"]),(0,a._)("div",X,[(0,a._)("div",null,[(0,a.Wm)(u,{push:"",style:{"margin-right":"5px","margin-bottom":"5px","background-color":"rgba(255,255,255,0.2)"},"text-color":"primary",label:d.activeOrderByTitle,onClick:l[3]||(l[3]=()=>d.isOrderModal=!0)},null,8,["label"])]),(0,a._)("div",null,[(0,a.Wm)(u,{push:"",style:{"background-color":"rgba(255,255,255,0.2)"},"text-color":"primary",label:"+",onClick:d.openCreateOrderModal},null,8,["onClick"])])])])]),(0,a.Wm)(p,{modelValue:d.isCreateFilterModal,"onUpdate:modelValue":l[7]||(l[7]=e=>d.isCreateFilterModal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{style:{"min-width":"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[ee])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[le])),_:1}),(0,a.Wm)(n,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{dense:"",modelValue:d.newFilterTitle,"onUpdate:modelValue":l[4]||(l[4]=e=>d.newFilterTitle=e),autofocus:"",onKeyup:(0,a.D2)(d.closeCreateFilterModal,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[te])),_:1}),(0,a.Wm)(n,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{dense:"",modelValue:d.newFilterCondition,"onUpdate:modelValue":l[5]||(l[5]=e=>d.newFilterCondition=e),autofocus:"",onKeyup:(0,a.D2)(d.closeCreateFilterModal,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),(0,a.Wm)(s,{modelValue:d.defCheckbox,"onUpdate:modelValue":l[6]||(l[6]=e=>d.defCheckbox=e)},null,8,["modelValue"]),ae,(0,a.Wm)(m,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Cancel"},null,512),[[w]]),(0,a.Wm)(u,{flat:"",label:"Add filter",style:{"background-color":"rgba(33, 186, 69, 0.2)"},onClick:d.createFilter},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(p,{modelValue:d.isEditFilterModal,"onUpdate:modelValue":l[13]||(l[13]=e=>d.isEditFilterModal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{style:{"min-width":"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[de])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[oe])),_:1}),(0,a.Wm)(n,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{dense:"",modelValue:d.editFilterTitle,"onUpdate:modelValue":l[8]||(l[8]=e=>d.editFilterTitle=e),autofocus:"",onKeyup:l[9]||(l[9]=(0,a.D2)((()=>d.isEditFilterModal=!1),["enter"]))},null,8,["modelValue"])])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[ie])),_:1}),(0,a.Wm)(n,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{dense:"",modelValue:d.editFilterCondition,"onUpdate:modelValue":l[10]||(l[10]=e=>d.editFilterCondition=e),autofocus:"",onKeyup:l[11]||(l[11]=(0,a.D2)((()=>d.isEditFilterModal=!1),["enter"]))},null,8,["modelValue"])])),_:1}),(0,a.Wm)(s,{modelValue:d.defCheckbox,"onUpdate:modelValue":l[12]||(l[12]=e=>d.defCheckbox=e)},null,8,["modelValue"]),re,(0,a.Wm)(m,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Cancel"},null,512),[[w]]),(0,a.Wm)(u,{flat:"",label:"Edit filter",style:{"background-color":"rgba(33, 186, 69, 0.2)"},onClick:d.editFilter},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(p,{modelValue:d.isDeleteFilterModal,"onUpdate:modelValue":l[14]||(l[14]=e=>d.isDeleteFilterModal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(n,{class:"row items-center"},{default:(0,a.w5)((()=>[(0,a._)("span",ue,'Хотите удалить фильтр "'+(0,a.zw)(d.curFilter.title)+'"?',1)])),_:1}),(0,a.Wm)(m,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Cancel"},null,512),[[w]]),(0,a.Wm)(u,{flat:"",label:"Delete",style:{"background-color":"rgba(193, 0, 21, 0.2)"},onClick:d.deleteFilter},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(p,{modelValue:d.isFiltersModal,"onUpdate:modelValue":l[15]||(l[15]=e=>d.isFiltersModal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[ne])),_:1}),(0,a.Wm)(n,{align:"center"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.filterList,(e=>((0,a.wg)(),(0,a.j4)(u,{key:e.id,push:"",style:{"margin-right":"5px","margin-bottom":"5px","background-color":"rgba(255,255,255,0.2)"},"text-color":"primary",label:e.title,onClick:l=>d.filterStringAssembly(e),onMousedown:d.mousedownOnFilter,onMouseup:l=>d.mouseupOnFilter(e),onDblclick:l=>d.dblClickOnFilter(e)},null,8,["label","onClick","onMousedown","onMouseup","onDblclick"])))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(p,{modelValue:d.isOrderModal,"onUpdate:modelValue":l[16]||(l[16]=e=>d.isOrderModal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[se])),_:1}),(0,a.Wm)(n,{align:"center"},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.orderByList,(e=>((0,a.wg)(),(0,a.j4)(u,{key:e.id,push:"",style:{"margin-right":"5px","margin-bottom":"5px","background-color":"rgba(255,255,255,0.2)"},"text-color":"primary",label:e.title,onClick:l=>d.filterStringAssemblyOrder(e),onMousedown:d.mousedownOnOrder,onMouseup:l=>d.mouseupOnOrder(e),onDblclick:l=>d.dblClickOnOrder(e)},null,8,["label","onClick","onMousedown","onMouseup","onDblclick"])))),128))])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(p,{modelValue:d.isCreateOrderModal,"onUpdate:modelValue":l[20]||(l[20]=e=>d.isCreateOrderModal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{style:{"min-width":"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[me])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[ce])),_:1}),(0,a.Wm)(n,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{dense:"",modelValue:d.newOrderTitle,"onUpdate:modelValue":l[17]||(l[17]=e=>d.newOrderTitle=e),autofocus:"",onKeyup:(0,a.D2)(d.closeCreateOrderModal,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[pe])),_:1}),(0,a.Wm)(n,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{dense:"",modelValue:d.newOrderCondition,"onUpdate:modelValue":l[18]||(l[18]=e=>d.newOrderCondition=e),autofocus:"",onKeyup:(0,a.D2)(d.closeCreateOrderModal,["enter"])},null,8,["modelValue","onKeyup"])])),_:1}),(0,a.Wm)(s,{modelValue:d.defCheckboxOrder,"onUpdate:modelValue":l[19]||(l[19]=e=>d.defCheckboxOrder=e)},null,8,["modelValue"]),we,(0,a.Wm)(m,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Cancel"},null,512),[[w]]),(0,a.Wm)(u,{flat:"",label:"Add order_by",style:{"background-color":"rgba(33, 186, 69, 0.2)"},onClick:d.createOrder},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(p,{modelValue:d.isEditOrderModal,"onUpdate:modelValue":l[26]||(l[26]=e=>d.isEditOrderModal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{style:{"min-width":"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[_e])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[fe])),_:1}),(0,a.Wm)(n,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{dense:"",modelValue:d.editOrderTitle,"onUpdate:modelValue":l[21]||(l[21]=e=>d.editOrderTitle=e),autofocus:"",onKeyup:l[22]||(l[22]=(0,a.D2)((()=>d.isEditOrderModal=!1),["enter"]))},null,8,["modelValue"])])),_:1}),(0,a.Wm)(n,null,{default:(0,a.w5)((()=>[ye])),_:1}),(0,a.Wm)(n,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{dense:"",modelValue:d.editOrderCondition,"onUpdate:modelValue":l[23]||(l[23]=e=>d.editOrderCondition=e),autofocus:"",onKeyup:l[24]||(l[24]=(0,a.D2)((()=>d.isEditOrderModal=!1),["enter"]))},null,8,["modelValue"])])),_:1}),(0,a.Wm)(s,{modelValue:d.defCheckboxOrder,"onUpdate:modelValue":l[25]||(l[25]=e=>d.defCheckboxOrder=e)},null,8,["modelValue"]),ve,(0,a.Wm)(m,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Cancel"},null,512),[[w]]),(0,a.Wm)(u,{flat:"",label:"Edit order_by",style:{"background-color":"rgba(33, 186, 69, 0.2)"},onClick:d.editOrder},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,a.Wm)(p,{modelValue:d.isDeleteOrderModal,"onUpdate:modelValue":l[27]||(l[27]=e=>d.isDeleteOrderModal=e)},{default:(0,a.w5)((()=>[(0,a.Wm)(c,null,{default:(0,a.w5)((()=>[(0,a.Wm)(n,{class:"row items-center"},{default:(0,a.w5)((()=>[(0,a._)("span",ge,'Хотите удалить сортировку "'+(0,a.zw)(d.curOrder.title)+'"?',1)])),_:1}),(0,a.Wm)(m,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(u,{flat:"",label:"Cancel"},null,512),[[w]]),(0,a.Wm)(u,{flat:"",label:"Delete",style:{"background-color":"rgba(193, 0, 21, 0.2)"},onClick:d.deleteOrder},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["modelValue"])],64)}t(10071),t(66016);const be={props:["currentUser","tableMode"],setup(e,{emit:l}){const t=(0,a.iH)(null),d=(0,a.iH)(null),o=(0,a.iH)(null),i=(0,a.iH)(null),r=(0,a.iH)([]),u=(0,a.iH)(!0),n=(0,a.iH)(!1),s=(0,a.iH)(""),m=(0,a.iH)(""),c=(0,a.iH)([]),p=(0,a.iH)(!1),_=(0,a.iH)(!1),f=(0,a.iH)(!1),y=(0,a.iH)(""),v=(0,a.iH)(!1),g=(0,a.iH)(!1),k=(0,a.iH)(""),b=(0,a.iH)(""),W=(0,a.iH)(!1),h=(0,a.iH)(""),C=(0,a.iH)(""),q=(0,a.iH)(""),V=(0,a.iH)(""),x=(0,a.iH)(""),O=(0,a.iH)(!1),M=(0,a.iH)([]),Z=(0,a.iH)({}),H=(0,a.iH)(""),F=(0,a.iH)(!1),D=(0,a.iH)(!1),U=(0,a.iH)(""),T=(0,a.iH)(""),Q=(0,a.iH)(!1),S=(0,a.iH)({}),I=(0,a.iH)(!1),z=(0,a.iH)(""),P=(0,a.iH)(""),L=(0,a.iH)(!1),B=(0,a.iH)(!1),R=(0,a.iH)(""),j=e=>{y.value=e,g.value=!0,k.value=e.title,b.value=e.where_str,O.value=e.is_default},K=()=>{v.value||(v.value=!0,_.value=!1,setTimeout((()=>{_.value=!0,v.value=!1}),1500))},E=e=>{_.value&&(f.value=!0,y.value=e)},A=e=>{_.value||(V.value=e.where_str,h.value=e,q.value=e.title,C.value="",se())},Y=e=>{S.value=e,I.value=!0,z.value=e.title,P.value=e.order_by_str,D.value=e.is_default},$=()=>{L.value||(L.value=!0,_.value=!1,setTimeout((()=>{_.value=!0,L.value=!1}),1500))},N=e=>{_.value&&(B.value=!0,S.value=e)},G=e=>{_.value||(x.value=e.order_by_str,Z.value=e,H.value=e.title,R.value="",se())},J=()=>{w.Z.postCallPgMethod({method:"ctlg_filter_update",params:{id:-1,title:s.value,index:"task",where_str:m.value,user_table_id:e.currentUser.id,is_default:O.value}}).subscribe((e=>{e.ok&&(de(),ue())}))},X=()=>{w.Z.postCallPgMethod({method:"ctlg_order_by_update",params:{id:-1,title:T.value,index:"task",order_by_str:U.value,user_table_id:e.currentUser.id,is_default:D.value}}).subscribe((e=>{e.ok&&(oe(),ne())}))},ee=()=>{w.Z.postCallPgMethod({method:"ctlg_filter_update",params:{id:y.value.id,deleted:!0}}).subscribe((e=>{e.ok&&(de(),f.value=!1)}))},le=()=>{w.Z.postCallPgMethod({method:"ctlg_order_by_update",params:{id:S.value.id,deleted:!0}}).subscribe((e=>{e.ok&&(oe(),B.value=!1)}))},te=()=>{w.Z.postCallPgMethod({method:"ctlg_filter_update",params:{id:y.value.id,title:k.value,index:"task",where_str:b.value,user_table_id:e.currentUser.id,is_default:O.value}}).subscribe((e=>{e.ok&&(de(),g.value=!1)}))},ae=()=>{w.Z.postCallPgMethod({method:"ctlg_order_by_update",params:{id:S.value.id,title:z.value,index:"task",order_by_str:P.value,user_table_id:e.currentUser.id,is_default:D.value}}).subscribe((e=>{e.ok&&(oe(),I.value=!1)}))},de=()=>{w.Z.postCallPgMethod({method:"ctlg_filter_list",params:{user_table_id:e.currentUser.id,index:"task"}}).subscribe((e=>{e.ok&&(c.value=e.result,c.value.forEach((e=>{e.is_default&&(h.value=e,q.value=e.title,V.value=e.where_str,se())})))}))},oe=()=>{w.Z.postCallPgMethod({method:"ctlg_order_by_list",params:{user_table_id:e.currentUser.id,index:"task"}}).subscribe((e=>{e.ok&&(M.value=e.result,M.value.forEach((e=>{e.is_default&&(Z.value=e,H.value=e.title,x.value=e.order_by_str,se())})))}))},ie=()=>{n.value=!0,O.value=!1},re=()=>{Q.value=!0,D.value=!1},ue=()=>{n.value=!1,s.value="",m.value=""},ne=()=>{Q.value=!1,T.value="",U.value=""},se=()=>{l("sqlRestBtnClickHandler",{where_param:V.value?V.value:null,order_by:x.value?x.value:"created_at desc"})},me=e=>{13===e.keyCode&&se()},ce=e=>{13===e.keyCode&&se()},pe=e=>{l("updateFilterCtlgTaskState",{state:e?e.id:null}),e&&w.Z.callPgMethod("ctlg_task_state_get_by_id",{id:e.id},(e=>{t.value=e.title}))},we=e=>{l("updateFilterSystem",{system_id:e?e.id:null}),e&&w.Z.callPgMethod("system_get_by_id",{id:e.id},(e=>{o.value=e.title}))};(0,a.YP)(V,(e=>(h.value.where_str!==e?(C.value=h.value.title,q.value="CUSTOM"):C.value&&(q.value=h.value.title),0)));const _e=(0,a.Fl)((e=>(Z.value.order_by_str!==e?(R.value=Z.value.title,H.value="CUSTOM"):R.value&&(H.value=Z.value.title),0))),fe=new URLSearchParams(window.location.search);if(fe.has("state")){let e=+fe.get("state");e&&pe({id:e})}if(fe.has("system_id")){let e=+fe.get("system_id");e&&we({id:e})}return(0,a.m0)((()=>{e.currentUser.id&&(de(),oe())})),{filterCtlgTaskStateTitle:t,filterCtlgTaskStateId:d,filterSystemTitle:o,filterSystemId:i,sqlRestList:r,active:u,isCreateFilterModal:n,newFilterTitle:s,newFilterCondition:m,filterList:c,isMousedownOnFilter:p,mouseFlag:_,isDeleteFilterModal:f,curFilter:y,filterLoading:v,isEditFilterModal:g,editFilterTitle:k,editFilterCondition:b,isFiltersModal:W,activeFilter:h,storeFilterName:C,activeFilterTitle:q,sqlRest:V,orderRest:x,orderRestComputed:_e,defCheckbox:O,orderByList:M,activeOrderBy:Z,activeOrderByTitle:H,isOrderModal:F,defCheckboxOrder:D,newOrderCondition:U,newOrderTitle:T,isCreateOrderModal:Q,curOrder:S,isEditOrderModal:I,editOrderTitle:z,editOrderCondition:P,orderLoading:L,isDeleteOrderModal:B,storeOrderByName:R,dblClickOnFilter:j,mousedownOnFilter:K,mouseupOnFilter:E,filterStringAssembly:A,dblClickOnOrder:Y,mousedownOnOrder:$,mouseupOnOrder:N,filterStringAssemblyOrder:G,createFilter:J,createOrder:X,deleteFilter:ee,deleteOrder:le,editFilter:te,editOrder:ae,loadFilterList:de,loadOrderList:oe,openCreateFilterModal:ie,openCreateOrderModal:re,closeCreateFilterModal:ue,closeCreateOrderModal:ne,sqlRestBtnClickHandler:se,keydownHandler:me,keydownHandlerOrder:ce,updateFilterCtlgTaskState:pe,updateFilterSystem:we}}};var We=t(65735);const he=(0,H.Z)(be,[["render",ke]]),Ce=he;P()(be,"components",{QInput:E.Z,QBtn:Q.Z,QDialog:F.Z,QCard:D.Z,QCardSection:U.Z,QCheckbox:We.Z,QCardActions:T.Z}),P()(be,"directives",{ClosePopup:I.Z});const qe={props:["isOpenInDialog","ext"],components:{FilterComponent:Ce,TaskAddButton:Y,TaskDeleteButton:B,TimelineDialogButton:_.Z},mixins:[p.Z],computed:{currentUrl:()=>"/task/"},data(){return{listSortData:[{value:"created_at",title:"Дата"},{value:"title",title:"Название"}],listFilterData:[{value:{deleted:!1},title:"Активные"},{value:{deleted:!0},title:"Удаленные"}]}},methods:{},mounted(){},setup(e,{emit:l}){const t=(0,a.iH)([]),d=(0,a.iH)([]),o=(0,a.iH)([{name:"id",align:"center",label:"ID",field:"id",sortable:!0},{name:"title",align:"left",label:"Название",field:"title",sortable:!0},{name:"stage",align:"left",label:"Этап",field:"stage",sortable:!0},{name:"system",align:"center",label:"Система",field:"system",sortable:!0},{name:"history",align:"center",label:"История",field:"history"},{name:"delete",align:"center",label:"Удалить",field:"delete"},{name:"log",align:"center",label:"лог",field:"log"}]),i=e=>{w.Z.callPgMethod("task_list",e,(e=>{t.value=e,r.value=!1}))},r=(0,a.iH)(!1),u=()=>{w.Z.callPgMethod("task_list",{deleted:!r.value,order_by:"id desc"},(e=>{t.value=e,r.value=!r.value}))},n=e=>{console.log("v",e)},s=()=>{w.Z.callPgMethod("task_list",{deleted:!1,order_by:"id desc"},(e=>{t.value=e}))};return s(),{reload:s,open,columns:o,rows:d,taskList:t,logg:n,deletedFilter:u,deleted:r,sqlRestBtnClickHandler:i}}};var Ve=t(24379),xe=t(31993),Oe=t(62025),Me=t(92414),Ze=t(18186),He=t(83884),Fe=t(83414),De=t(52035),Ue=t(75096),Te=t(2350);const Qe=(0,H.Z)(qe,[["render",c]]),Se=Qe;P()(qe,"components",{QPage:Ve.Z,QCard:D.Z,QCardSection:U.Z,QTable:xe.Z,QSpace:Oe.Z,QTh:Me.Z,QTr:Ze.Z,QTd:He.Z,QItem:Fe.Z,QItemSection:De.Z,QAvatar:Ue.Z,QItemLabel:Te.Z,QBtn:Q.Z})}}]);